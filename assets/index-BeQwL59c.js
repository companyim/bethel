(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function $E(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hy={exports:{}},Ch={},dy={exports:{}},Ke={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Qc=Symbol.for("react.element"),GE=Symbol.for("react.portal"),qE=Symbol.for("react.fragment"),KE=Symbol.for("react.strict_mode"),XE=Symbol.for("react.profiler"),YE=Symbol.for("react.provider"),QE=Symbol.for("react.context"),JE=Symbol.for("react.forward_ref"),ZE=Symbol.for("react.suspense"),e6=Symbol.for("react.memo"),t6=Symbol.for("react.lazy"),Wg=Symbol.iterator;function r6(e){return e===null||typeof e!="object"?null:(e=Wg&&e[Wg]||e["@@iterator"],typeof e=="function"?e:null)}var py={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},my=Object.assign,gy={};function Xo(e,t,r){this.props=e,this.context=t,this.refs=gy,this.updater=r||py}Xo.prototype.isReactComponent={};Xo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vy(){}vy.prototype=Xo.prototype;function Q1(e,t,r){this.props=e,this.context=t,this.refs=gy,this.updater=r||py}var J1=Q1.prototype=new vy;J1.constructor=Q1;my(J1,Xo.prototype);J1.isPureReactComponent=!0;var Hg=Array.isArray,by=Object.prototype.hasOwnProperty,Z1={current:null},yy={key:!0,ref:!0,__self:!0,__source:!0};function wy(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)by.call(t,n)&&!yy.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Qc,type:e,key:s,ref:i,props:a,_owner:Z1.current}}function n6(e,t){return{$$typeof:Qc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function e0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qc}function a6(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $g=/\/+/g;function Cd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?a6(""+e.key):t.toString(36)}function uf(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Qc:case GE:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Cd(i,0):n,Hg(a)?(r="",e!=null&&(r=e.replace($g,"$&/")+"/"),uf(a,t,r,"",function(c){return c})):a!=null&&(e0(a)&&(a=n6(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace($g,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",Hg(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Cd(s,o);i+=uf(s,t,r,l,a)}else if(l=r6(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Cd(s,o++),i+=uf(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Au(e,t,r){if(e==null)return e;var n=[],a=0;return uf(e,n,"","",function(s){return t.call(r,s,a++)}),n}function s6(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Xr={current:null},ff={transition:null},i6={ReactCurrentDispatcher:Xr,ReactCurrentBatchConfig:ff,ReactCurrentOwner:Z1};function ky(){throw Error("act(...) is not supported in production builds of React.")}Ke.Children={map:Au,forEach:function(e,t,r){Au(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Au(e,function(){t++}),t},toArray:function(e){return Au(e,function(t){return t})||[]},only:function(e){if(!e0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ke.Component=Xo;Ke.Fragment=qE;Ke.Profiler=XE;Ke.PureComponent=Q1;Ke.StrictMode=KE;Ke.Suspense=ZE;Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=i6;Ke.act=ky;Ke.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=my({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Z1.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)by.call(t,l)&&!yy.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Qc,type:e.type,key:a,ref:s,props:n,_owner:i}};Ke.createContext=function(e){return e={$$typeof:QE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:YE,_context:e},e.Consumer=e};Ke.createElement=wy;Ke.createFactory=function(e){var t=wy.bind(null,e);return t.type=e,t};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(e){return{$$typeof:JE,render:e}};Ke.isValidElement=e0;Ke.lazy=function(e){return{$$typeof:t6,_payload:{_status:-1,_result:e},_init:s6}};Ke.memo=function(e,t){return{$$typeof:e6,type:e,compare:t===void 0?null:t}};Ke.startTransition=function(e){var t=ff.transition;ff.transition={};try{e()}finally{ff.transition=t}};Ke.unstable_act=ky;Ke.useCallback=function(e,t){return Xr.current.useCallback(e,t)};Ke.useContext=function(e){return Xr.current.useContext(e)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(e){return Xr.current.useDeferredValue(e)};Ke.useEffect=function(e,t){return Xr.current.useEffect(e,t)};Ke.useId=function(){return Xr.current.useId()};Ke.useImperativeHandle=function(e,t,r){return Xr.current.useImperativeHandle(e,t,r)};Ke.useInsertionEffect=function(e,t){return Xr.current.useInsertionEffect(e,t)};Ke.useLayoutEffect=function(e,t){return Xr.current.useLayoutEffect(e,t)};Ke.useMemo=function(e,t){return Xr.current.useMemo(e,t)};Ke.useReducer=function(e,t,r){return Xr.current.useReducer(e,t,r)};Ke.useRef=function(e){return Xr.current.useRef(e)};Ke.useState=function(e){return Xr.current.useState(e)};Ke.useSyncExternalStore=function(e,t,r){return Xr.current.useSyncExternalStore(e,t,r)};Ke.useTransition=function(){return Xr.current.useTransition()};Ke.version="18.3.1";dy.exports=Ke;var qe=dy.exports;const Ty=$E(qe);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var o6=qe,l6=Symbol.for("react.element"),c6=Symbol.for("react.fragment"),u6=Object.prototype.hasOwnProperty,f6=o6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h6={key:!0,ref:!0,__self:!0,__source:!0};function Ey(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)u6.call(t,n)&&!h6.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:l6,type:e,key:s,ref:i,props:a,_owner:f6.current}}Ch.Fragment=c6;Ch.jsx=Ey;Ch.jsxs=Ey;hy.exports=Ch;var B=hy.exports,Sp={},Sy={exports:{}},wn={},xy={exports:{}},_y={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(e){function t(q,te){var fe=q.length;q.push(te);e:for(;0<fe;){var Ae=fe-1>>>1,j=q[Ae];if(0<a(j,te))q[Ae]=te,q[fe]=j,fe=Ae;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var te=q[0],fe=q.pop();if(fe!==te){q[0]=fe;e:for(var Ae=0,j=q.length,G=j>>>1;Ae<G;){var W=2*(Ae+1)-1,H=q[W],ee=W+1,he=q[ee];if(0>a(H,fe))ee<j&&0>a(he,H)?(q[Ae]=he,q[ee]=fe,Ae=ee):(q[Ae]=H,q[W]=fe,Ae=W);else if(ee<j&&0>a(he,fe))q[Ae]=he,q[ee]=fe,Ae=ee;else break e}}return te}function a(q,te){var fe=q.sortIndex-te.sortIndex;return fe!==0?fe:q.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,h=null,d=3,p=!1,g=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(q){for(var te=r(c);te!==null;){if(te.callback===null)n(c);else if(te.startTime<=q)n(c),te.sortIndex=te.expirationTime,t(l,te);else break;te=r(c)}}function N(q){if(m=!1,w(q),!g)if(r(l)!==null)g=!0,xe(_);else{var te=r(c);te!==null&&Se(N,te.startTime-q)}}function _(q,te){g=!1,m&&(m=!1,k(S),S=-1),p=!0;var fe=d;try{for(w(te),h=r(l);h!==null&&(!(h.expirationTime>te)||q&&!A());){var Ae=h.callback;if(typeof Ae=="function"){h.callback=null,d=h.priorityLevel;var j=Ae(h.expirationTime<=te);te=e.unstable_now(),typeof j=="function"?h.callback=j:h===r(l)&&n(l),w(te)}else n(l);h=r(l)}if(h!==null)var G=!0;else{var W=r(c);W!==null&&Se(N,W.startTime-te),G=!1}return G}finally{h=null,d=fe,p=!1}}var F=!1,T=null,S=-1,x=5,I=-1;function A(){return!(e.unstable_now()-I<x)}function R(){if(T!==null){var q=e.unstable_now();I=q;var te=!0;try{te=T(!0,q)}finally{te?D():(F=!1,T=null)}}else F=!1}var D;if(typeof b=="function")D=function(){b(R)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ue=de.port2;de.port1.onmessage=R,D=function(){ue.postMessage(null)}}else D=function(){y(R,0)};function xe(q){T=q,F||(F=!0,D())}function Se(q,te){S=y(function(){q(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,xe(_))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(q){switch(d){case 1:case 2:case 3:var te=3;break;default:te=d}var fe=d;d=te;try{return q()}finally{d=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,te){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var fe=d;d=q;try{return te()}finally{d=fe}},e.unstable_scheduleCallback=function(q,te,fe){var Ae=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Ae+fe:Ae):fe=Ae,q){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=fe+j,q={id:f++,callback:te,priorityLevel:q,startTime:fe,expirationTime:j,sortIndex:-1},fe>Ae?(q.sortIndex=fe,t(c,q),r(l)===null&&q===r(c)&&(m?(k(S),S=-1):m=!0,Se(N,fe-Ae))):(q.sortIndex=j,t(l,q),g||p||(g=!0,xe(_))),q},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(q){var te=d;return function(){var fe=d;d=te;try{return q.apply(this,arguments)}finally{d=fe}}}})(_y);xy.exports=_y;var d6=xy.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var p6=qe,vn=d6;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cy=new Set,lc={};function Ii(e,t){Do(e,t),Do(e+"Capture",t)}function Do(e,t){for(lc[e]=t,e=0;e<t.length;e++)Cy.add(t[e])}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xp=Object.prototype.hasOwnProperty,m6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gg={},qg={};function g6(e){return xp.call(qg,e)?!0:xp.call(Gg,e)?!1:m6.test(e)?qg[e]=!0:(Gg[e]=!0,!1)}function v6(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b6(e,t,r,n){if(t===null||typeof t>"u"||v6(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Yr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Sr[e]=new Yr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Sr[t]=new Yr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Sr[e]=new Yr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Sr[e]=new Yr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Sr[e]=new Yr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Sr[e]=new Yr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Sr[e]=new Yr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Sr[e]=new Yr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Sr[e]=new Yr(e,5,!1,e.toLowerCase(),null,!1,!1)});var t0=/[\-:]([a-z])/g;function r0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(t0,r0);Sr[t]=new Yr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(t0,r0);Sr[t]=new Yr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(t0,r0);Sr[t]=new Yr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Sr[e]=new Yr(e,1,!1,e.toLowerCase(),null,!1,!1)});Sr.xlinkHref=new Yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Sr[e]=new Yr(e,1,!1,e.toLowerCase(),null,!0,!0)});function n0(e,t,r,n){var a=Sr.hasOwnProperty(t)?Sr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b6(t,r,a,n)&&(r=null),n||a===null?g6(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ha=p6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nu=Symbol.for("react.element"),no=Symbol.for("react.portal"),ao=Symbol.for("react.fragment"),a0=Symbol.for("react.strict_mode"),_p=Symbol.for("react.profiler"),Ay=Symbol.for("react.provider"),Ny=Symbol.for("react.context"),s0=Symbol.for("react.forward_ref"),Cp=Symbol.for("react.suspense"),Ap=Symbol.for("react.suspense_list"),i0=Symbol.for("react.memo"),os=Symbol.for("react.lazy"),Iy=Symbol.for("react.offscreen"),Kg=Symbol.iterator;function wl(e){return e===null||typeof e!="object"?null:(e=Kg&&e[Kg]||e["@@iterator"],typeof e=="function"?e:null)}var Ot=Object.assign,Ad;function Nl(e){if(Ad===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ad=t&&t[1]||""}return`
`+Ad+e}var Nd=!1;function Id(e,t){if(!e||Nd)return"";Nd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Nd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Nl(e):""}function y6(e){switch(e.tag){case 5:return Nl(e.type);case 16:return Nl("Lazy");case 13:return Nl("Suspense");case 19:return Nl("SuspenseList");case 0:case 2:case 15:return e=Id(e.type,!1),e;case 11:return e=Id(e.type.render,!1),e;case 1:return e=Id(e.type,!0),e;default:return""}}function Np(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ao:return"Fragment";case no:return"Portal";case _p:return"Profiler";case a0:return"StrictMode";case Cp:return"Suspense";case Ap:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ny:return(e.displayName||"Context")+".Consumer";case Ay:return(e._context.displayName||"Context")+".Provider";case s0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case i0:return t=e.displayName||null,t!==null?t:Np(e.type)||"Memo";case os:t=e._payload,e=e._init;try{return Np(e(t))}catch{}}return null}function w6(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Np(t);case 8:return t===a0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Rs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ry(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function k6(e){var t=Ry(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Iu(e){e._valueTracker||(e._valueTracker=k6(e))}function Dy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Ry(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Af(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ip(e,t){var r=t.checked;return Ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Xg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Rs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Oy(e,t){t=t.checked,t!=null&&n0(e,"checked",t,!1)}function Rp(e,t){Oy(e,t);var r=Rs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Dp(e,t.type,r):t.hasOwnProperty("defaultValue")&&Dp(e,t.type,Rs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Yg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Dp(e,t,r){(t!=="number"||Af(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Il=Array.isArray;function bo(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Rs(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Op(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Qg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ce(92));if(Il(r)){if(1<r.length)throw Error(ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Rs(r)}}function Py(e,t){var r=Rs(t.value),n=Rs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Jg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ly(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ly(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ru,Fy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ru=Ru||document.createElement("div"),Ru.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ru.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function cc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var zl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},T6=["Webkit","ms","Moz","O"];Object.keys(zl).forEach(function(e){T6.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zl[t]=zl[e]})});function My(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||zl.hasOwnProperty(e)&&zl[e]?(""+t).trim():t+"px"}function Uy(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=My(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var E6=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lp(e,t){if(t){if(E6[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function Fp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mp=null;function o0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Up=null,yo=null,wo=null;function Zg(e){if(e=eu(e)){if(typeof Up!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=Dh(t),Up(e.stateNode,e.type,t))}}function jy(e){yo?wo?wo.push(e):wo=[e]:yo=e}function zy(){if(yo){var e=yo,t=wo;if(wo=yo=null,Zg(e),t)for(e=0;e<t.length;e++)Zg(t[e])}}function Vy(e,t){return e(t)}function By(){}var Rd=!1;function Wy(e,t,r){if(Rd)return e(t,r);Rd=!0;try{return Vy(e,t,r)}finally{Rd=!1,(yo!==null||wo!==null)&&(By(),zy())}}function uc(e,t){var r=e.stateNode;if(r===null)return null;var n=Dh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ce(231,t,typeof r));return r}var jp=!1;if(Ma)try{var kl={};Object.defineProperty(kl,"passive",{get:function(){jp=!0}}),window.addEventListener("test",kl,kl),window.removeEventListener("test",kl,kl)}catch{jp=!1}function S6(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Vl=!1,Nf=null,If=!1,zp=null,x6={onError:function(e){Vl=!0,Nf=e}};function _6(e,t,r,n,a,s,i,o,l){Vl=!1,Nf=null,S6.apply(x6,arguments)}function C6(e,t,r,n,a,s,i,o,l){if(_6.apply(this,arguments),Vl){if(Vl){var c=Nf;Vl=!1,Nf=null}else throw Error(ce(198));If||(If=!0,zp=c)}}function Ri(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Hy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ev(e){if(Ri(e)!==e)throw Error(ce(188))}function A6(e){var t=e.alternate;if(!t){if(t=Ri(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return ev(a),e;if(s===n)return ev(a),t;s=s.sibling}throw Error(ce(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(ce(189))}}if(r.alternate!==n)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?e:t}function $y(e){return e=A6(e),e!==null?Gy(e):null}function Gy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Gy(e);if(t!==null)return t;e=e.sibling}return null}var qy=vn.unstable_scheduleCallback,tv=vn.unstable_cancelCallback,N6=vn.unstable_shouldYield,I6=vn.unstable_requestPaint,$t=vn.unstable_now,R6=vn.unstable_getCurrentPriorityLevel,l0=vn.unstable_ImmediatePriority,Ky=vn.unstable_UserBlockingPriority,Rf=vn.unstable_NormalPriority,D6=vn.unstable_LowPriority,Xy=vn.unstable_IdlePriority,Ah=null,ha=null;function O6(e){if(ha&&typeof ha.onCommitFiberRoot=="function")try{ha.onCommitFiberRoot(Ah,e,void 0,(e.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:F6,P6=Math.log,L6=Math.LN2;function F6(e){return e>>>=0,e===0?32:31-(P6(e)/L6|0)|0}var Du=64,Ou=4194304;function Rl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Df(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Rl(o):(s&=i,s!==0&&(n=Rl(s)))}else i=r&~a,i!==0?n=Rl(i):s!==0&&(n=Rl(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Xn(t),a=1<<r,n|=e[r],t&=~a;return n}function M6(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U6(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Xn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=M6(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Vp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yy(){var e=Du;return Du<<=1,!(Du&4194240)&&(Du=64),e}function Dd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Jc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xn(t),e[t]=r}function j6(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Xn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function c0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Xn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var ht=0;function Qy(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jy,u0,Zy,ew,tw,Bp=!1,Pu=[],bs=null,ys=null,ws=null,fc=new Map,hc=new Map,cs=[],z6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rv(e,t){switch(e){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":ys=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":fc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hc.delete(t.pointerId)}}function Tl(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=eu(t),t!==null&&u0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function V6(e,t,r,n,a){switch(t){case"focusin":return bs=Tl(bs,e,t,r,n,a),!0;case"dragenter":return ys=Tl(ys,e,t,r,n,a),!0;case"mouseover":return ws=Tl(ws,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return fc.set(s,Tl(fc.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,hc.set(s,Tl(hc.get(s)||null,e,t,r,n,a)),!0}return!1}function rw(e){var t=ii(e.target);if(t!==null){var r=Ri(t);if(r!==null){if(t=r.tag,t===13){if(t=Hy(r),t!==null){e.blockedOn=t,tw(e.priority,function(){Zy(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Wp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Mp=n,r.target.dispatchEvent(n),Mp=null}else return t=eu(r),t!==null&&u0(t),e.blockedOn=r,!1;t.shift()}return!0}function nv(e,t,r){hf(e)&&r.delete(t)}function B6(){Bp=!1,bs!==null&&hf(bs)&&(bs=null),ys!==null&&hf(ys)&&(ys=null),ws!==null&&hf(ws)&&(ws=null),fc.forEach(nv),hc.forEach(nv)}function El(e,t){e.blockedOn===t&&(e.blockedOn=null,Bp||(Bp=!0,vn.unstable_scheduleCallback(vn.unstable_NormalPriority,B6)))}function dc(e){function t(a){return El(a,e)}if(0<Pu.length){El(Pu[0],e);for(var r=1;r<Pu.length;r++){var n=Pu[r];n.blockedOn===e&&(n.blockedOn=null)}}for(bs!==null&&El(bs,e),ys!==null&&El(ys,e),ws!==null&&El(ws,e),fc.forEach(t),hc.forEach(t),r=0;r<cs.length;r++)n=cs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<cs.length&&(r=cs[0],r.blockedOn===null);)rw(r),r.blockedOn===null&&cs.shift()}var ko=Ha.ReactCurrentBatchConfig,Of=!0;function W6(e,t,r,n){var a=ht,s=ko.transition;ko.transition=null;try{ht=1,f0(e,t,r,n)}finally{ht=a,ko.transition=s}}function H6(e,t,r,n){var a=ht,s=ko.transition;ko.transition=null;try{ht=4,f0(e,t,r,n)}finally{ht=a,ko.transition=s}}function f0(e,t,r,n){if(Of){var a=Wp(e,t,r,n);if(a===null)Bd(e,t,n,Pf,r),rv(e,n);else if(V6(a,e,t,r,n))n.stopPropagation();else if(rv(e,n),t&4&&-1<z6.indexOf(e)){for(;a!==null;){var s=eu(a);if(s!==null&&Jy(s),s=Wp(e,t,r,n),s===null&&Bd(e,t,n,Pf,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Bd(e,t,n,null,r)}}var Pf=null;function Wp(e,t,r,n){if(Pf=null,e=o0(n),e=ii(e),e!==null)if(t=Ri(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Hy(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Pf=e,null}function nw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(R6()){case l0:return 1;case Ky:return 4;case Rf:case D6:return 16;case Xy:return 536870912;default:return 16}default:return 16}}var fs=null,h0=null,df=null;function aw(){if(df)return df;var e,t=h0,r=t.length,n,a="value"in fs?fs.value:fs.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return df=a.slice(e,1<n?1-n:void 0)}function pf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Lu(){return!0}function av(){return!1}function kn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Lu:av,this.isPropagationStopped=av,this}return Ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Lu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Lu)},persist:function(){},isPersistent:Lu}),t}var Yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d0=kn(Yo),Zc=Ot({},Yo,{view:0,detail:0}),$6=kn(Zc),Od,Pd,Sl,Nh=Ot({},Zc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sl&&(Sl&&e.type==="mousemove"?(Od=e.screenX-Sl.screenX,Pd=e.screenY-Sl.screenY):Pd=Od=0,Sl=e),Od)},movementY:function(e){return"movementY"in e?e.movementY:Pd}}),sv=kn(Nh),G6=Ot({},Nh,{dataTransfer:0}),q6=kn(G6),K6=Ot({},Zc,{relatedTarget:0}),Ld=kn(K6),X6=Ot({},Yo,{animationName:0,elapsedTime:0,pseudoElement:0}),Y6=kn(X6),Q6=Ot({},Yo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),J6=kn(Q6),Z6=Ot({},Yo,{data:0}),iv=kn(Z6),eS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=rS[e])?!!t[e]:!1}function p0(){return nS}var aS=Ot({},Zc,{key:function(e){if(e.key){var t=eS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p0,charCode:function(e){return e.type==="keypress"?pf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),sS=kn(aS),iS=Ot({},Nh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ov=kn(iS),oS=Ot({},Zc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p0}),lS=kn(oS),cS=Ot({},Yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),uS=kn(cS),fS=Ot({},Nh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),hS=kn(fS),dS=[9,13,27,32],m0=Ma&&"CompositionEvent"in window,Bl=null;Ma&&"documentMode"in document&&(Bl=document.documentMode);var pS=Ma&&"TextEvent"in window&&!Bl,sw=Ma&&(!m0||Bl&&8<Bl&&11>=Bl),lv=" ",cv=!1;function iw(e,t){switch(e){case"keyup":return dS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ow(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var so=!1;function mS(e,t){switch(e){case"compositionend":return ow(t);case"keypress":return t.which!==32?null:(cv=!0,lv);case"textInput":return e=t.data,e===lv&&cv?null:e;default:return null}}function gS(e,t){if(so)return e==="compositionend"||!m0&&iw(e,t)?(e=aw(),df=h0=fs=null,so=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sw&&t.locale!=="ko"?null:t.data;default:return null}}var vS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!vS[e.type]:t==="textarea"}function lw(e,t,r,n){jy(n),t=Lf(t,"onChange"),0<t.length&&(r=new d0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Wl=null,pc=null;function bS(e){yw(e,0)}function Ih(e){var t=lo(e);if(Dy(t))return e}function yS(e,t){if(e==="change")return t}var cw=!1;if(Ma){var Fd;if(Ma){var Md="oninput"in document;if(!Md){var fv=document.createElement("div");fv.setAttribute("oninput","return;"),Md=typeof fv.oninput=="function"}Fd=Md}else Fd=!1;cw=Fd&&(!document.documentMode||9<document.documentMode)}function hv(){Wl&&(Wl.detachEvent("onpropertychange",uw),pc=Wl=null)}function uw(e){if(e.propertyName==="value"&&Ih(pc)){var t=[];lw(t,pc,e,o0(e)),Wy(bS,t)}}function wS(e,t,r){e==="focusin"?(hv(),Wl=t,pc=r,Wl.attachEvent("onpropertychange",uw)):e==="focusout"&&hv()}function kS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ih(pc)}function TS(e,t){if(e==="click")return Ih(t)}function ES(e,t){if(e==="input"||e==="change")return Ih(t)}function SS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zn=typeof Object.is=="function"?Object.is:SS;function mc(e,t){if(Zn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!xp.call(t,a)||!Zn(e[a],t[a]))return!1}return!0}function dv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pv(e,t){var r=dv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dv(r)}}function fw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hw(){for(var e=window,t=Af();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Af(e.document)}return t}function g0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function xS(e){var t=hw(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&fw(r.ownerDocument.documentElement,r)){if(n!==null&&g0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=pv(r,s);var i=pv(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _S=Ma&&"documentMode"in document&&11>=document.documentMode,io=null,Hp=null,Hl=null,$p=!1;function mv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$p||io==null||io!==Af(n)||(n=io,"selectionStart"in n&&g0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Hl&&mc(Hl,n)||(Hl=n,n=Lf(Hp,"onSelect"),0<n.length&&(t=new d0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=io)))}function Fu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var oo={animationend:Fu("Animation","AnimationEnd"),animationiteration:Fu("Animation","AnimationIteration"),animationstart:Fu("Animation","AnimationStart"),transitionend:Fu("Transition","TransitionEnd")},Ud={},dw={};Ma&&(dw=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function Rh(e){if(Ud[e])return Ud[e];if(!oo[e])return e;var t=oo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in dw)return Ud[e]=t[r];return e}var pw=Rh("animationend"),mw=Rh("animationiteration"),gw=Rh("animationstart"),vw=Rh("transitionend"),bw=new Map,gv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ws(e,t){bw.set(e,t),Ii(t,[e])}for(var jd=0;jd<gv.length;jd++){var zd=gv[jd],CS=zd.toLowerCase(),AS=zd[0].toUpperCase()+zd.slice(1);Ws(CS,"on"+AS)}Ws(pw,"onAnimationEnd");Ws(mw,"onAnimationIteration");Ws(gw,"onAnimationStart");Ws("dblclick","onDoubleClick");Ws("focusin","onFocus");Ws("focusout","onBlur");Ws(vw,"onTransitionEnd");Do("onMouseEnter",["mouseout","mouseover"]);Do("onMouseLeave",["mouseout","mouseover"]);Do("onPointerEnter",["pointerout","pointerover"]);Do("onPointerLeave",["pointerout","pointerover"]);Ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ii("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dl));function vv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,C6(n,t,void 0,e),e.currentTarget=null}function yw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;vv(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;vv(a,o,c),s=l}}}if(If)throw e=zp,If=!1,zp=null,e}function Tt(e,t){var r=t[Yp];r===void 0&&(r=t[Yp]=new Set);var n=e+"__bubble";r.has(n)||(ww(t,e,2,!1),r.add(n))}function Vd(e,t,r){var n=0;t&&(n|=4),ww(r,e,n,t)}var Mu="_reactListening"+Math.random().toString(36).slice(2);function gc(e){if(!e[Mu]){e[Mu]=!0,Cy.forEach(function(r){r!=="selectionchange"&&(NS.has(r)||Vd(r,!1,e),Vd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Mu]||(t[Mu]=!0,Vd("selectionchange",!1,t))}}function ww(e,t,r,n){switch(nw(t)){case 1:var a=W6;break;case 4:a=H6;break;default:a=f0}r=a.bind(null,t,r,e),a=void 0,!jp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Bd(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ii(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}Wy(function(){var c=s,f=o0(r),h=[];e:{var d=bw.get(e);if(d!==void 0){var p=d0,g=e;switch(e){case"keypress":if(pf(r)===0)break e;case"keydown":case"keyup":p=sS;break;case"focusin":g="focus",p=Ld;break;case"focusout":g="blur",p=Ld;break;case"beforeblur":case"afterblur":p=Ld;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=sv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=q6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=lS;break;case pw:case mw:case gw:p=Y6;break;case vw:p=uS;break;case"scroll":p=$6;break;case"wheel":p=hS;break;case"copy":case"cut":case"paste":p=J6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=ov}var m=(t&4)!==0,y=!m&&e==="scroll",k=m?d!==null?d+"Capture":null:d;m=[];for(var b=c,w;b!==null;){w=b;var N=w.stateNode;if(w.tag===5&&N!==null&&(w=N,k!==null&&(N=uc(b,k),N!=null&&m.push(vc(b,N,w)))),y)break;b=b.return}0<m.length&&(d=new p(d,g,null,r,f),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==Mp&&(g=r.relatedTarget||r.fromElement)&&(ii(g)||g[Ua]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?ii(g):null,g!==null&&(y=Ri(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(m=sv,N="onMouseLeave",k="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=ov,N="onPointerLeave",k="onPointerEnter",b="pointer"),y=p==null?d:lo(p),w=g==null?d:lo(g),d=new m(N,b+"leave",p,r,f),d.target=y,d.relatedTarget=w,N=null,ii(f)===c&&(m=new m(k,b+"enter",g,r,f),m.target=w,m.relatedTarget=y,N=m),y=N,p&&g)t:{for(m=p,k=g,b=0,w=m;w;w=Ki(w))b++;for(w=0,N=k;N;N=Ki(N))w++;for(;0<b-w;)m=Ki(m),b--;for(;0<w-b;)k=Ki(k),w--;for(;b--;){if(m===k||k!==null&&m===k.alternate)break t;m=Ki(m),k=Ki(k)}m=null}else m=null;p!==null&&bv(h,d,p,m,!1),g!==null&&y!==null&&bv(h,y,g,m,!0)}}e:{if(d=c?lo(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var _=yS;else if(uv(d))if(cw)_=ES;else{_=kS;var F=wS}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(_=TS);if(_&&(_=_(e,c))){lw(h,_,r,f);break e}F&&F(e,d,c),e==="focusout"&&(F=d._wrapperState)&&F.controlled&&d.type==="number"&&Dp(d,"number",d.value)}switch(F=c?lo(c):window,e){case"focusin":(uv(F)||F.contentEditable==="true")&&(io=F,Hp=c,Hl=null);break;case"focusout":Hl=Hp=io=null;break;case"mousedown":$p=!0;break;case"contextmenu":case"mouseup":case"dragend":$p=!1,mv(h,r,f);break;case"selectionchange":if(_S)break;case"keydown":case"keyup":mv(h,r,f)}var T;if(m0)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else so?iw(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(sw&&r.locale!=="ko"&&(so||S!=="onCompositionStart"?S==="onCompositionEnd"&&so&&(T=aw()):(fs=f,h0="value"in fs?fs.value:fs.textContent,so=!0)),F=Lf(c,S),0<F.length&&(S=new iv(S,e,null,r,f),h.push({event:S,listeners:F}),T?S.data=T:(T=ow(r),T!==null&&(S.data=T)))),(T=pS?mS(e,r):gS(e,r))&&(c=Lf(c,"onBeforeInput"),0<c.length&&(f=new iv("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=T))}yw(h,t)})}function vc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Lf(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=uc(e,r),s!=null&&n.unshift(vc(e,s,a)),s=uc(e,t),s!=null&&n.push(vc(e,s,a))),e=e.return}return n}function Ki(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bv(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=uc(r,s),l!=null&&i.unshift(vc(r,l,o))):a||(l=uc(r,s),l!=null&&i.push(vc(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var IS=/\r\n?/g,RS=/\u0000|\uFFFD/g;function yv(e){return(typeof e=="string"?e:""+e).replace(IS,`
`).replace(RS,"")}function Uu(e,t,r){if(t=yv(t),yv(e)!==t&&r)throw Error(ce(425))}function Ff(){}var Gp=null,qp=null;function Kp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xp=typeof setTimeout=="function"?setTimeout:void 0,DS=typeof clearTimeout=="function"?clearTimeout:void 0,wv=typeof Promise=="function"?Promise:void 0,OS=typeof queueMicrotask=="function"?queueMicrotask:typeof wv<"u"?function(e){return wv.resolve(null).then(e).catch(PS)}:Xp;function PS(e){setTimeout(function(){throw e})}function Wd(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),dc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);dc(t)}function ks(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qo=Math.random().toString(36).slice(2),ua="__reactFiber$"+Qo,bc="__reactProps$"+Qo,Ua="__reactContainer$"+Qo,Yp="__reactEvents$"+Qo,LS="__reactListeners$"+Qo,FS="__reactHandles$"+Qo;function ii(e){var t=e[ua];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ua]||r[ua]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=kv(e);e!==null;){if(r=e[ua])return r;e=kv(e)}return t}e=r,r=e.parentNode}return null}function eu(e){return e=e[ua]||e[Ua],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function Dh(e){return e[bc]||null}var Qp=[],co=-1;function Hs(e){return{current:e}}function xt(e){0>co||(e.current=Qp[co],Qp[co]=null,co--)}function bt(e,t){co++,Qp[co]=e.current,e.current=t}var Ds={},zr=Hs(Ds),rn=Hs(!1),gi=Ds;function Oo(e,t){var r=e.type.contextTypes;if(!r)return Ds;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function nn(e){return e=e.childContextTypes,e!=null}function Mf(){xt(rn),xt(zr)}function Tv(e,t,r){if(zr.current!==Ds)throw Error(ce(168));bt(zr,t),bt(rn,r)}function kw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ce(108,w6(e)||"Unknown",a));return Ot({},r,n)}function Uf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ds,gi=zr.current,bt(zr,e),bt(rn,rn.current),!0}function Ev(e,t,r){var n=e.stateNode;if(!n)throw Error(ce(169));r?(e=kw(e,t,gi),n.__reactInternalMemoizedMergedChildContext=e,xt(rn),xt(zr),bt(zr,e)):xt(rn),bt(rn,r)}var Na=null,Oh=!1,Hd=!1;function Tw(e){Na===null?Na=[e]:Na.push(e)}function MS(e){Oh=!0,Tw(e)}function $s(){if(!Hd&&Na!==null){Hd=!0;var e=0,t=ht;try{var r=Na;for(ht=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Na=null,Oh=!1}catch(a){throw Na!==null&&(Na=Na.slice(e+1)),qy(l0,$s),a}finally{ht=t,Hd=!1}}return null}var uo=[],fo=0,jf=null,zf=0,In=[],Rn=0,vi=null,Ia=1,Ra="";function ri(e,t){uo[fo++]=zf,uo[fo++]=jf,jf=e,zf=t}function Ew(e,t,r){In[Rn++]=Ia,In[Rn++]=Ra,In[Rn++]=vi,vi=e;var n=Ia;e=Ra;var a=32-Xn(n)-1;n&=~(1<<a),r+=1;var s=32-Xn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Ia=1<<32-Xn(t)+a|r<<a|n,Ra=s+e}else Ia=1<<s|r<<a|n,Ra=e}function v0(e){e.return!==null&&(ri(e,1),Ew(e,1,0))}function b0(e){for(;e===jf;)jf=uo[--fo],uo[fo]=null,zf=uo[--fo],uo[fo]=null;for(;e===vi;)vi=In[--Rn],In[Rn]=null,Ra=In[--Rn],In[Rn]=null,Ia=In[--Rn],In[Rn]=null}var mn=null,pn=null,At=!1,Gn=null;function Sw(e,t){var r=Pn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Sv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mn=e,pn=ks(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mn=e,pn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=vi!==null?{id:Ia,overflow:Ra}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Pn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,mn=e,pn=null,!0):!1;default:return!1}}function Jp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zp(e){if(At){var t=pn;if(t){var r=t;if(!Sv(e,t)){if(Jp(e))throw Error(ce(418));t=ks(r.nextSibling);var n=mn;t&&Sv(e,t)?Sw(n,r):(e.flags=e.flags&-4097|2,At=!1,mn=e)}}else{if(Jp(e))throw Error(ce(418));e.flags=e.flags&-4097|2,At=!1,mn=e}}}function xv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mn=e}function ju(e){if(e!==mn)return!1;if(!At)return xv(e),At=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Kp(e.type,e.memoizedProps)),t&&(t=pn)){if(Jp(e))throw xw(),Error(ce(418));for(;t;)Sw(e,t),t=ks(t.nextSibling)}if(xv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){pn=ks(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}pn=null}}else pn=mn?ks(e.stateNode.nextSibling):null;return!0}function xw(){for(var e=pn;e;)e=ks(e.nextSibling)}function Po(){pn=mn=null,At=!1}function y0(e){Gn===null?Gn=[e]:Gn.push(e)}var US=Ha.ReactCurrentBatchConfig;function xl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var n=r.stateNode}if(!n)throw Error(ce(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,e))}return e}function zu(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _v(e){var t=e._init;return t(e._payload)}function _w(e){function t(k,b){if(e){var w=k.deletions;w===null?(k.deletions=[b],k.flags|=16):w.push(b)}}function r(k,b){if(!e)return null;for(;b!==null;)t(k,b),b=b.sibling;return null}function n(k,b){for(k=new Map;b!==null;)b.key!==null?k.set(b.key,b):k.set(b.index,b),b=b.sibling;return k}function a(k,b){return k=xs(k,b),k.index=0,k.sibling=null,k}function s(k,b,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<b?(k.flags|=2,b):w):(k.flags|=2,b)):(k.flags|=1048576,b)}function i(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,b,w,N){return b===null||b.tag!==6?(b=Qd(w,k.mode,N),b.return=k,b):(b=a(b,w),b.return=k,b)}function l(k,b,w,N){var _=w.type;return _===ao?f(k,b,w.props.children,N,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===os&&_v(_)===b.type)?(N=a(b,w.props),N.ref=xl(k,b,w),N.return=k,N):(N=kf(w.type,w.key,w.props,null,k.mode,N),N.ref=xl(k,b,w),N.return=k,N)}function c(k,b,w,N){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=Jd(w,k.mode,N),b.return=k,b):(b=a(b,w.children||[]),b.return=k,b)}function f(k,b,w,N,_){return b===null||b.tag!==7?(b=fi(w,k.mode,N,_),b.return=k,b):(b=a(b,w),b.return=k,b)}function h(k,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Qd(""+b,k.mode,w),b.return=k,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Nu:return w=kf(b.type,b.key,b.props,null,k.mode,w),w.ref=xl(k,null,b),w.return=k,w;case no:return b=Jd(b,k.mode,w),b.return=k,b;case os:var N=b._init;return h(k,N(b._payload),w)}if(Il(b)||wl(b))return b=fi(b,k.mode,w,null),b.return=k,b;zu(k,b)}return null}function d(k,b,w,N){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:o(k,b,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Nu:return w.key===_?l(k,b,w,N):null;case no:return w.key===_?c(k,b,w,N):null;case os:return _=w._init,d(k,b,_(w._payload),N)}if(Il(w)||wl(w))return _!==null?null:f(k,b,w,N,null);zu(k,w)}return null}function p(k,b,w,N,_){if(typeof N=="string"&&N!==""||typeof N=="number")return k=k.get(w)||null,o(b,k,""+N,_);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Nu:return k=k.get(N.key===null?w:N.key)||null,l(b,k,N,_);case no:return k=k.get(N.key===null?w:N.key)||null,c(b,k,N,_);case os:var F=N._init;return p(k,b,w,F(N._payload),_)}if(Il(N)||wl(N))return k=k.get(w)||null,f(b,k,N,_,null);zu(b,N)}return null}function g(k,b,w,N){for(var _=null,F=null,T=b,S=b=0,x=null;T!==null&&S<w.length;S++){T.index>S?(x=T,T=null):x=T.sibling;var I=d(k,T,w[S],N);if(I===null){T===null&&(T=x);break}e&&T&&I.alternate===null&&t(k,T),b=s(I,b,S),F===null?_=I:F.sibling=I,F=I,T=x}if(S===w.length)return r(k,T),At&&ri(k,S),_;if(T===null){for(;S<w.length;S++)T=h(k,w[S],N),T!==null&&(b=s(T,b,S),F===null?_=T:F.sibling=T,F=T);return At&&ri(k,S),_}for(T=n(k,T);S<w.length;S++)x=p(T,k,S,w[S],N),x!==null&&(e&&x.alternate!==null&&T.delete(x.key===null?S:x.key),b=s(x,b,S),F===null?_=x:F.sibling=x,F=x);return e&&T.forEach(function(A){return t(k,A)}),At&&ri(k,S),_}function m(k,b,w,N){var _=wl(w);if(typeof _!="function")throw Error(ce(150));if(w=_.call(w),w==null)throw Error(ce(151));for(var F=_=null,T=b,S=b=0,x=null,I=w.next();T!==null&&!I.done;S++,I=w.next()){T.index>S?(x=T,T=null):x=T.sibling;var A=d(k,T,I.value,N);if(A===null){T===null&&(T=x);break}e&&T&&A.alternate===null&&t(k,T),b=s(A,b,S),F===null?_=A:F.sibling=A,F=A,T=x}if(I.done)return r(k,T),At&&ri(k,S),_;if(T===null){for(;!I.done;S++,I=w.next())I=h(k,I.value,N),I!==null&&(b=s(I,b,S),F===null?_=I:F.sibling=I,F=I);return At&&ri(k,S),_}for(T=n(k,T);!I.done;S++,I=w.next())I=p(T,k,S,I.value,N),I!==null&&(e&&I.alternate!==null&&T.delete(I.key===null?S:I.key),b=s(I,b,S),F===null?_=I:F.sibling=I,F=I);return e&&T.forEach(function(R){return t(k,R)}),At&&ri(k,S),_}function y(k,b,w,N){if(typeof w=="object"&&w!==null&&w.type===ao&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Nu:e:{for(var _=w.key,F=b;F!==null;){if(F.key===_){if(_=w.type,_===ao){if(F.tag===7){r(k,F.sibling),b=a(F,w.props.children),b.return=k,k=b;break e}}else if(F.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===os&&_v(_)===F.type){r(k,F.sibling),b=a(F,w.props),b.ref=xl(k,F,w),b.return=k,k=b;break e}r(k,F);break}else t(k,F);F=F.sibling}w.type===ao?(b=fi(w.props.children,k.mode,N,w.key),b.return=k,k=b):(N=kf(w.type,w.key,w.props,null,k.mode,N),N.ref=xl(k,b,w),N.return=k,k=N)}return i(k);case no:e:{for(F=w.key;b!==null;){if(b.key===F)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(k,b.sibling),b=a(b,w.children||[]),b.return=k,k=b;break e}else{r(k,b);break}else t(k,b);b=b.sibling}b=Jd(w,k.mode,N),b.return=k,k=b}return i(k);case os:return F=w._init,y(k,b,F(w._payload),N)}if(Il(w))return g(k,b,w,N);if(wl(w))return m(k,b,w,N);zu(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(k,b.sibling),b=a(b,w),b.return=k,k=b):(r(k,b),b=Qd(w,k.mode,N),b.return=k,k=b),i(k)):r(k,b)}return y}var Lo=_w(!0),Cw=_w(!1),Vf=Hs(null),Bf=null,ho=null,w0=null;function k0(){w0=ho=Bf=null}function T0(e){var t=Vf.current;xt(Vf),e._currentValue=t}function e1(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function To(e,t){Bf=e,w0=ho=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tn=!0),e.firstContext=null)}function Un(e){var t=e._currentValue;if(w0!==e)if(e={context:e,memoizedValue:t,next:null},ho===null){if(Bf===null)throw Error(ce(308));ho=e,Bf.dependencies={lanes:0,firstContext:e}}else ho=ho.next=e;return t}var oi=null;function E0(e){oi===null?oi=[e]:oi.push(e)}function Aw(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,E0(t)):(r.next=a.next,a.next=r),t.interleaved=r,ja(e,n)}function ja(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ls=!1;function S0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ts(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,rt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ja(e,r)}return a=n.interleaved,a===null?(t.next=t,E0(n)):(t.next=a.next,a.next=t),n.interleaved=t,ja(e,r)}function mf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c0(e,r)}}function Cv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Wf(e,t,r,n){var a=e.updateQueue;ls=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var h=a.baseState;i=0,f=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(d=t,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(p,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,d=typeof g=="function"?g.call(p,h,d):g,d==null)break e;h=Ot({},h,d);break e;case 2:ls=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=h):f=f.next=p,i|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(f===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);yi|=i,e.lanes=i,e.memoizedState=h}}function Av(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ce(191,a));a.call(n)}}}var tu={},da=Hs(tu),yc=Hs(tu),wc=Hs(tu);function li(e){if(e===tu)throw Error(ce(174));return e}function x0(e,t){switch(bt(wc,t),bt(yc,e),bt(da,tu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Pp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Pp(t,e)}xt(da),bt(da,t)}function Fo(){xt(da),xt(yc),xt(wc)}function Iw(e){li(wc.current);var t=li(da.current),r=Pp(t,e.type);t!==r&&(bt(yc,e),bt(da,r))}function _0(e){yc.current===e&&(xt(da),xt(yc))}var Nt=Hs(0);function Hf(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $d=[];function C0(){for(var e=0;e<$d.length;e++)$d[e]._workInProgressVersionPrimary=null;$d.length=0}var gf=Ha.ReactCurrentDispatcher,Gd=Ha.ReactCurrentBatchConfig,bi=0,Dt=null,tr=null,hr=null,$f=!1,$l=!1,kc=0,jS=0;function Cr(){throw Error(ce(321))}function A0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zn(e[r],t[r]))return!1;return!0}function N0(e,t,r,n,a,s){if(bi=s,Dt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,gf.current=e===null||e.memoizedState===null?WS:HS,e=r(n,a),$l){s=0;do{if($l=!1,kc=0,25<=s)throw Error(ce(301));s+=1,hr=tr=null,t.updateQueue=null,gf.current=$S,e=r(n,a)}while($l)}if(gf.current=Gf,t=tr!==null&&tr.next!==null,bi=0,hr=tr=Dt=null,$f=!1,t)throw Error(ce(300));return e}function I0(){var e=kc!==0;return kc=0,e}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Dt.memoizedState=hr=e:hr=hr.next=e,hr}function jn(){if(tr===null){var e=Dt.alternate;e=e!==null?e.memoizedState:null}else e=tr.next;var t=hr===null?Dt.memoizedState:hr.next;if(t!==null)hr=t,tr=e;else{if(e===null)throw Error(ce(310));tr=e,e={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},hr===null?Dt.memoizedState=hr=e:hr=hr.next=e}return hr}function Tc(e,t){return typeof t=="function"?t(e):t}function qd(e){var t=jn(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=tr,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var f=c.lane;if((bi&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,Dt.lanes|=f,yi|=f}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,Zn(n,t.memoizedState)||(tn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Dt.lanes|=s,yi|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Kd(e){var t=jn(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Zn(s,t.memoizedState)||(tn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Rw(){}function Dw(e,t){var r=Dt,n=jn(),a=t(),s=!Zn(n.memoizedState,a);if(s&&(n.memoizedState=a,tn=!0),n=n.queue,R0(Lw.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||hr!==null&&hr.memoizedState.tag&1){if(r.flags|=2048,Ec(9,Pw.bind(null,r,n,a,t),void 0,null),gr===null)throw Error(ce(349));bi&30||Ow(r,t,a)}return a}function Ow(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Dt.updateQueue,t===null?(t={lastEffect:null,stores:null},Dt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Pw(e,t,r,n){t.value=r,t.getSnapshot=n,Fw(t)&&Mw(e)}function Lw(e,t,r){return r(function(){Fw(t)&&Mw(e)})}function Fw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zn(e,r)}catch{return!0}}function Mw(e){var t=ja(e,1);t!==null&&Yn(t,e,1,-1)}function Nv(e){var t=la();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tc,lastRenderedState:e},t.queue=e,e=e.dispatch=BS.bind(null,Dt,e),[t.memoizedState,e]}function Ec(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Dt.updateQueue,t===null?(t={lastEffect:null,stores:null},Dt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Uw(){return jn().memoizedState}function vf(e,t,r,n){var a=la();Dt.flags|=e,a.memoizedState=Ec(1|t,r,void 0,n===void 0?null:n)}function Ph(e,t,r,n){var a=jn();n=n===void 0?null:n;var s=void 0;if(tr!==null){var i=tr.memoizedState;if(s=i.destroy,n!==null&&A0(n,i.deps)){a.memoizedState=Ec(t,r,s,n);return}}Dt.flags|=e,a.memoizedState=Ec(1|t,r,s,n)}function Iv(e,t){return vf(8390656,8,e,t)}function R0(e,t){return Ph(2048,8,e,t)}function jw(e,t){return Ph(4,2,e,t)}function zw(e,t){return Ph(4,4,e,t)}function Vw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Bw(e,t,r){return r=r!=null?r.concat([e]):null,Ph(4,4,Vw.bind(null,t,e),r)}function D0(){}function Ww(e,t){var r=jn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&A0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Hw(e,t){var r=jn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&A0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function $w(e,t,r){return bi&21?(Zn(r,t)||(r=Yy(),Dt.lanes|=r,yi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tn=!0),e.memoizedState=r)}function zS(e,t){var r=ht;ht=r!==0&&4>r?r:4,e(!0);var n=Gd.transition;Gd.transition={};try{e(!1),t()}finally{ht=r,Gd.transition=n}}function Gw(){return jn().memoizedState}function VS(e,t,r){var n=Ss(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qw(e))Kw(t,r);else if(r=Aw(e,t,r,n),r!==null){var a=qr();Yn(r,e,n,a),Xw(r,t,n)}}function BS(e,t,r){var n=Ss(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qw(e))Kw(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Zn(o,i)){var l=t.interleaved;l===null?(a.next=a,E0(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=Aw(e,t,a,n),r!==null&&(a=qr(),Yn(r,e,n,a),Xw(r,t,n))}}function qw(e){var t=e.alternate;return e===Dt||t!==null&&t===Dt}function Kw(e,t){$l=$f=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xw(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c0(e,r)}}var Gf={readContext:Un,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useInsertionEffect:Cr,useLayoutEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useMutableSource:Cr,useSyncExternalStore:Cr,useId:Cr,unstable_isNewReconciler:!1},WS={readContext:Un,useCallback:function(e,t){return la().memoizedState=[e,t===void 0?null:t],e},useContext:Un,useEffect:Iv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,vf(4194308,4,Vw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return vf(4194308,4,e,t)},useInsertionEffect:function(e,t){return vf(4,2,e,t)},useMemo:function(e,t){var r=la();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=la();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=VS.bind(null,Dt,e),[n.memoizedState,e]},useRef:function(e){var t=la();return e={current:e},t.memoizedState=e},useState:Nv,useDebugValue:D0,useDeferredValue:function(e){return la().memoizedState=e},useTransition:function(){var e=Nv(!1),t=e[0];return e=zS.bind(null,e[1]),la().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Dt,a=la();if(At){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=t(),gr===null)throw Error(ce(349));bi&30||Ow(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Iv(Lw.bind(null,n,s,e),[e]),n.flags|=2048,Ec(9,Pw.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=la(),t=gr.identifierPrefix;if(At){var r=Ra,n=Ia;r=(n&~(1<<32-Xn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=kc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=jS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},HS={readContext:Un,useCallback:Ww,useContext:Un,useEffect:R0,useImperativeHandle:Bw,useInsertionEffect:jw,useLayoutEffect:zw,useMemo:Hw,useReducer:qd,useRef:Uw,useState:function(){return qd(Tc)},useDebugValue:D0,useDeferredValue:function(e){var t=jn();return $w(t,tr.memoizedState,e)},useTransition:function(){var e=qd(Tc)[0],t=jn().memoizedState;return[e,t]},useMutableSource:Rw,useSyncExternalStore:Dw,useId:Gw,unstable_isNewReconciler:!1},$S={readContext:Un,useCallback:Ww,useContext:Un,useEffect:R0,useImperativeHandle:Bw,useInsertionEffect:jw,useLayoutEffect:zw,useMemo:Hw,useReducer:Kd,useRef:Uw,useState:function(){return Kd(Tc)},useDebugValue:D0,useDeferredValue:function(e){var t=jn();return tr===null?t.memoizedState=e:$w(t,tr.memoizedState,e)},useTransition:function(){var e=Kd(Tc)[0],t=jn().memoizedState;return[e,t]},useMutableSource:Rw,useSyncExternalStore:Dw,useId:Gw,unstable_isNewReconciler:!1};function Hn(e,t){if(e&&e.defaultProps){t=Ot({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function t1(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ot({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Lh={isMounted:function(e){return(e=e._reactInternals)?Ri(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qr(),a=Ss(e),s=Oa(n,a);s.payload=t,r!=null&&(s.callback=r),t=Ts(e,s,a),t!==null&&(Yn(t,e,a,n),mf(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qr(),a=Ss(e),s=Oa(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ts(e,s,a),t!==null&&(Yn(t,e,a,n),mf(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qr(),n=Ss(e),a=Oa(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ts(e,a,n),t!==null&&(Yn(t,e,n,r),mf(t,e,n))}};function Rv(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!mc(r,n)||!mc(a,s):!0}function Yw(e,t,r){var n=!1,a=Ds,s=t.contextType;return typeof s=="object"&&s!==null?s=Un(s):(a=nn(t)?gi:zr.current,n=t.contextTypes,s=(n=n!=null)?Oo(e,a):Ds),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Lh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Dv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Lh.enqueueReplaceState(t,t.state,null)}function r1(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},S0(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Un(s):(s=nn(t)?gi:zr.current,a.context=Oo(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(t1(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Lh.enqueueReplaceState(a,a.state,null),Wf(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Mo(e,t){try{var r="",n=t;do r+=y6(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Xd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function n1(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var GS=typeof WeakMap=="function"?WeakMap:Map;function Qw(e,t,r){r=Oa(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Kf||(Kf=!0,h1=n),n1(e,t)},r}function Jw(e,t,r){r=Oa(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){n1(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){n1(e,t),typeof n!="function"&&(Es===null?Es=new Set([this]):Es.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Ov(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new GS;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=i5.bind(null,e,t,r),t.then(e,e))}function Pv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Lv(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Oa(-1,1),t.tag=2,Ts(r,t,1))),r.lanes|=1),e)}var qS=Ha.ReactCurrentOwner,tn=!1;function Hr(e,t,r,n){t.child=e===null?Cw(t,null,r,n):Lo(t,e.child,r,n)}function Fv(e,t,r,n,a){r=r.render;var s=t.ref;return To(t,a),n=N0(e,t,r,n,s,a),r=I0(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,za(e,t,a)):(At&&r&&v0(t),t.flags|=1,Hr(e,t,n,a),t.child)}function Mv(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!z0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Zw(e,t,s,n,a)):(e=kf(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:mc,r(i,n)&&e.ref===t.ref)return za(e,t,a)}return t.flags|=1,e=xs(s,n),e.ref=t.ref,e.return=t,t.child=e}function Zw(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(mc(s,n)&&e.ref===t.ref)if(tn=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(tn=!0);else return t.lanes=e.lanes,za(e,t,a)}return a1(e,t,r,n,a)}function e4(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(mo,un),un|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,bt(mo,un),un|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,bt(mo,un),un|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,bt(mo,un),un|=n;return Hr(e,t,a,r),t.child}function t4(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function a1(e,t,r,n,a){var s=nn(r)?gi:zr.current;return s=Oo(t,s),To(t,a),r=N0(e,t,r,n,s,a),n=I0(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,za(e,t,a)):(At&&n&&v0(t),t.flags|=1,Hr(e,t,r,a),t.child)}function Uv(e,t,r,n,a){if(nn(r)){var s=!0;Uf(t)}else s=!1;if(To(t,a),t.stateNode===null)bf(e,t),Yw(t,r,n),r1(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Un(c):(c=nn(r)?gi:zr.current,c=Oo(t,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Dv(t,i,n,c),ls=!1;var d=t.memoizedState;i.state=d,Wf(t,n,i,a),l=t.memoizedState,o!==n||d!==l||rn.current||ls?(typeof f=="function"&&(t1(t,r,f,n),l=t.memoizedState),(o=ls||Rv(t,r,o,n,d,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Nw(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Hn(t.type,o),i.props=c,h=t.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Un(l):(l=nn(r)?gi:zr.current,l=Oo(t,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Dv(t,i,n,l),ls=!1,d=t.memoizedState,i.state=d,Wf(t,n,i,a);var g=t.memoizedState;o!==h||d!==g||rn.current||ls?(typeof p=="function"&&(t1(t,r,p,n),g=t.memoizedState),(c=ls||Rv(t,r,c,n,d,g,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return s1(e,t,r,n,s,a)}function s1(e,t,r,n,a,s){t4(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Ev(t,r,!1),za(e,t,s);n=t.stateNode,qS.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Lo(t,e.child,null,s),t.child=Lo(t,null,o,s)):Hr(e,t,o,s),t.memoizedState=n.state,a&&Ev(t,r,!0),t.child}function r4(e){var t=e.stateNode;t.pendingContext?Tv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Tv(e,t.context,!1),x0(e,t.containerInfo)}function jv(e,t,r,n,a){return Po(),y0(a),t.flags|=256,Hr(e,t,r,n),t.child}var i1={dehydrated:null,treeContext:null,retryLane:0};function o1(e){return{baseLanes:e,cachePool:null,transitions:null}}function n4(e,t,r){var n=t.pendingProps,a=Nt.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),bt(Nt,a&1),e===null)return Zp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Uh(i,n,0,null),e=fi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=o1(r),t.memoizedState=i1,e):O0(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return KS(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=xs(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=xs(o,s):(s=fi(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?o1(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=i1,n}return s=e.child,e=s.sibling,n=xs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function O0(e,t){return t=Uh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Vu(e,t,r,n){return n!==null&&y0(n),Lo(t,e.child,null,r),e=O0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function KS(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Xd(Error(ce(422))),Vu(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Uh({mode:"visible",children:n.children},a,0,null),s=fi(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Lo(t,e.child,null,i),t.child.memoizedState=o1(i),t.memoizedState=i1,s);if(!(t.mode&1))return Vu(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ce(419)),n=Xd(s,n,void 0),Vu(e,t,i,n)}if(o=(i&e.childLanes)!==0,tn||o){if(n=gr,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ja(e,a),Yn(n,e,a,-1))}return j0(),n=Xd(Error(ce(421))),Vu(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=o5.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,pn=ks(a.nextSibling),mn=t,At=!0,Gn=null,e!==null&&(In[Rn++]=Ia,In[Rn++]=Ra,In[Rn++]=vi,Ia=e.id,Ra=e.overflow,vi=t),t=O0(t,n.children),t.flags|=4096,t)}function zv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),e1(e.return,t,r)}function Yd(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function a4(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Hr(e,t,n.children,r),n=Nt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&zv(e,r,t);else if(e.tag===19)zv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(bt(Nt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Hf(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Yd(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Hf(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Yd(t,!0,r,null,s);break;case"together":Yd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function za(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),yi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,r=xs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function XS(e,t,r){switch(t.tag){case 3:r4(t),Po();break;case 5:Iw(t);break;case 1:nn(t.type)&&Uf(t);break;case 4:x0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;bt(Vf,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(bt(Nt,Nt.current&1),t.flags|=128,null):r&t.child.childLanes?n4(e,t,r):(bt(Nt,Nt.current&1),e=za(e,t,r),e!==null?e.sibling:null);bt(Nt,Nt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return a4(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),bt(Nt,Nt.current),n)break;return null;case 22:case 23:return t.lanes=0,e4(e,t,r)}return za(e,t,r)}var s4,l1,i4,o4;s4=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};l1=function(){};i4=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,li(da.current);var s=null;switch(r){case"input":a=Ip(e,a),n=Ip(e,n),s=[];break;case"select":a=Ot({},a,{value:void 0}),n=Ot({},n,{value:void 0}),s=[];break;case"textarea":a=Op(e,a),n=Op(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ff)}Lp(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(lc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(lc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Tt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};o4=function(e,t,r,n){r!==n&&(t.flags|=4)};function _l(e,t){if(!At)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ar(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function YS(e,t,r){var n=t.pendingProps;switch(b0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ar(t),null;case 1:return nn(t.type)&&Mf(),Ar(t),null;case 3:return n=t.stateNode,Fo(),xt(rn),xt(zr),C0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ju(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gn!==null&&(m1(Gn),Gn=null))),l1(e,t),Ar(t),null;case 5:_0(t);var a=li(wc.current);if(r=t.type,e!==null&&t.stateNode!=null)i4(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ce(166));return Ar(t),null}if(e=li(da.current),ju(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ua]=t,n[bc]=s,e=(t.mode&1)!==0,r){case"dialog":Tt("cancel",n),Tt("close",n);break;case"iframe":case"object":case"embed":Tt("load",n);break;case"video":case"audio":for(a=0;a<Dl.length;a++)Tt(Dl[a],n);break;case"source":Tt("error",n);break;case"img":case"image":case"link":Tt("error",n),Tt("load",n);break;case"details":Tt("toggle",n);break;case"input":Xg(n,s),Tt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Tt("invalid",n);break;case"textarea":Qg(n,s),Tt("invalid",n)}Lp(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Uu(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Uu(n.textContent,o,e),a=["children",""+o]):lc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Tt("scroll",n)}switch(r){case"input":Iu(n),Yg(n,s,!0);break;case"textarea":Iu(n),Jg(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ff)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ly(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ua]=t,e[bc]=n,s4(e,t,!1,!1),t.stateNode=e;e:{switch(i=Fp(r,n),r){case"dialog":Tt("cancel",e),Tt("close",e),a=n;break;case"iframe":case"object":case"embed":Tt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Dl.length;a++)Tt(Dl[a],e);a=n;break;case"source":Tt("error",e),a=n;break;case"img":case"image":case"link":Tt("error",e),Tt("load",e),a=n;break;case"details":Tt("toggle",e),a=n;break;case"input":Xg(e,n),a=Ip(e,n),Tt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ot({},n,{value:void 0}),Tt("invalid",e);break;case"textarea":Qg(e,n),a=Op(e,n),Tt("invalid",e);break;default:a=n}Lp(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Uy(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Fy(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&cc(e,l):typeof l=="number"&&cc(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Tt("scroll",e):l!=null&&n0(e,s,l,i))}switch(r){case"input":Iu(e),Yg(e,n,!1);break;case"textarea":Iu(e),Jg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Rs(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?bo(e,!!n.multiple,s,!1):n.defaultValue!=null&&bo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ff)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ar(t),null;case 6:if(e&&t.stateNode!=null)o4(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ce(166));if(r=li(wc.current),li(da.current),ju(t)){if(n=t.stateNode,r=t.memoizedProps,n[ua]=t,(s=n.nodeValue!==r)&&(e=mn,e!==null))switch(e.tag){case 3:Uu(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Uu(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ua]=t,t.stateNode=n}return Ar(t),null;case 13:if(xt(Nt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(At&&pn!==null&&t.mode&1&&!(t.flags&128))xw(),Po(),t.flags|=98560,s=!1;else if(s=ju(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ce(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ce(317));s[ua]=t}else Po(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ar(t),s=!1}else Gn!==null&&(m1(Gn),Gn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Nt.current&1?ar===0&&(ar=3):j0())),t.updateQueue!==null&&(t.flags|=4),Ar(t),null);case 4:return Fo(),l1(e,t),e===null&&gc(t.stateNode.containerInfo),Ar(t),null;case 10:return T0(t.type._context),Ar(t),null;case 17:return nn(t.type)&&Mf(),Ar(t),null;case 19:if(xt(Nt),s=t.memoizedState,s===null)return Ar(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)_l(s,!1);else{if(ar!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Hf(e),i!==null){for(t.flags|=128,_l(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return bt(Nt,Nt.current&1|2),t.child}e=e.sibling}s.tail!==null&&$t()>Uo&&(t.flags|=128,n=!0,_l(s,!1),t.lanes=4194304)}else{if(!n)if(e=Hf(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),_l(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!At)return Ar(t),null}else 2*$t()-s.renderingStartTime>Uo&&r!==1073741824&&(t.flags|=128,n=!0,_l(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=$t(),t.sibling=null,r=Nt.current,bt(Nt,n?r&1|2:r&1),t):(Ar(t),null);case 22:case 23:return U0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?un&1073741824&&(Ar(t),t.subtreeFlags&6&&(t.flags|=8192)):Ar(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function QS(e,t){switch(b0(t),t.tag){case 1:return nn(t.type)&&Mf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fo(),xt(rn),xt(zr),C0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _0(t),null;case 13:if(xt(Nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));Po()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xt(Nt),null;case 4:return Fo(),null;case 10:return T0(t.type._context),null;case 22:case 23:return U0(),null;case 24:return null;default:return null}}var Bu=!1,Pr=!1,JS=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function po(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ut(e,t,n)}else r.current=null}function l4(e,t,r){try{r()}catch(n){Ut(e,t,n)}}var Vv=!1;function ZS(e,t){if(Gp=Of,e=hw(),g0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,h=e,d=null;t:for(;;){for(var p;h!==r||a!==0&&h.nodeType!==3||(o=i+a),h!==s||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===e)break t;if(d===r&&++c===a&&(o=i),d===s&&++f===n&&(l=i),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(qp={focusedElem:e,selectionRange:r},Of=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,y=g.memoizedState,k=t.stateNode,b=k.getSnapshotBeforeUpdate(t.elementType===t.type?m:Hn(t.type,m),y);k.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(N){Ut(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return g=Vv,Vv=!1,g}function Gl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&l4(t,r,s)}a=a.next}while(a!==n)}}function Fh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function c1(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function c4(e){var t=e.alternate;t!==null&&(e.alternate=null,c4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ua],delete t[bc],delete t[Yp],delete t[LS],delete t[FS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function u4(e){return e.tag===5||e.tag===3||e.tag===4}function Bv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||u4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function u1(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ff));else if(n!==4&&(e=e.child,e!==null))for(u1(e,t,r),e=e.sibling;e!==null;)u1(e,t,r),e=e.sibling}function f1(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(f1(e,t,r),e=e.sibling;e!==null;)f1(e,t,r),e=e.sibling}var br=null,$n=!1;function ns(e,t,r){for(r=r.child;r!==null;)f4(e,t,r),r=r.sibling}function f4(e,t,r){if(ha&&typeof ha.onCommitFiberUnmount=="function")try{ha.onCommitFiberUnmount(Ah,r)}catch{}switch(r.tag){case 5:Pr||po(r,t);case 6:var n=br,a=$n;br=null,ns(e,t,r),br=n,$n=a,br!==null&&($n?(e=br,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):br.removeChild(r.stateNode));break;case 18:br!==null&&($n?(e=br,r=r.stateNode,e.nodeType===8?Wd(e.parentNode,r):e.nodeType===1&&Wd(e,r),dc(e)):Wd(br,r.stateNode));break;case 4:n=br,a=$n,br=r.stateNode.containerInfo,$n=!0,ns(e,t,r),br=n,$n=a;break;case 0:case 11:case 14:case 15:if(!Pr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&l4(r,t,i),a=a.next}while(a!==n)}ns(e,t,r);break;case 1:if(!Pr&&(po(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ut(r,t,o)}ns(e,t,r);break;case 21:ns(e,t,r);break;case 22:r.mode&1?(Pr=(n=Pr)||r.memoizedState!==null,ns(e,t,r),Pr=n):ns(e,t,r);break;default:ns(e,t,r)}}function Wv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new JS),t.forEach(function(n){var a=l5.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Bn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:br=o.stateNode,$n=!1;break e;case 3:br=o.stateNode.containerInfo,$n=!0;break e;case 4:br=o.stateNode.containerInfo,$n=!0;break e}o=o.return}if(br===null)throw Error(ce(160));f4(s,i,a),br=null,$n=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Ut(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)h4(t,e),t=t.sibling}function h4(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bn(t,e),aa(e),n&4){try{Gl(3,e,e.return),Fh(3,e)}catch(m){Ut(e,e.return,m)}try{Gl(5,e,e.return)}catch(m){Ut(e,e.return,m)}}break;case 1:Bn(t,e),aa(e),n&512&&r!==null&&po(r,r.return);break;case 5:if(Bn(t,e),aa(e),n&512&&r!==null&&po(r,r.return),e.flags&32){var a=e.stateNode;try{cc(a,"")}catch(m){Ut(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Oy(a,s),Fp(o,i);var c=Fp(o,s);for(i=0;i<l.length;i+=2){var f=l[i],h=l[i+1];f==="style"?Uy(a,h):f==="dangerouslySetInnerHTML"?Fy(a,h):f==="children"?cc(a,h):n0(a,f,h,c)}switch(o){case"input":Rp(a,s);break;case"textarea":Py(a,s);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?bo(a,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?bo(a,!!s.multiple,s.defaultValue,!0):bo(a,!!s.multiple,s.multiple?[]:"",!1))}a[bc]=s}catch(m){Ut(e,e.return,m)}}break;case 6:if(Bn(t,e),aa(e),n&4){if(e.stateNode===null)throw Error(ce(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){Ut(e,e.return,m)}}break;case 3:if(Bn(t,e),aa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{dc(t.containerInfo)}catch(m){Ut(e,e.return,m)}break;case 4:Bn(t,e),aa(e);break;case 13:Bn(t,e),aa(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(F0=$t())),n&4&&Wv(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Pr=(c=Pr)||f,Bn(t,e),Pr=c):Bn(t,e),aa(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Ce=e,f=e.child;f!==null;){for(h=Ce=f;Ce!==null;){switch(d=Ce,p=d.child,d.tag){case 0:case 11:case 14:case 15:Gl(4,d,d.return);break;case 1:po(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Ut(n,r,m)}}break;case 5:po(d,d.return);break;case 22:if(d.memoizedState!==null){$v(h);continue}}p!==null?(p.return=d,Ce=p):$v(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{a=h.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=My("display",i))}catch(m){Ut(e,e.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Ut(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Bn(t,e),aa(e),n&4&&Wv(e);break;case 21:break;default:Bn(t,e),aa(e)}}function aa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(u4(r)){var n=r;break e}r=r.return}throw Error(ce(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(cc(a,""),n.flags&=-33);var s=Bv(e);f1(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Bv(e);u1(e,o,i);break;default:throw Error(ce(161))}}catch(l){Ut(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function e5(e,t,r){Ce=e,d4(e)}function d4(e,t,r){for(var n=(e.mode&1)!==0;Ce!==null;){var a=Ce,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Bu;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Pr;o=Bu;var c=Pr;if(Bu=i,(Pr=l)&&!c)for(Ce=a;Ce!==null;)i=Ce,l=i.child,i.tag===22&&i.memoizedState!==null?Gv(a):l!==null?(l.return=i,Ce=l):Gv(a);for(;s!==null;)Ce=s,d4(s),s=s.sibling;Ce=a,Bu=o,Pr=c}Hv(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ce=s):Hv(e)}}function Hv(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pr||Fh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Pr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Hn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Av(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Av(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&dc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Pr||t.flags&512&&c1(t)}catch(d){Ut(t,t.return,d)}}if(t===e){Ce=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ce=r;break}Ce=t.return}}function $v(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ce=r;break}Ce=t.return}}function Gv(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Fh(4,t)}catch(l){Ut(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Ut(t,a,l)}}var s=t.return;try{c1(t)}catch(l){Ut(t,s,l)}break;case 5:var i=t.return;try{c1(t)}catch(l){Ut(t,i,l)}}}catch(l){Ut(t,t.return,l)}if(t===e){Ce=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ce=o;break}Ce=t.return}}var t5=Math.ceil,qf=Ha.ReactCurrentDispatcher,P0=Ha.ReactCurrentOwner,Fn=Ha.ReactCurrentBatchConfig,rt=0,gr=null,Qt=null,Er=0,un=0,mo=Hs(0),ar=0,Sc=null,yi=0,Mh=0,L0=0,ql=null,en=null,F0=0,Uo=1/0,Aa=null,Kf=!1,h1=null,Es=null,Wu=!1,hs=null,Xf=0,Kl=0,d1=null,yf=-1,wf=0;function qr(){return rt&6?$t():yf!==-1?yf:yf=$t()}function Ss(e){return e.mode&1?rt&2&&Er!==0?Er&-Er:US.transition!==null?(wf===0&&(wf=Yy()),wf):(e=ht,e!==0||(e=window.event,e=e===void 0?16:nw(e.type)),e):1}function Yn(e,t,r,n){if(50<Kl)throw Kl=0,d1=null,Error(ce(185));Jc(e,r,n),(!(rt&2)||e!==gr)&&(e===gr&&(!(rt&2)&&(Mh|=r),ar===4&&us(e,Er)),an(e,n),r===1&&rt===0&&!(t.mode&1)&&(Uo=$t()+500,Oh&&$s()))}function an(e,t){var r=e.callbackNode;U6(e,t);var n=Df(e,e===gr?Er:0);if(n===0)r!==null&&tv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&tv(r),t===1)e.tag===0?MS(qv.bind(null,e)):Tw(qv.bind(null,e)),OS(function(){!(rt&6)&&$s()}),r=null;else{switch(Qy(n)){case 1:r=l0;break;case 4:r=Ky;break;case 16:r=Rf;break;case 536870912:r=Xy;break;default:r=Rf}r=k4(r,p4.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function p4(e,t){if(yf=-1,wf=0,rt&6)throw Error(ce(327));var r=e.callbackNode;if(Eo()&&e.callbackNode!==r)return null;var n=Df(e,e===gr?Er:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yf(e,n);else{t=n;var a=rt;rt|=2;var s=g4();(gr!==e||Er!==t)&&(Aa=null,Uo=$t()+500,ui(e,t));do try{a5();break}catch(o){m4(e,o)}while(!0);k0(),qf.current=s,rt=a,Qt!==null?t=0:(gr=null,Er=0,t=ar)}if(t!==0){if(t===2&&(a=Vp(e),a!==0&&(n=a,t=p1(e,a))),t===1)throw r=Sc,ui(e,0),us(e,n),an(e,$t()),r;if(t===6)us(e,n);else{if(a=e.current.alternate,!(n&30)&&!r5(a)&&(t=Yf(e,n),t===2&&(s=Vp(e),s!==0&&(n=s,t=p1(e,s))),t===1))throw r=Sc,ui(e,0),us(e,n),an(e,$t()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ce(345));case 2:ni(e,en,Aa);break;case 3:if(us(e,n),(n&130023424)===n&&(t=F0+500-$t(),10<t)){if(Df(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){qr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Xp(ni.bind(null,e,en,Aa),t);break}ni(e,en,Aa);break;case 4:if(us(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Xn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=$t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*t5(n/1960))-n,10<n){e.timeoutHandle=Xp(ni.bind(null,e,en,Aa),n);break}ni(e,en,Aa);break;case 5:ni(e,en,Aa);break;default:throw Error(ce(329))}}}return an(e,$t()),e.callbackNode===r?p4.bind(null,e):null}function p1(e,t){var r=ql;return e.current.memoizedState.isDehydrated&&(ui(e,t).flags|=256),e=Yf(e,t),e!==2&&(t=en,en=r,t!==null&&m1(t)),e}function m1(e){en===null?en=e:en.push.apply(en,e)}function r5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Zn(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function us(e,t){for(t&=~L0,t&=~Mh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xn(t),n=1<<r;e[r]=-1,t&=~n}}function qv(e){if(rt&6)throw Error(ce(327));Eo();var t=Df(e,0);if(!(t&1))return an(e,$t()),null;var r=Yf(e,t);if(e.tag!==0&&r===2){var n=Vp(e);n!==0&&(t=n,r=p1(e,n))}if(r===1)throw r=Sc,ui(e,0),us(e,t),an(e,$t()),r;if(r===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ni(e,en,Aa),an(e,$t()),null}function M0(e,t){var r=rt;rt|=1;try{return e(t)}finally{rt=r,rt===0&&(Uo=$t()+500,Oh&&$s())}}function wi(e){hs!==null&&hs.tag===0&&!(rt&6)&&Eo();var t=rt;rt|=1;var r=Fn.transition,n=ht;try{if(Fn.transition=null,ht=1,e)return e()}finally{ht=n,Fn.transition=r,rt=t,!(rt&6)&&$s()}}function U0(){un=mo.current,xt(mo)}function ui(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,DS(r)),Qt!==null)for(r=Qt.return;r!==null;){var n=r;switch(b0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Mf();break;case 3:Fo(),xt(rn),xt(zr),C0();break;case 5:_0(n);break;case 4:Fo();break;case 13:xt(Nt);break;case 19:xt(Nt);break;case 10:T0(n.type._context);break;case 22:case 23:U0()}r=r.return}if(gr=e,Qt=e=xs(e.current,null),Er=un=t,ar=0,Sc=null,L0=Mh=yi=0,en=ql=null,oi!==null){for(t=0;t<oi.length;t++)if(r=oi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}oi=null}return e}function m4(e,t){do{var r=Qt;try{if(k0(),gf.current=Gf,$f){for(var n=Dt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}$f=!1}if(bi=0,hr=tr=Dt=null,$l=!1,kc=0,P0.current=null,r===null||r.return===null){ar=1,Sc=t,Qt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=Er,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=Pv(i);if(p!==null){p.flags&=-257,Lv(p,i,o,s,t),p.mode&1&&Ov(s,c,t),t=p,l=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){Ov(s,c,t),j0();break e}l=Error(ce(426))}}else if(At&&o.mode&1){var y=Pv(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Lv(y,i,o,s,t),y0(Mo(l,o));break e}}s=l=Mo(l,o),ar!==4&&(ar=2),ql===null?ql=[s]:ql.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var k=Qw(s,l,t);Cv(s,k);break e;case 1:o=l;var b=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Es===null||!Es.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var N=Jw(s,o,t);Cv(s,N);break e}}s=s.return}while(s!==null)}b4(r)}catch(_){t=_,Qt===r&&r!==null&&(Qt=r=r.return);continue}break}while(!0)}function g4(){var e=qf.current;return qf.current=Gf,e===null?Gf:e}function j0(){(ar===0||ar===3||ar===2)&&(ar=4),gr===null||!(yi&268435455)&&!(Mh&268435455)||us(gr,Er)}function Yf(e,t){var r=rt;rt|=2;var n=g4();(gr!==e||Er!==t)&&(Aa=null,ui(e,t));do try{n5();break}catch(a){m4(e,a)}while(!0);if(k0(),rt=r,qf.current=n,Qt!==null)throw Error(ce(261));return gr=null,Er=0,ar}function n5(){for(;Qt!==null;)v4(Qt)}function a5(){for(;Qt!==null&&!N6();)v4(Qt)}function v4(e){var t=w4(e.alternate,e,un);e.memoizedProps=e.pendingProps,t===null?b4(e):Qt=t,P0.current=null}function b4(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=QS(r,t),r!==null){r.flags&=32767,Qt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ar=6,Qt=null;return}}else if(r=YS(r,t,un),r!==null){Qt=r;return}if(t=t.sibling,t!==null){Qt=t;return}Qt=t=e}while(t!==null);ar===0&&(ar=5)}function ni(e,t,r){var n=ht,a=Fn.transition;try{Fn.transition=null,ht=1,s5(e,t,r,n)}finally{Fn.transition=a,ht=n}return null}function s5(e,t,r,n){do Eo();while(hs!==null);if(rt&6)throw Error(ce(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(j6(e,s),e===gr&&(Qt=gr=null,Er=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Wu||(Wu=!0,k4(Rf,function(){return Eo(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Fn.transition,Fn.transition=null;var i=ht;ht=1;var o=rt;rt|=4,P0.current=null,ZS(e,r),h4(r,e),xS(qp),Of=!!Gp,qp=Gp=null,e.current=r,e5(r),I6(),rt=o,ht=i,Fn.transition=s}else e.current=r;if(Wu&&(Wu=!1,hs=e,Xf=a),s=e.pendingLanes,s===0&&(Es=null),O6(r.stateNode),an(e,$t()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Kf)throw Kf=!1,e=h1,h1=null,e;return Xf&1&&e.tag!==0&&Eo(),s=e.pendingLanes,s&1?e===d1?Kl++:(Kl=0,d1=e):Kl=0,$s(),null}function Eo(){if(hs!==null){var e=Qy(Xf),t=Fn.transition,r=ht;try{if(Fn.transition=null,ht=16>e?16:e,hs===null)var n=!1;else{if(e=hs,hs=null,Xf=0,rt&6)throw Error(ce(331));var a=rt;for(rt|=4,Ce=e.current;Ce!==null;){var s=Ce,i=s.child;if(Ce.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var f=Ce;switch(f.tag){case 0:case 11:case 15:Gl(8,f,s)}var h=f.child;if(h!==null)h.return=f,Ce=h;else for(;Ce!==null;){f=Ce;var d=f.sibling,p=f.return;if(c4(f),f===c){Ce=null;break}if(d!==null){d.return=p,Ce=d;break}Ce=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}Ce=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ce=i;else e:for(;Ce!==null;){if(s=Ce,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gl(9,s,s.return)}var k=s.sibling;if(k!==null){k.return=s.return,Ce=k;break e}Ce=s.return}}var b=e.current;for(Ce=b;Ce!==null;){i=Ce;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Ce=w;else e:for(i=b;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Fh(9,o)}}catch(_){Ut(o,o.return,_)}if(o===i){Ce=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Ce=N;break e}Ce=o.return}}if(rt=a,$s(),ha&&typeof ha.onPostCommitFiberRoot=="function")try{ha.onPostCommitFiberRoot(Ah,e)}catch{}n=!0}return n}finally{ht=r,Fn.transition=t}}return!1}function Kv(e,t,r){t=Mo(r,t),t=Qw(e,t,1),e=Ts(e,t,1),t=qr(),e!==null&&(Jc(e,1,t),an(e,t))}function Ut(e,t,r){if(e.tag===3)Kv(e,e,r);else for(;t!==null;){if(t.tag===3){Kv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Es===null||!Es.has(n))){e=Mo(r,e),e=Jw(t,e,1),t=Ts(t,e,1),e=qr(),t!==null&&(Jc(t,1,e),an(t,e));break}}t=t.return}}function i5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qr(),e.pingedLanes|=e.suspendedLanes&r,gr===e&&(Er&r)===r&&(ar===4||ar===3&&(Er&130023424)===Er&&500>$t()-F0?ui(e,0):L0|=r),an(e,t)}function y4(e,t){t===0&&(e.mode&1?(t=Ou,Ou<<=1,!(Ou&130023424)&&(Ou=4194304)):t=1);var r=qr();e=ja(e,t),e!==null&&(Jc(e,t,r),an(e,r))}function o5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),y4(e,r)}function l5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(t),y4(e,r)}var w4;w4=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||rn.current)tn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return tn=!1,XS(e,t,r);tn=!!(e.flags&131072)}else tn=!1,At&&t.flags&1048576&&Ew(t,zf,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;bf(e,t),e=t.pendingProps;var a=Oo(t,zr.current);To(t,r),a=N0(null,t,n,e,a,r);var s=I0();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,nn(n)?(s=!0,Uf(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,S0(t),a.updater=Lh,t.stateNode=a,a._reactInternals=t,r1(t,n,e,r),t=s1(null,t,n,!0,s,r)):(t.tag=0,At&&s&&v0(t),Hr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(bf(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=u5(n),e=Hn(n,e),a){case 0:t=a1(null,t,n,e,r);break e;case 1:t=Uv(null,t,n,e,r);break e;case 11:t=Fv(null,t,n,e,r);break e;case 14:t=Mv(null,t,n,Hn(n.type,e),r);break e}throw Error(ce(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),a1(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),Uv(e,t,n,a,r);case 3:e:{if(r4(t),e===null)throw Error(ce(387));n=t.pendingProps,s=t.memoizedState,a=s.element,Nw(e,t),Wf(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Mo(Error(ce(423)),t),t=jv(e,t,n,r,a);break e}else if(n!==a){a=Mo(Error(ce(424)),t),t=jv(e,t,n,r,a);break e}else for(pn=ks(t.stateNode.containerInfo.firstChild),mn=t,At=!0,Gn=null,r=Cw(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Po(),n===a){t=za(e,t,r);break e}Hr(e,t,n,r)}t=t.child}return t;case 5:return Iw(t),e===null&&Zp(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Kp(n,a)?i=null:s!==null&&Kp(n,s)&&(t.flags|=32),t4(e,t),Hr(e,t,i,r),t.child;case 6:return e===null&&Zp(t),null;case 13:return n4(e,t,r);case 4:return x0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Lo(t,null,n,r):Hr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),Fv(e,t,n,a,r);case 7:return Hr(e,t,t.pendingProps,r),t.child;case 8:return Hr(e,t,t.pendingProps.children,r),t.child;case 12:return Hr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,bt(Vf,n._currentValue),n._currentValue=i,s!==null)if(Zn(s.value,i)){if(s.children===a.children&&!rn.current){t=za(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Oa(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),e1(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ce(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),e1(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Hr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,To(t,r),a=Un(a),n=n(a),t.flags|=1,Hr(e,t,n,r),t.child;case 14:return n=t.type,a=Hn(n,t.pendingProps),a=Hn(n.type,a),Mv(e,t,n,a,r);case 15:return Zw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Hn(n,a),bf(e,t),t.tag=1,nn(n)?(e=!0,Uf(t)):e=!1,To(t,r),Yw(t,n,a),r1(t,n,a,r),s1(null,t,n,!0,e,r);case 19:return a4(e,t,r);case 22:return e4(e,t,r)}throw Error(ce(156,t.tag))};function k4(e,t){return qy(e,t)}function c5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(e,t,r,n){return new c5(e,t,r,n)}function z0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function u5(e){if(typeof e=="function")return z0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===s0)return 11;if(e===i0)return 14}return 2}function xs(e,t){var r=e.alternate;return r===null?(r=Pn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function kf(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")z0(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case ao:return fi(r.children,a,s,t);case a0:i=8,a|=8;break;case _p:return e=Pn(12,r,t,a|2),e.elementType=_p,e.lanes=s,e;case Cp:return e=Pn(13,r,t,a),e.elementType=Cp,e.lanes=s,e;case Ap:return e=Pn(19,r,t,a),e.elementType=Ap,e.lanes=s,e;case Iy:return Uh(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ay:i=10;break e;case Ny:i=9;break e;case s0:i=11;break e;case i0:i=14;break e;case os:i=16,n=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=Pn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function fi(e,t,r,n){return e=Pn(7,e,n,t),e.lanes=r,e}function Uh(e,t,r,n){return e=Pn(22,e,n,t),e.elementType=Iy,e.lanes=r,e.stateNode={isHidden:!1},e}function Qd(e,t,r){return e=Pn(6,e,null,t),e.lanes=r,e}function Jd(e,t,r){return t=Pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function f5(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dd(0),this.expirationTimes=Dd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dd(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function V0(e,t,r,n,a,s,i,o,l){return e=new f5(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Pn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},S0(s),e}function h5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function T4(e){if(!e)return Ds;e=e._reactInternals;e:{if(Ri(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(nn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var r=e.type;if(nn(r))return kw(e,r,t)}return t}function E4(e,t,r,n,a,s,i,o,l){return e=V0(r,n,!0,e,a,s,i,o,l),e.context=T4(null),r=e.current,n=qr(),a=Ss(r),s=Oa(n,a),s.callback=t??null,Ts(r,s,a),e.current.lanes=a,Jc(e,a,n),an(e,n),e}function jh(e,t,r,n){var a=t.current,s=qr(),i=Ss(a);return r=T4(r),t.context===null?t.context=r:t.pendingContext=r,t=Oa(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ts(a,t,i),e!==null&&(Yn(e,a,i,s),mf(e,a,i)),i}function Qf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Xv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function B0(e,t){Xv(e,t),(e=e.alternate)&&Xv(e,t)}function d5(){return null}var S4=typeof reportError=="function"?reportError:function(e){console.error(e)};function W0(e){this._internalRoot=e}zh.prototype.render=W0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));jh(e,t,null,null)};zh.prototype.unmount=W0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;wi(function(){jh(null,e,null,null)}),t[Ua]=null}};function zh(e){this._internalRoot=e}zh.prototype.unstable_scheduleHydration=function(e){if(e){var t=ew();e={blockedOn:null,target:e,priority:t};for(var r=0;r<cs.length&&t!==0&&t<cs[r].priority;r++);cs.splice(r,0,e),r===0&&rw(e)}};function H0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Yv(){}function p5(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Qf(i);s.call(c)}}var i=E4(t,n,e,0,null,!1,!1,"",Yv);return e._reactRootContainer=i,e[Ua]=i.current,gc(e.nodeType===8?e.parentNode:e),wi(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Qf(l);o.call(c)}}var l=V0(e,0,!1,null,null,!1,!1,"",Yv);return e._reactRootContainer=l,e[Ua]=l.current,gc(e.nodeType===8?e.parentNode:e),wi(function(){jh(t,l,r,n)}),l}function Bh(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Qf(i);o.call(l)}}jh(t,i,e,a)}else i=p5(r,t,e,a,n);return Qf(i)}Jy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Rl(t.pendingLanes);r!==0&&(c0(t,r|1),an(t,$t()),!(rt&6)&&(Uo=$t()+500,$s()))}break;case 13:wi(function(){var n=ja(e,1);if(n!==null){var a=qr();Yn(n,e,1,a)}}),B0(e,1)}};u0=function(e){if(e.tag===13){var t=ja(e,134217728);if(t!==null){var r=qr();Yn(t,e,134217728,r)}B0(e,134217728)}};Zy=function(e){if(e.tag===13){var t=Ss(e),r=ja(e,t);if(r!==null){var n=qr();Yn(r,e,t,n)}B0(e,t)}};ew=function(){return ht};tw=function(e,t){var r=ht;try{return ht=e,t()}finally{ht=r}};Up=function(e,t,r){switch(t){case"input":if(Rp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Dh(n);if(!a)throw Error(ce(90));Dy(n),Rp(n,a)}}}break;case"textarea":Py(e,r);break;case"select":t=r.value,t!=null&&bo(e,!!r.multiple,t,!1)}};Vy=M0;By=wi;var m5={usingClientEntryPoint:!1,Events:[eu,lo,Dh,jy,zy,M0]},Cl={findFiberByHostInstance:ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},g5={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ha.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$y(e),e===null?null:e.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||d5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{Ah=Hu.inject(g5),ha=Hu}catch{}}wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m5;wn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!H0(t))throw Error(ce(200));return h5(e,t,null,r)};wn.createRoot=function(e,t){if(!H0(e))throw Error(ce(299));var r=!1,n="",a=S4;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=V0(e,1,!1,null,null,r,!1,n,a),e[Ua]=t.current,gc(e.nodeType===8?e.parentNode:e),new W0(t)};wn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=$y(t),e=e===null?null:e.stateNode,e};wn.flushSync=function(e){return wi(e)};wn.hydrate=function(e,t,r){if(!Vh(t))throw Error(ce(200));return Bh(null,e,t,!0,r)};wn.hydrateRoot=function(e,t,r){if(!H0(e))throw Error(ce(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=S4;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=E4(t,null,e,1,r??null,a,!1,s,i),e[Ua]=t.current,gc(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new zh(t)};wn.render=function(e,t,r){if(!Vh(t))throw Error(ce(200));return Bh(null,e,t,!1,r)};wn.unmountComponentAtNode=function(e){if(!Vh(e))throw Error(ce(40));return e._reactRootContainer?(wi(function(){Bh(null,null,e,!1,function(){e._reactRootContainer=null,e[Ua]=null})}),!0):!1};wn.unstable_batchedUpdates=M0;wn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Vh(r))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return Bh(e,t,r,!1,n)};wn.version="18.3.1-next-f1338f8080-20240426";function x4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x4)}catch(e){console.error(e)}}x4(),Sy.exports=wn;var v5=Sy.exports,Qv=v5;Sp.createRoot=Qv.createRoot,Sp.hydrateRoot=Qv.hydrateRoot;const b5=()=>{};var Jv={};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const _4=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let a=e.charCodeAt(n);a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=a&63|128):(a&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=a&63|128):(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=a&63|128)}return t},y5=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const a=e[r++];if(a<128)t[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=e[r++];t[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=e[r++],i=e[r++],o=e[r++],l=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],i=e[r++];t[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63)}}return t.join("")},C4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<e.length;a+=3){const s=e[a],i=a+1<e.length,o=i?e[a+1]:0,l=a+2<e.length,c=l?e[a+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(d=64)),n.push(r[f],r[h],r[d],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(_4(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):y5(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<e.length;){const s=r[e.charAt(a++)],i=a<e.length?r[e.charAt(a)]:0;++a;const o=a<e.length?r[e.charAt(a)]:64;++a;const l=a<e.length?r[e.charAt(a)]:64;if(++a,s==null||i==null||o==null||l==null)throw new w5;const c=s<<2|i>>4;if(n.push(c),o!==64){const f=i<<4&240|o>>2;if(n.push(f),l!==64){const h=o<<6&192|l;n.push(h)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class w5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const k5=function(e){const t=_4(e);return C4.encodeByteArray(t,!0)},Jf=function(e){return k5(e).replace(/\./g,"")},T5=function(e){try{return C4.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function E5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const S5=()=>E5().__FIREBASE_DEFAULTS__,x5=()=>{if(typeof process>"u"||typeof Jv>"u")return;const e=Jv.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},_5=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&T5(e[1]);return t&&JSON.parse(t)},$0=()=>{try{return b5()||S5()||x5()||_5()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},C5=e=>{var t,r;return(r=(t=$0())==null?void 0:t.emulatorHosts)==null?void 0:r[e]},A5=e=>{const t=C5(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},A4=()=>{var e;return(e=$0())==null?void 0:e.config};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class N5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function G0(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function I5(e){return(await fetch(e,{credentials:"include"})).ok}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function R5(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",a=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[Jf(JSON.stringify(r)),Jf(JSON.stringify(i)),""].join(".")}const Xl={};function D5(){const e={prod:[],emulator:[]};for(const t of Object.keys(Xl))Xl[t]?e.emulator.push(t):e.prod.push(t);return e}function O5(e){let t=document.getElementById(e),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),r=!0),{created:r,element:t}}let Zv=!1;function P5(e,t){if(typeof window>"u"||typeof document>"u"||!G0(window.location.host)||Xl[e]===t||Xl[e]||Zv)return;Xl[e]=t;function r(h){return`__firebase__banner__${h}`}const n="__firebase__banner",a=D5().prod.length>0;function s(){const h=document.getElementById(n);h&&h.remove()}function i(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function o(h,d){h.setAttribute("width","24"),h.setAttribute("id",d),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function l(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{Zv=!0,s()},h}function c(h,d){h.setAttribute("id",d),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=O5(n),d=r("text"),p=document.getElementById(d)||document.createElement("span"),g=r("learnmore"),m=document.getElementById(g)||document.createElement("a"),y=r("preprendIcon"),k=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const b=h.element;i(b),c(m,g);const w=l();o(k,y),b.append(k,p,m,w),document.body.appendChild(b)}a?(p.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",d)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function L5(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function F5(){var e;const t=(e=$0())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function M5(){return!F5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U5(){try{return typeof indexedDB=="object"}catch{return!1}}function j5(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;t(((s=a.error)==null?void 0:s.message)||"")}}catch(r){t(r)}})}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const z5="FirebaseError";class Jo extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=z5,Object.setPrototypeOf(this,Jo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N4.prototype.create)}}class N4{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},a=`${this.service}/${t}`,s=this.errors[t],i=s?V5(s,n):"Error",o=`${this.serviceName}: ${i} (${a}).`;return new Jo(a,o,n)}}function V5(e,t){return e.replace(B5,(r,n)=>{const a=t[n];return a!=null?String(a):`<${n}?>`})}const B5=/\{\$([^}]+)}/g;function Zf(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const a of r){if(!n.includes(a))return!1;const s=e[a],i=t[a];if(e2(s)&&e2(i)){if(!Zf(s,i))return!1}else if(s!==i)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function e2(e){return e!==null&&typeof e=="object"}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function xc(e){return e&&e._delegate?e._delegate:e}class _c{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ai="[DEFAULT]";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class W5{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new N5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),n=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if($5(t))try{this.getOrInitializeService({instanceIdentifier:ai})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(t=ai){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ai){return this.instances.has(t)}getOptions(t=ai){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&i.resolve(a)}return a}onInit(t,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(t),this.onInitCallbacks.set(n,a);const s=this.instances.get(n);return s&&t(s,n),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:H5(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=ai){return this.component?this.component.multipleInstances?t:ai:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function H5(e){return e===ai?void 0:e}function $5(e){return e.instantiationMode==="EAGER"}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class G5{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new W5(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var et;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(et||(et={}));const q5={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},K5=et.INFO,X5={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},Y5=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),a=X5[t];if(a)console[a](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class I4{constructor(t){this.name=t,this._logLevel=K5,this._logHandler=Y5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in et))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?q5[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...t),this._logHandler(this,et.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...t),this._logHandler(this,et.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,et.INFO,...t),this._logHandler(this,et.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,et.WARN,...t),this._logHandler(this,et.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...t),this._logHandler(this,et.ERROR,...t)}}const Q5=(e,t)=>t.some(r=>e instanceof r);let t2,r2;function J5(){return t2||(t2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Z5(){return r2||(r2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const R4=new WeakMap,g1=new WeakMap,D4=new WeakMap,Zd=new WeakMap,q0=new WeakMap;function ex(e){const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{r(_s(e.result)),a()},i=()=>{n(e.error),a()};e.addEventListener("success",s),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&R4.set(r,e)}).catch(()=>{}),q0.set(t,e),t}function tx(e){if(g1.has(e))return;const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{r(),a()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});g1.set(e,t)}let v1={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return g1.get(e);if(t==="objectStoreNames")return e.objectStoreNames||D4.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return _s(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function rx(e){v1=e(v1)}function nx(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(ep(this),t,...r);return D4.set(n,t.sort?t.sort():[t]),_s(n)}:Z5().includes(e)?function(...t){return e.apply(ep(this),t),_s(R4.get(this))}:function(...t){return _s(e.apply(ep(this),t))}}function ax(e){return typeof e=="function"?nx(e):(e instanceof IDBTransaction&&tx(e),Q5(e,J5())?new Proxy(e,v1):e)}function _s(e){if(e instanceof IDBRequest)return ex(e);if(Zd.has(e))return Zd.get(e);const t=ax(e);return t!==e&&(Zd.set(e,t),q0.set(t,e)),t}const ep=e=>q0.get(e);function sx(e,t,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const i=indexedDB.open(e,t),o=_s(i);return n&&i.addEventListener("upgradeneeded",l=>{n(_s(i.result),l.oldVersion,l.newVersion,_s(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),a&&l.addEventListener("versionchange",c=>a(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const ix=["get","getKey","getAll","getAllKeys","count"],ox=["put","add","delete","clear"],tp=new Map;function n2(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(tp.get(t))return tp.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=ox.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||ix.includes(r)))return;const s=async function(i,...o){const l=this.transaction(i,a?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),a&&l.done]))[0]};return tp.set(t,s),s}rx(e=>({...e,get:(t,r,n)=>n2(t,r)||e.get(t,r,n),has:(t,r)=>!!n2(t,r)||e.has(t,r)}));/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class lx{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cx(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function cx(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const b1="@firebase/app",a2="0.14.6";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Va=new I4("@firebase/app"),ux="@firebase/app-compat",fx="@firebase/analytics-compat",hx="@firebase/analytics",dx="@firebase/app-check-compat",px="@firebase/app-check",mx="@firebase/auth",gx="@firebase/auth-compat",vx="@firebase/database",bx="@firebase/data-connect",yx="@firebase/database-compat",wx="@firebase/functions",kx="@firebase/functions-compat",Tx="@firebase/installations",Ex="@firebase/installations-compat",Sx="@firebase/messaging",xx="@firebase/messaging-compat",_x="@firebase/performance",Cx="@firebase/performance-compat",Ax="@firebase/remote-config",Nx="@firebase/remote-config-compat",Ix="@firebase/storage",Rx="@firebase/storage-compat",Dx="@firebase/firestore",Ox="@firebase/ai",Px="@firebase/firestore-compat",Lx="firebase",Fx="12.6.0";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const y1="[DEFAULT]",Mx={[b1]:"fire-core",[ux]:"fire-core-compat",[hx]:"fire-analytics",[fx]:"fire-analytics-compat",[px]:"fire-app-check",[dx]:"fire-app-check-compat",[mx]:"fire-auth",[gx]:"fire-auth-compat",[vx]:"fire-rtdb",[bx]:"fire-data-connect",[yx]:"fire-rtdb-compat",[wx]:"fire-fn",[kx]:"fire-fn-compat",[Tx]:"fire-iid",[Ex]:"fire-iid-compat",[Sx]:"fire-fcm",[xx]:"fire-fcm-compat",[_x]:"fire-perf",[Cx]:"fire-perf-compat",[Ax]:"fire-rc",[Nx]:"fire-rc-compat",[Ix]:"fire-gcs",[Rx]:"fire-gcs-compat",[Dx]:"fire-fst",[Px]:"fire-fst-compat",[Ox]:"fire-vertex","fire-js":"fire-js",[Lx]:"fire-js-all"};/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const eh=new Map,Ux=new Map,w1=new Map;function s2(e,t){try{e.container.addComponent(t)}catch(r){Va.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function th(e){const t=e.name;if(w1.has(t))return Va.debug(`There were multiple attempts to register component ${t}.`),!1;w1.set(t,e);for(const r of eh.values())s2(r,e);for(const r of Ux.values())s2(r,e);return!0}function jx(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function zx(e){return e==null?!1:e.settings!==void 0}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Vx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Cs=new N4("app","Firebase",Vx);/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Bx{constructor(t,r,n){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _c("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Cs.create("app-deleted",{appName:this._name})}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Wx=Fx;function O4(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n={name:y1,automaticDataCollectionEnabled:!0,...t},a=n.name;if(typeof a!="string"||!a)throw Cs.create("bad-app-name",{appName:String(a)});if(r||(r=A4()),!r)throw Cs.create("no-options");const s=eh.get(a);if(s){if(Zf(r,s.options)&&Zf(n,s.config))return s;throw Cs.create("duplicate-app",{appName:a})}const i=new G5(a);for(const l of w1.values())i.addComponent(l);const o=new Bx(r,n,i);return eh.set(a,o),o}function Hx(e=y1){const t=eh.get(e);if(!t&&e===y1&&A4())return O4();if(!t)throw Cs.create("no-app",{appName:e});return t}function So(e,t,r){let n=Mx[e]??e;r&&(n+=`-${r}`);const a=n.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const i=[`Unable to register library "${n}" with version "${t}":`];a&&i.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&s&&i.push("and"),s&&i.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Va.warn(i.join(" "));return}th(new _c(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const $x="firebase-heartbeat-database",Gx=1,Cc="firebase-heartbeat-store";let rp=null;function P4(){return rp||(rp=sx($x,Gx,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Cc)}catch(r){console.warn(r)}}}}).catch(e=>{throw Cs.create("idb-open",{originalErrorMessage:e.message})})),rp}async function qx(e){try{const t=(await P4()).transaction(Cc),r=await t.objectStore(Cc).get(L4(e));return await t.done,r}catch(t){if(t instanceof Jo)Va.warn(t.message);else{const r=Cs.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Va.warn(r.message)}}}async function i2(e,t){try{const r=(await P4()).transaction(Cc,"readwrite");await r.objectStore(Cc).put(t,L4(e)),await r.done}catch(r){if(r instanceof Jo)Va.warn(r.message);else{const n=Cs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Va.warn(n.message)}}}function L4(e){return`${e.name}!${e.options.appId}`}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Kx=1024,Xx=30;class Yx{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Jx(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=o2();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(s=>s.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:n}),this._heartbeatsCache.heartbeats.length>Xx){const s=Zx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Va.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=o2(),{heartbeatsToSend:n,unsentEntries:a}=Qx(this._heartbeatsCache.heartbeats),s=Jf(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Va.warn(r),""}}}function o2(){return new Date().toISOString().substring(0,10)}function Qx(e,t=Kx){const r=[];let n=e.slice();for(const a of e){const s=r.find(i=>i.agent===a.agent);if(s){if(s.dates.push(a.date),l2(r)>t){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),l2(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Jx{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U5()?j5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await qx(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return i2(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return i2(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function l2(e){return Jf(JSON.stringify({version:2,heartbeats:e})).length}function Zx(e){if(e.length===0)return-1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function e_(e){th(new _c("platform-logger",t=>new lx(t),"PRIVATE")),th(new _c("heartbeat",t=>new Yx(t),"PRIVATE")),So(b1,a2,e),So(b1,a2,"esm2020"),So("fire-js","")}e_("");var t_="firebase",r_="12.7.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/So(t_,r_,"app");var c2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var As,F4;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(T,S){function x(){}x.prototype=S.prototype,T.F=S.prototype,T.prototype=new x,T.prototype.constructor=T,T.D=function(I,A,R){for(var D=Array(arguments.length-2),de=2;de<arguments.length;de++)D[de-2]=arguments[de];return S.prototype[A].apply(I,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(T,S,x){x||(x=0);const I=Array(16);if(typeof S=="string")for(var A=0;A<16;++A)I[A]=S.charCodeAt(x++)|S.charCodeAt(x++)<<8|S.charCodeAt(x++)<<16|S.charCodeAt(x++)<<24;else for(A=0;A<16;++A)I[A]=S[x++]|S[x++]<<8|S[x++]<<16|S[x++]<<24;S=T.g[0],x=T.g[1],A=T.g[2];let R=T.g[3],D;D=S+(R^x&(A^R))+I[0]+3614090360&4294967295,S=x+(D<<7&4294967295|D>>>25),D=R+(A^S&(x^A))+I[1]+3905402710&4294967295,R=S+(D<<12&4294967295|D>>>20),D=A+(x^R&(S^x))+I[2]+606105819&4294967295,A=R+(D<<17&4294967295|D>>>15),D=x+(S^A&(R^S))+I[3]+3250441966&4294967295,x=A+(D<<22&4294967295|D>>>10),D=S+(R^x&(A^R))+I[4]+4118548399&4294967295,S=x+(D<<7&4294967295|D>>>25),D=R+(A^S&(x^A))+I[5]+1200080426&4294967295,R=S+(D<<12&4294967295|D>>>20),D=A+(x^R&(S^x))+I[6]+2821735955&4294967295,A=R+(D<<17&4294967295|D>>>15),D=x+(S^A&(R^S))+I[7]+4249261313&4294967295,x=A+(D<<22&4294967295|D>>>10),D=S+(R^x&(A^R))+I[8]+1770035416&4294967295,S=x+(D<<7&4294967295|D>>>25),D=R+(A^S&(x^A))+I[9]+2336552879&4294967295,R=S+(D<<12&4294967295|D>>>20),D=A+(x^R&(S^x))+I[10]+4294925233&4294967295,A=R+(D<<17&4294967295|D>>>15),D=x+(S^A&(R^S))+I[11]+2304563134&4294967295,x=A+(D<<22&4294967295|D>>>10),D=S+(R^x&(A^R))+I[12]+1804603682&4294967295,S=x+(D<<7&4294967295|D>>>25),D=R+(A^S&(x^A))+I[13]+4254626195&4294967295,R=S+(D<<12&4294967295|D>>>20),D=A+(x^R&(S^x))+I[14]+2792965006&4294967295,A=R+(D<<17&4294967295|D>>>15),D=x+(S^A&(R^S))+I[15]+1236535329&4294967295,x=A+(D<<22&4294967295|D>>>10),D=S+(A^R&(x^A))+I[1]+4129170786&4294967295,S=x+(D<<5&4294967295|D>>>27),D=R+(x^A&(S^x))+I[6]+3225465664&4294967295,R=S+(D<<9&4294967295|D>>>23),D=A+(S^x&(R^S))+I[11]+643717713&4294967295,A=R+(D<<14&4294967295|D>>>18),D=x+(R^S&(A^R))+I[0]+3921069994&4294967295,x=A+(D<<20&4294967295|D>>>12),D=S+(A^R&(x^A))+I[5]+3593408605&4294967295,S=x+(D<<5&4294967295|D>>>27),D=R+(x^A&(S^x))+I[10]+38016083&4294967295,R=S+(D<<9&4294967295|D>>>23),D=A+(S^x&(R^S))+I[15]+3634488961&4294967295,A=R+(D<<14&4294967295|D>>>18),D=x+(R^S&(A^R))+I[4]+3889429448&4294967295,x=A+(D<<20&4294967295|D>>>12),D=S+(A^R&(x^A))+I[9]+568446438&4294967295,S=x+(D<<5&4294967295|D>>>27),D=R+(x^A&(S^x))+I[14]+3275163606&4294967295,R=S+(D<<9&4294967295|D>>>23),D=A+(S^x&(R^S))+I[3]+4107603335&4294967295,A=R+(D<<14&4294967295|D>>>18),D=x+(R^S&(A^R))+I[8]+1163531501&4294967295,x=A+(D<<20&4294967295|D>>>12),D=S+(A^R&(x^A))+I[13]+2850285829&4294967295,S=x+(D<<5&4294967295|D>>>27),D=R+(x^A&(S^x))+I[2]+4243563512&4294967295,R=S+(D<<9&4294967295|D>>>23),D=A+(S^x&(R^S))+I[7]+1735328473&4294967295,A=R+(D<<14&4294967295|D>>>18),D=x+(R^S&(A^R))+I[12]+2368359562&4294967295,x=A+(D<<20&4294967295|D>>>12),D=S+(x^A^R)+I[5]+4294588738&4294967295,S=x+(D<<4&4294967295|D>>>28),D=R+(S^x^A)+I[8]+2272392833&4294967295,R=S+(D<<11&4294967295|D>>>21),D=A+(R^S^x)+I[11]+1839030562&4294967295,A=R+(D<<16&4294967295|D>>>16),D=x+(A^R^S)+I[14]+4259657740&4294967295,x=A+(D<<23&4294967295|D>>>9),D=S+(x^A^R)+I[1]+2763975236&4294967295,S=x+(D<<4&4294967295|D>>>28),D=R+(S^x^A)+I[4]+1272893353&4294967295,R=S+(D<<11&4294967295|D>>>21),D=A+(R^S^x)+I[7]+4139469664&4294967295,A=R+(D<<16&4294967295|D>>>16),D=x+(A^R^S)+I[10]+3200236656&4294967295,x=A+(D<<23&4294967295|D>>>9),D=S+(x^A^R)+I[13]+681279174&4294967295,S=x+(D<<4&4294967295|D>>>28),D=R+(S^x^A)+I[0]+3936430074&4294967295,R=S+(D<<11&4294967295|D>>>21),D=A+(R^S^x)+I[3]+3572445317&4294967295,A=R+(D<<16&4294967295|D>>>16),D=x+(A^R^S)+I[6]+76029189&4294967295,x=A+(D<<23&4294967295|D>>>9),D=S+(x^A^R)+I[9]+3654602809&4294967295,S=x+(D<<4&4294967295|D>>>28),D=R+(S^x^A)+I[12]+3873151461&4294967295,R=S+(D<<11&4294967295|D>>>21),D=A+(R^S^x)+I[15]+530742520&4294967295,A=R+(D<<16&4294967295|D>>>16),D=x+(A^R^S)+I[2]+3299628645&4294967295,x=A+(D<<23&4294967295|D>>>9),D=S+(A^(x|~R))+I[0]+4096336452&4294967295,S=x+(D<<6&4294967295|D>>>26),D=R+(x^(S|~A))+I[7]+1126891415&4294967295,R=S+(D<<10&4294967295|D>>>22),D=A+(S^(R|~x))+I[14]+2878612391&4294967295,A=R+(D<<15&4294967295|D>>>17),D=x+(R^(A|~S))+I[5]+4237533241&4294967295,x=A+(D<<21&4294967295|D>>>11),D=S+(A^(x|~R))+I[12]+1700485571&4294967295,S=x+(D<<6&4294967295|D>>>26),D=R+(x^(S|~A))+I[3]+2399980690&4294967295,R=S+(D<<10&4294967295|D>>>22),D=A+(S^(R|~x))+I[10]+4293915773&4294967295,A=R+(D<<15&4294967295|D>>>17),D=x+(R^(A|~S))+I[1]+2240044497&4294967295,x=A+(D<<21&4294967295|D>>>11),D=S+(A^(x|~R))+I[8]+1873313359&4294967295,S=x+(D<<6&4294967295|D>>>26),D=R+(x^(S|~A))+I[15]+4264355552&4294967295,R=S+(D<<10&4294967295|D>>>22),D=A+(S^(R|~x))+I[6]+2734768916&4294967295,A=R+(D<<15&4294967295|D>>>17),D=x+(R^(A|~S))+I[13]+1309151649&4294967295,x=A+(D<<21&4294967295|D>>>11),D=S+(A^(x|~R))+I[4]+4149444226&4294967295,S=x+(D<<6&4294967295|D>>>26),D=R+(x^(S|~A))+I[11]+3174756917&4294967295,R=S+(D<<10&4294967295|D>>>22),D=A+(S^(R|~x))+I[2]+718787259&4294967295,A=R+(D<<15&4294967295|D>>>17),D=x+(R^(A|~S))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(A+(D<<21&4294967295|D>>>11))&4294967295,T.g[2]=T.g[2]+A&4294967295,T.g[3]=T.g[3]+R&4294967295}n.prototype.v=function(T,S){S===void 0&&(S=T.length);const x=S-this.blockSize,I=this.C;let A=this.h,R=0;for(;R<S;){if(A==0)for(;R<=x;)a(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<S;)if(I[A++]=T.charCodeAt(R++),A==this.blockSize){a(this,I),A=0;break}}else for(;R<S;)if(I[A++]=T[R++],A==this.blockSize){a(this,I),A=0;break}}this.h=A,this.o+=S},n.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;S=this.o*8;for(var x=T.length-8;x<T.length;++x)T[x]=S&255,S/=256;for(this.v(T),T=Array(16),S=0,x=0;x<4;++x)for(let I=0;I<32;I+=8)T[S++]=this.g[x]>>>I&255;return T};function s(T,S){var x=o;return Object.prototype.hasOwnProperty.call(x,T)?x[T]:x[T]=S(T)}function i(T,S){this.h=S;const x=[];let I=!0;for(let A=T.length-1;A>=0;A--){const R=T[A]|0;I&&R==S||(x[A]=R,I=!1)}this.g=x}var o={};function l(T){return-128<=T&&T<128?s(T,function(S){return new i([S|0],S<0?-1:0)}):new i([T|0],T<0?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return h;if(T<0)return y(c(-T));const S=[];let x=1;for(let I=0;T>=x;I++)S[I]=T/x|0,x*=4294967296;return new i(S,0)}function f(T,S){if(T.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(T.charAt(0)=="-")return y(f(T.substring(1),S));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const x=c(Math.pow(S,8));let I=h;for(let R=0;R<T.length;R+=8){var A=Math.min(8,T.length-R);const D=parseInt(T.substring(R,R+A),S);A<8?(A=c(Math.pow(S,A)),I=I.j(A).add(c(D))):(I=I.j(x),I=I.add(c(D)))}return I}var h=l(0),d=l(1),p=l(16777216);e=i.prototype,e.m=function(){if(m(this))return-y(this).m();let T=0,S=1;for(let x=0;x<this.g.length;x++){const I=this.i(x);T+=(I>=0?I:4294967296+I)*S,S*=4294967296}return T},e.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(g(this))return"0";if(m(this))return"-"+y(this).toString(T);const S=c(Math.pow(T,6));var x=this;let I="";for(;;){const A=N(x,S).g;x=k(x,A.j(S));let R=((x.g.length>0?x.g[0]:x.h)>>>0).toString(T);if(x=A,g(x))return R+I;for(;R.length<6;)R="0"+R;I=R+I}},e.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function g(T){if(T.h!=0)return!1;for(let S=0;S<T.g.length;S++)if(T.g[S]!=0)return!1;return!0}function m(T){return T.h==-1}e.l=function(T){return T=k(this,T),m(T)?-1:g(T)?0:1};function y(T){const S=T.g.length,x=[];for(let I=0;I<S;I++)x[I]=~T.g[I];return new i(x,~T.h).add(d)}e.abs=function(){return m(this)?y(this):this},e.add=function(T){const S=Math.max(this.g.length,T.g.length),x=[];let I=0;for(let A=0;A<=S;A++){let R=I+(this.i(A)&65535)+(T.i(A)&65535),D=(R>>>16)+(this.i(A)>>>16)+(T.i(A)>>>16);I=D>>>16,R&=65535,D&=65535,x[A]=D<<16|R}return new i(x,x[x.length-1]&-2147483648?-1:0)};function k(T,S){return T.add(y(S))}e.j=function(T){if(g(this)||g(T))return h;if(m(this))return m(T)?y(this).j(y(T)):y(y(this).j(T));if(m(T))return y(this.j(y(T)));if(this.l(p)<0&&T.l(p)<0)return c(this.m()*T.m());const S=this.g.length+T.g.length,x=[];for(var I=0;I<2*S;I++)x[I]=0;for(I=0;I<this.g.length;I++)for(let A=0;A<T.g.length;A++){const R=this.i(I)>>>16,D=this.i(I)&65535,de=T.i(A)>>>16,ue=T.i(A)&65535;x[2*I+2*A]+=D*ue,b(x,2*I+2*A),x[2*I+2*A+1]+=R*ue,b(x,2*I+2*A+1),x[2*I+2*A+1]+=D*de,b(x,2*I+2*A+1),x[2*I+2*A+2]+=R*de,b(x,2*I+2*A+2)}for(T=0;T<S;T++)x[T]=x[2*T+1]<<16|x[2*T];for(T=S;T<2*S;T++)x[T]=0;return new i(x,0)};function b(T,S){for(;(T[S]&65535)!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function w(T,S){this.g=T,this.h=S}function N(T,S){if(g(S))throw Error("division by zero");if(g(T))return new w(h,h);if(m(T))return S=N(y(T),S),new w(y(S.g),y(S.h));if(m(S))return S=N(T,y(S)),new w(y(S.g),S.h);if(T.g.length>30){if(m(T)||m(S))throw Error("slowDivide_ only works with positive integers.");for(var x=d,I=S;I.l(T)<=0;)x=_(x),I=_(I);var A=F(x,1),R=F(I,1);for(I=F(I,2),x=F(x,2);!g(I);){var D=R.add(I);D.l(T)<=0&&(A=A.add(x),R=D),I=F(I,1),x=F(x,1)}return S=k(T,A.j(S)),new w(A,S)}for(A=h;T.l(S)>=0;){for(x=Math.max(1,Math.floor(T.m()/S.m())),I=Math.ceil(Math.log(x)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),R=c(x),D=R.j(S);m(D)||D.l(T)>0;)x-=I,R=c(x),D=R.j(S);g(R)&&(R=d),A=A.add(R),T=k(T,D)}return new w(A,T)}e.B=function(T){return N(this,T).h},e.and=function(T){const S=Math.max(this.g.length,T.g.length),x=[];for(let I=0;I<S;I++)x[I]=this.i(I)&T.i(I);return new i(x,this.h&T.h)},e.or=function(T){const S=Math.max(this.g.length,T.g.length),x=[];for(let I=0;I<S;I++)x[I]=this.i(I)|T.i(I);return new i(x,this.h|T.h)},e.xor=function(T){const S=Math.max(this.g.length,T.g.length),x=[];for(let I=0;I<S;I++)x[I]=this.i(I)^T.i(I);return new i(x,this.h^T.h)};function _(T){const S=T.g.length+1,x=[];for(let I=0;I<S;I++)x[I]=T.i(I)<<1|T.i(I-1)>>>31;return new i(x,T.h)}function F(T,S){const x=S>>5;S%=32;const I=T.g.length-x,A=[];for(let R=0;R<I;R++)A[R]=S>0?T.i(R+x)>>>S|T.i(R+x+1)<<32-S:T.i(R+x);return new i(A,T.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,F4=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=f,As=i}).apply(typeof c2<"u"?c2:typeof self<"u"?self:typeof window<"u"?window:{});var $u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var M4,Ol,U4,Tf,k1,j4,z4,V4;(function(){var e,t=Object.defineProperty;function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof $u=="object"&&$u];for(var v=0;v<u.length;++v){var E=u[v];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var n=r(this);function a(u,v){if(v)e:{var E=n;u=u.split(".");for(var P=0;P<u.length-1;P++){var X=u[P];if(!(X in E))break e;E=E[X]}u=u[u.length-1],P=E[u],v=v(P),v!=P&&v!=null&&t(E,u,{configurable:!0,writable:!0,value:v})}}a("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(u){return u||function(v){var E=[],P;for(P in v)Object.prototype.hasOwnProperty.call(v,P)&&E.push([P,v[P]]);return E}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},i=this||self;function o(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function l(u,v,E){return u.call.apply(u.bind,arguments)}function c(u,v,E){return c=l,c.apply(null,arguments)}function f(u,v){var E=Array.prototype.slice.call(arguments,1);return function(){var P=E.slice();return P.push.apply(P,arguments),u.apply(this,P)}}function h(u,v){function E(){}E.prototype=v.prototype,u.Z=v.prototype,u.prototype=new E,u.prototype.constructor=u,u.Ob=function(P,X,J){for(var Ee=Array(arguments.length-2),He=2;He<arguments.length;He++)Ee[He-2]=arguments[He];return v.prototype[X].apply(P,Ee)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function p(u){const v=u.length;if(v>0){const E=Array(v);for(let P=0;P<v;P++)E[P]=u[P];return E}return[]}function g(u,v){for(let P=1;P<arguments.length;P++){const X=arguments[P];var E=typeof X;if(E=E!="object"?E:X?Array.isArray(X)?"array":E:"null",E=="array"||E=="object"&&typeof X.length=="number"){E=u.length||0;const J=X.length||0;u.length=E+J;for(let Ee=0;Ee<J;Ee++)u[E+Ee]=X[Ee]}else u.push(X)}}class m{constructor(v,E){this.i=v,this.j=E,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function y(u){i.setTimeout(()=>{throw u},0)}function k(){var u=T;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class b{constructor(){this.h=this.g=null}add(v,E){const P=w.get();P.set(v,E),this.h?this.h.next=P:this.g=P,this.h=P}}var w=new m(()=>new N,u=>u.reset());class N{constructor(){this.next=this.g=this.h=null}set(v,E){this.h=v,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let _,F=!1,T=new b,S=()=>{const u=Promise.resolve(void 0);_=()=>{u.then(x)}};function x(){for(var u;u=k();){try{u.h.call(u.g)}catch(E){y(E)}var v=w;v.j(u),v.h<100&&(v.h++,u.next=v.g,v.g=u)}F=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const E=()=>{};i.addEventListener("test",E,v),i.removeEventListener("test",E,v)}catch{}return u}();function D(u){return/^[\s\xa0]*$/.test(u)}function de(u,v){A.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,v)}h(de,A),de.prototype.init=function(u,v){const E=this.type=u.type,P=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget,v||(E=="mouseover"?v=u.fromElement:E=="mouseout"&&(v=u.toElement)),this.relatedTarget=v,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),xe=0;function Se(u,v,E,P,X){this.listener=u,this.proxy=null,this.src=v,this.type=E,this.capture=!!P,this.ha=X,this.key=++xe,this.da=this.fa=!1}function q(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function te(u,v,E){for(const P in u)v.call(E,u[P],P,u)}function fe(u,v){for(const E in u)v.call(void 0,u[E],E,u)}function Ae(u){const v={};for(const E in u)v[E]=u[E];return v}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(u,v){let E,P;for(let X=1;X<arguments.length;X++){P=arguments[X];for(E in P)u[E]=P[E];for(let J=0;J<j.length;J++)E=j[J],Object.prototype.hasOwnProperty.call(P,E)&&(u[E]=P[E])}}function W(u){this.src=u,this.g={},this.h=0}W.prototype.add=function(u,v,E,P,X){const J=u.toString();u=this.g[J],u||(u=this.g[J]=[],this.h++);const Ee=ee(u,v,P,X);return Ee>-1?(v=u[Ee],E||(v.fa=!1)):(v=new Se(v,this.src,J,!!P,X),v.fa=E,u.push(v)),v};function H(u,v){const E=v.type;if(E in u.g){var P=u.g[E],X=Array.prototype.indexOf.call(P,v,void 0),J;(J=X>=0)&&Array.prototype.splice.call(P,X,1),J&&(q(v),u.g[E].length==0&&(delete u.g[E],u.h--))}}function ee(u,v,E,P){for(let X=0;X<u.length;++X){const J=u[X];if(!J.da&&J.listener==v&&J.capture==!!E&&J.ha==P)return X}return-1}var he="closure_lm_"+(Math.random()*1e6|0),ie={};function me(u,v,E,P,X){if(Array.isArray(v)){for(let J=0;J<v.length;J++)me(u,v[J],E,P,X);return null}return E=Lt(E),u&&u[ue]?u.J(v,E,o(P)?!!P.capture:!1,X):pe(u,v,E,!1,P,X)}function pe(u,v,E,P,X,J){if(!v)throw Error("Invalid event type");const Ee=o(X)?!!X.capture:!!X;let He=ze(u);if(He||(u[he]=He=new W(u)),E=He.add(v,E,P,Ee,J),E.proxy)return E;if(P=je(),E.proxy=P,P.src=u,P.listener=E,u.addEventListener)R||(X=Ee),X===void 0&&(X=!1),u.addEventListener(v.toString(),P,X);else if(u.attachEvent)u.attachEvent(Je(v.toString()),P);else if(u.addListener&&u.removeListener)u.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return E}function je(){function u(E){return v.call(u.src,u.listener,E)}const v=ot;return u}function V(u,v,E,P,X){if(Array.isArray(v))for(var J=0;J<v.length;J++)V(u,v[J],E,P,X);else P=o(P)?!!P.capture:!!P,E=Lt(E),u&&u[ue]?(u=u.i,J=String(v).toString(),J in u.g&&(v=u.g[J],E=ee(v,E,P,X),E>-1&&(q(v[E]),Array.prototype.splice.call(v,E,1),v.length==0&&(delete u.g[J],u.h--)))):u&&(u=ze(u))&&(v=u.g[v.toString()],u=-1,v&&(u=ee(v,E,P,X)),(E=u>-1?v[u]:null)&&it(E))}function it(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[ue])H(v.i,u);else{var E=u.type,P=u.proxy;v.removeEventListener?v.removeEventListener(E,P,u.capture):v.detachEvent?v.detachEvent(Je(E),P):v.addListener&&v.removeListener&&v.removeListener(P),(E=ze(v))?(H(E,u),E.h==0&&(E.src=null,v[he]=null)):q(u)}}}function Je(u){return u in ie?ie[u]:ie[u]="on"+u}function ot(u,v){if(u.da)u=!0;else{v=new de(v,this);const E=u.listener,P=u.ha||u.src;u.fa&&it(u),u=E.call(P,v)}return u}function ze(u){return u=u[he],u instanceof W?u:null}var we="__closure_events_fn_"+(Math.random()*1e9>>>0);function Lt(u){return typeof u=="function"?u:(u[we]||(u[we]=function(v){return u.handleEvent(v)}),u[we])}function dt(){I.call(this),this.i=new W(this),this.M=this,this.G=null}h(dt,I),dt.prototype[ue]=!0,dt.prototype.removeEventListener=function(u,v,E,P){V(this,u,v,E,P)};function st(u,v){var E,P=u.G;if(P)for(E=[];P;P=P.G)E.push(P);if(u=u.M,P=v.type||v,typeof v=="string")v=new A(v,u);else if(v instanceof A)v.target=v.target||u;else{var X=v;v=new A(P,u),G(v,X)}X=!0;let J,Ee;if(E)for(Ee=E.length-1;Ee>=0;Ee--)J=v.g=E[Ee],X=ea(J,P,!0,v)&&X;if(J=v.g=u,X=ea(J,P,!0,v)&&X,X=ea(J,P,!1,v)&&X,E)for(Ee=0;Ee<E.length;Ee++)J=v.g=E[Ee],X=ea(J,P,!1,v)&&X}dt.prototype.N=function(){if(dt.Z.N.call(this),this.i){var u=this.i;for(const v in u.g){const E=u.g[v];for(let P=0;P<E.length;P++)q(E[P]);delete u.g[v],u.h--}}this.G=null},dt.prototype.J=function(u,v,E,P){return this.i.add(String(u),v,!1,E,P)},dt.prototype.K=function(u,v,E,P){return this.i.add(String(u),v,!0,E,P)};function ea(u,v,E,P){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();let X=!0;for(let J=0;J<v.length;++J){const Ee=v[J];if(Ee&&!Ee.da&&Ee.capture==E){const He=Ee.listener,er=Ee.ha||Ee.src;Ee.fa&&H(u.i,Ee),X=He.call(er,P)!==!1&&X}}return X&&!P.defaultPrevented}function Ka(u,v){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=c(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:i.setTimeout(u,v||0)}function lr(u){u.g=Ka(()=>{u.g=null,u.i&&(u.i=!1,lr(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class Sa extends I{constructor(v,E){super(),this.m=v,this.l=E,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:lr(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qr(u){I.call(this),this.h=u,this.g={}}h(Qr,I);var Vn=[];function Tn(u){te(u.g,function(v,E){this.g.hasOwnProperty(E)&&it(v)},u),u.g={}}Qr.prototype.N=function(){Qr.Z.N.call(this),Tn(this)},Qr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var on=i.JSON.stringify,Ve=i.JSON.parse,mt=class{stringify(u){return i.JSON.stringify(u,void 0)}parse(u){return i.JSON.parse(u,void 0)}};function Wr(){}function Ft(){}var ln={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Wi(){A.call(this,"d")}h(Wi,A);function ol(){A.call(this,"c")}h(ol,A);var xa={},ll=null;function Ys(){return ll=ll||new dt}xa.Ia="serverreachability";function cl(u){A.call(this,xa.Ia,u)}h(cl,A);function Qs(u){const v=Ys();st(v,new cl(v))}xa.STAT_EVENT="statevent";function gu(u,v){A.call(this,xa.STAT_EVENT,u),this.stat=v}h(gu,A);function Zt(u){const v=Ys();st(v,new gu(v,u))}xa.Ja="timingevent";function vu(u,v){A.call(this,xa.Ja,u),this.size=v}h(vu,A);function Js(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){u()},v)}function Zs(){this.g=!0}Zs.prototype.ua=function(){this.g=!1};function gd(u,v,E,P,X,J){u.info(function(){if(u.g)if(J){var Ee="",He=J.split("&");for(let kt=0;kt<He.length;kt++){var er=He[kt].split("=");if(er.length>1){const cr=er[0];er=er[1];const na=cr.split("_");Ee=na.length>=2&&na[1]=="type"?Ee+(cr+"="+er+"&"):Ee+(cr+"=redacted&")}}}else Ee=null;else Ee=J;return"XMLHTTP REQ ("+P+") [attempt "+X+"]: "+v+`
`+E+`
`+Ee})}function vd(u,v,E,P,X,J,Ee){u.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+X+"]: "+v+`
`+E+`
`+J+" "+Ee})}function Xa(u,v,E,P){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+yd(u,E)+(P?" "+P:"")})}function bd(u,v){u.info(function(){return"TIMEOUT: "+v})}Zs.prototype.info=function(){};function yd(u,v){if(!u.g)return v;if(!v)return null;try{const J=JSON.parse(v);if(J){for(u=0;u<J.length;u++)if(Array.isArray(J[u])){var E=J[u];if(!(E.length<2)){var P=E[1];if(Array.isArray(P)&&!(P.length<1)){var X=P[0];if(X!="noop"&&X!="stop"&&X!="close")for(let Ee=1;Ee<P.length;Ee++)P[Ee]=""}}}}return on(J)}catch{return v}}var Ya={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},bu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},yu;function ul(){}h(ul,Wr),ul.prototype.g=function(){return new XMLHttpRequest},yu=new ul;function C(u){return encodeURIComponent(String(u))}function M(u){var v=1;u=u.split(":");const E=[];for(;v>0&&u.length;)E.push(u.shift()),v--;return u.length&&E.push(u.join(":")),E}function O(u,v,E,P){this.j=u,this.i=v,this.l=E,this.S=P||1,this.V=new Qr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new L}function L(){this.i=null,this.g="",this.h=!1}var U={},z={};function K(u,v,E){u.M=1,u.A=wu(ra(v)),u.u=E,u.R=!0,Q(u,null)}function Q(u,v){u.F=Date.now(),le(u),u.B=ra(u.A);var E=u.B,P=u.S;Array.isArray(P)||(P=[String(P)]),kg(E.i,"t",P),u.C=0,E=u.j.L,u.h=new L,u.g=jg(u.j,E?v:null,!u.u),u.P>0&&(u.O=new Sa(c(u.Y,u,u.g),u.P)),v=u.V,E=u.g,P=u.ba;var X="readystatechange";Array.isArray(X)||(X&&(Vn[0]=X.toString()),X=Vn);for(let J=0;J<X.length;J++){const Ee=me(E,X[J],P||v.handleEvent,!1,v.h||v);if(!Ee)break;v.g[Ee.key]=Ee}v=u.J?Ae(u.J):{},u.u?(u.v||(u.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,v)):(u.v="GET",u.g.ea(u.B,u.v,null,v)),Qs(),gd(u.i,u.v,u.B,u.l,u.S,u.u)}O.prototype.ba=function(u){u=u.target;const v=this.O;v&&es(u)==3?v.j():this.Y(u)},O.prototype.Y=function(u){try{if(u==this.g)e:{const He=es(this.g),er=this.g.ya(),kt=this.g.ca();if(!(He<3)&&(He!=3||this.g&&(this.h.h||this.g.la()||Ag(this.g)))){this.K||He!=4||er==7||(er==8||kt<=0?Qs(3):Qs(2)),ye(this);var v=this.g.ca();this.X=v;var E=Y(this);if(this.o=v==200,vd(this.i,this.v,this.B,this.l,this.S,He,v),this.o){if(this.U&&!this.L){t:{if(this.g){var P,X=this.g;if((P=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(P)){var J=P;break t}}J=null}if(u=J)Xa(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,We(this,u);else{this.o=!1,this.m=3,Zt(12),Te(this),ve(this);break e}}if(this.R){u=!0;let cr;for(;!this.K&&this.C<E.length;)if(cr=re(this,E),cr==z){He==4&&(this.m=4,Zt(14),u=!1),Xa(this.i,this.l,null,"[Incomplete Response]");break}else if(cr==U){this.m=4,Zt(15),Xa(this.i,this.l,E,"[Invalid Chunk]"),u=!1;break}else Xa(this.i,this.l,cr,null),We(this,cr);if(Z(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),He!=4||E.length!=0||this.h.h||(this.m=1,Zt(16),u=!1),this.o=this.o&&u,!u)Xa(this.i,this.l,E,"[Invalid Chunked Response]"),Te(this),ve(this);else if(E.length>0&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.aa&&!Ee.P&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),xd(Ee),Ee.P=!0,Zt(11))}}else Xa(this.i,this.l,E,null),We(this,E);He==4&&Te(this),this.o&&!this.K&&(He==4?Lg(this.j,this):(this.o=!1,le(this)))}else WE(this.g),v==400&&E.indexOf("Unknown SID")>0?(this.m=3,Zt(12)):(this.m=0,Zt(13)),Te(this),ve(this)}}}catch{}finally{}};function Y(u){if(!Z(u))return u.g.la();const v=Ag(u.g);if(v==="")return"";let E="";const P=v.length,X=es(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Te(u),ve(u),"";u.h.i=new i.TextDecoder}for(let J=0;J<P;J++)u.h.h=!0,E+=u.h.i.decode(v[J],{stream:!(X&&J==P-1)});return v.length=0,u.h.g+=E,u.C=0,u.h.g}function Z(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function re(u,v){var E=u.C,P=v.indexOf(`
`,E);return P==-1?z:(E=Number(v.substring(E,P)),isNaN(E)?U:(P+=1,P+E>v.length?z:(v=v.slice(P,P+E),u.C=P+E,v)))}O.prototype.cancel=function(){this.K=!0,Te(this)};function le(u){u.T=Date.now()+u.H,ke(u,u.H)}function ke(u,v){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Js(c(u.aa,u),v)}function ye(u){u.D&&(i.clearTimeout(u.D),u.D=null)}O.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(bd(this.i,this.B),this.M!=2&&(Qs(),Zt(17)),Te(this),this.m=2,ve(this)):ke(this,this.T-u)};function ve(u){u.j.I==0||u.K||Lg(u.j,u)}function Te(u){ye(u);var v=u.O;v&&typeof v.dispose=="function"&&v.dispose(),u.O=null,Tn(u.V),u.g&&(v=u.g,u.g=null,v.abort(),v.dispose())}function We(u,v){try{var E=u.j;if(E.I!=0&&(E.g==u||_a(E.h,u))){if(!u.L&&_a(E.h,u)&&E.I==3){try{var P=E.Ba.g.parse(v)}catch{P=null}if(Array.isArray(P)&&P.length==3){var X=P;if(X[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<u.F)xu(E),Eu(E);else break e;Sd(E),Zt(18)}}else E.xa=X[1],0<E.xa-E.K&&X[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Js(c(E.Va,E),6e3));Qa(E.h)<=1&&E.ta&&(E.ta=void 0)}else ti(E,11)}else if((u.L||E.g==u)&&xu(E),!D(v))for(X=E.Ba.g.parse(v),v=0;v<X.length;v++){let kt=X[v];const cr=kt[0];if(!(cr<=E.K))if(E.K=cr,kt=kt[1],E.I==2)if(kt[0]=="c"){E.M=kt[1],E.ba=kt[2];const na=kt[3];na!=null&&(E.ka=na,E.j.info("VER="+E.ka));const qi=kt[4];qi!=null&&(E.za=qi,E.j.info("SVER="+E.za));const ts=kt[5];ts!=null&&typeof ts=="number"&&ts>0&&(P=1.5*ts,E.O=P,E.j.info("backChannelRequestTimeoutMs_="+P)),P=E;const rs=u.g;if(rs){const Cu=rs.g?rs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cu){var J=P.h;J.g||Cu.indexOf("spdy")==-1&&Cu.indexOf("quic")==-1&&Cu.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Ca(J,J.h),J.h=null))}if(P.G){const _d=rs.g?rs.g.getResponseHeader("X-HTTP-Session-Id"):null;_d&&(P.wa=_d,wt(P.J,P.G,_d))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-u.F,E.j.info("Handshake RTT: "+E.T+"ms")),P=E;var Ee=u;if(P.na=Ug(P,P.L?P.ba:null,P.W),Ee.L){ta(P.h,Ee);var He=Ee,er=P.O;er&&(He.H=er),He.D&&(ye(He),le(He)),P.g=Ee}else Og(P);E.i.length>0&&Su(E)}else kt[0]!="stop"&&kt[0]!="close"||ti(E,7);else E.I==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?ti(E,7):Ed(E):kt[0]!="noop"&&E.l&&E.l.qa(kt),E.A=0)}}Qs(4)}catch{}}var yt=class{constructor(u,v){this.g=u,this.map=v}};function vt(u){this.l=u||10,i.PerformanceNavigationTiming?(u=i.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function _r(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Qa(u){return u.h?1:u.g?u.g.size:0}function _a(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function Ca(u,v){u.g?u.g.add(v):u.h=v}function ta(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}vt.prototype.cancel=function(){if(this.i=Hi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Hi(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const E of u.g.values())v=v.concat(E.G);return v}return p(u.i)}var En=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function RE(u,v){if(u){u=u.split("&");for(let E=0;E<u.length;E++){const P=u[E].indexOf("=");let X,J=null;P>=0?(X=u[E].substring(0,P),J=u[E].substring(P+1)):X=u[E],v(X,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function Ja(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;u instanceof Ja?(this.l=u.l,fl(this,u.j),this.o=u.o,this.g=u.g,hl(this,u.u),this.h=u.h,wd(this,Tg(u.i)),this.m=u.m):u&&(v=String(u).match(En))?(this.l=!1,fl(this,v[1]||"",!0),this.o=dl(v[2]||""),this.g=dl(v[3]||"",!0),hl(this,v[4]),this.h=dl(v[5]||"",!0),wd(this,v[6]||"",!0),this.m=dl(v[7]||"")):(this.l=!1,this.i=new ml(null,this.l))}Ja.prototype.toString=function(){const u=[];var v=this.j;v&&u.push(pl(v,vg,!0),":");var E=this.g;return(E||v=="file")&&(u.push("//"),(v=this.o)&&u.push(pl(v,vg,!0),"@"),u.push(C(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&u.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(pl(E,E.charAt(0)=="/"?PE:OE,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",pl(E,FE)),u.join("")},Ja.prototype.resolve=function(u){const v=ra(this);let E=!!u.j;E?fl(v,u.j):E=!!u.o,E?v.o=u.o:E=!!u.g,E?v.g=u.g:E=u.u!=null;var P=u.h;if(E)hl(v,u.u);else if(E=!!u.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var X=v.h.lastIndexOf("/");X!=-1&&(P=v.h.slice(0,X+1)+P)}if(X=P,X==".."||X==".")P="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){P=X.lastIndexOf("/",0)==0,X=X.split("/");const J=[];for(let Ee=0;Ee<X.length;){const He=X[Ee++];He=="."?P&&Ee==X.length&&J.push(""):He==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),P&&Ee==X.length&&J.push("")):(J.push(He),P=!0)}P=J.join("/")}else P=X}return E?v.h=P:E=u.i.toString()!=="",E?wd(v,Tg(u.i)):E=!!u.m,E&&(v.m=u.m),v};function ra(u){return new Ja(u)}function fl(u,v,E){u.j=E?dl(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function hl(u,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);u.u=v}else u.u=null}function wd(u,v,E){v instanceof ml?(u.i=v,ME(u.i,u.l)):(E||(v=pl(v,LE)),u.i=new ml(v,u.l))}function wt(u,v,E){u.i.set(v,E)}function wu(u){return wt(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function dl(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function pl(u,v,E){return typeof u=="string"?(u=encodeURI(u).replace(v,DE),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function DE(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var vg=/[#\/\?@]/g,OE=/[#\?:]/g,PE=/[#\?]/g,LE=/[#\?@]/g,FE=/#/g;function ml(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function ei(u){u.g||(u.g=new Map,u.h=0,u.i&&RE(u.i,function(v,E){u.add(decodeURIComponent(v.replace(/\+/g," ")),E)}))}e=ml.prototype,e.add=function(u,v){ei(this),this.i=null,u=$i(this,u);let E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(v),this.h+=1,this};function bg(u,v){ei(u),v=$i(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function yg(u,v){return ei(u),v=$i(u,v),u.g.has(v)}e.forEach=function(u,v){ei(this),this.g.forEach(function(E,P){E.forEach(function(X){u.call(v,X,P,this)},this)},this)};function wg(u,v){ei(u);let E=[];if(typeof v=="string")yg(u,v)&&(E=E.concat(u.g.get($i(u,v))));else for(u=Array.from(u.g.values()),v=0;v<u.length;v++)E=E.concat(u[v]);return E}e.set=function(u,v){return ei(this),this.i=null,u=$i(this,u),yg(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},e.get=function(u,v){return u?(u=wg(this,u),u.length>0?String(u[0]):v):v};function kg(u,v,E){bg(u,v),E.length>0&&(u.i=null,u.g.set($i(u,v),p(E)),u.h+=E.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(let P=0;P<v.length;P++){var E=v[P];const X=C(E);E=wg(this,E);for(let J=0;J<E.length;J++){let Ee=X;E[J]!==""&&(Ee+="="+C(E[J])),u.push(Ee)}}return this.i=u.join("&")};function Tg(u){const v=new ml;return v.i=u.i,u.g&&(v.g=new Map(u.g),v.h=u.h),v}function $i(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function ME(u,v){v&&!u.j&&(ei(u),u.i=null,u.g.forEach(function(E,P){const X=P.toLowerCase();P!=X&&(bg(this,P),kg(this,X,E))},u)),u.j=v}function UE(u,v){const E=new Zs;if(i.Image){const P=new Image;P.onload=f(Za,E,"TestLoadImage: loaded",!0,v,P),P.onerror=f(Za,E,"TestLoadImage: error",!1,v,P),P.onabort=f(Za,E,"TestLoadImage: abort",!1,v,P),P.ontimeout=f(Za,E,"TestLoadImage: timeout",!1,v,P),i.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=u}else v(!1)}function jE(u,v){const E=new Zs,P=new AbortController,X=setTimeout(()=>{P.abort(),Za(E,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:P.signal}).then(J=>{clearTimeout(X),J.ok?Za(E,"TestPingServer: ok",!0,v):Za(E,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(X),Za(E,"TestPingServer: error",!1,v)})}function Za(u,v,E,P,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),P(E)}catch{}}function zE(){this.g=new mt}function kd(u){this.i=u.Sb||null,this.h=u.ab||!1}h(kd,Wr),kd.prototype.g=function(){return new ku(this.i,this.h)};function ku(u,v){dt.call(this),this.H=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(ku,dt),e=ku.prototype,e.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=v,this.readyState=1,vl(this)},e.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(v.body=u),(this.H||i).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,gl(this)),this.readyState=0},e.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,vl(this)),this.g&&(this.readyState=3,vl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof i.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Eg(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function Eg(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}e.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?gl(this):vl(this),this.readyState==3&&Eg(this)}},e.Oa=function(u){this.g&&(this.response=this.responseText=u,gl(this))},e.Na=function(u){this.g&&(this.response=u,gl(this))},e.ga=function(){this.g&&gl(this)};function gl(u){u.readyState=4,u.l=null,u.j=null,u.B=null,vl(u)}e.setRequestHeader=function(u,v){this.A.append(u,v)},e.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var E=v.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=v.next();return u.join(`\r
`)};function vl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Sg(u){let v="";return te(u,function(E,P){v+=P,v+=":",v+=E,v+=`\r
`}),v}function Td(u,v,E){e:{for(P in E){var P=!1;break e}P=!0}P||(E=Sg(E),typeof u=="string"?E!=null&&C(E):wt(u,v,E))}function Mt(u){dt.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Mt,dt);var VE=/^https?$/i,BE=["POST","PUT"];e=Mt.prototype,e.Fa=function(u){this.H=u},e.ea=function(u,v,E,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():yu.g(),this.g.onreadystatechange=d(c(this.Ca,this));try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(J){xg(this,J);return}if(u=E||"",E=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var X in P)E.set(X,P[X]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const J of P.keys())E.set(J,P.get(J));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(E.keys()).find(J=>J.toLowerCase()=="content-type"),X=i.FormData&&u instanceof i.FormData,!(Array.prototype.indexOf.call(BE,v,void 0)>=0)||P||X||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,Ee]of E)this.g.setRequestHeader(J,Ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(J){xg(this,J)}};function xg(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.o=5,_g(u),Tu(u)}function _g(u){u.A||(u.A=!0,st(u,"complete"),st(u,"error"))}e.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,st(this,"complete"),st(this,"abort"),Tu(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Tu(this,!0)),Mt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Cg(this):this.Xa())},e.Xa=function(){Cg(this)};function Cg(u){if(u.h&&typeof s<"u"){if(u.v&&es(u)==4)setTimeout(u.Ca.bind(u),0);else if(st(u,"readystatechange"),es(u)==4){u.h=!1;try{const J=u.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var E;if(!(E=v)){var P;if(P=J===0){let Ee=String(u.D).match(En)[1]||null;!Ee&&i.self&&i.self.location&&(Ee=i.self.location.protocol.slice(0,-1)),P=!VE.test(Ee?Ee.toLowerCase():"")}E=P}if(E)st(u,"complete"),st(u,"success");else{u.o=6;try{var X=es(u)>2?u.g.statusText:""}catch{X=""}u.l=X+" ["+u.ca()+"]",_g(u)}}finally{Tu(u)}}}}function Tu(u,v){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const E=u.g;u.g=null,v||st(u,"ready");try{E.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function es(u){return u.g?u.g.readyState:0}e.ca=function(){try{return es(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.La=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),Ve(v)}};function Ag(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function WE(u){const v={};u=(u.g&&es(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<u.length;P++){if(D(u[P]))continue;var E=M(u[P]);const X=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const J=v[X]||[];v[X]=J,J.push(E)}fe(v,function(P){return P.join(", ")})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bl(u,v,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||v}function Ng(u){this.za=0,this.i=[],this.j=new Zs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bl("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bl("baseRetryDelayMs",5e3,u),this.Za=bl("retryDelaySeedMs",1e4,u),this.Ta=bl("forwardChannelMaxRetries",2,u),this.va=bl("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new vt(u&&u.concurrentRequestLimit),this.Ba=new zE,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=Ng.prototype,e.ka=8,e.I=1,e.connect=function(u,v,E,P){Zt(0),this.W=u,this.H=v||{},E&&P!==void 0&&(this.H.OSID=E,this.H.OAID=P),this.F=this.X,this.J=Ug(this,null,this.W),Su(this)};function Ed(u){if(Ig(u),u.I==3){var v=u.V++,E=ra(u.J);if(wt(E,"SID",u.M),wt(E,"RID",v),wt(E,"TYPE","terminate"),yl(u,E),v=new O(u,u.j,v),v.M=2,v.A=wu(ra(E)),E=!1,i.navigator&&i.navigator.sendBeacon)try{E=i.navigator.sendBeacon(v.A.toString(),"")}catch{}!E&&i.Image&&(new Image().src=v.A,E=!0),E||(v.g=jg(v.j,null),v.g.ea(v.A)),v.F=Date.now(),le(v)}Mg(u)}function Eu(u){u.g&&(xd(u),u.g.cancel(),u.g=null)}function Ig(u){Eu(u),u.v&&(i.clearTimeout(u.v),u.v=null),xu(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&i.clearTimeout(u.m),u.m=null)}function Su(u){if(!_r(u.h)&&!u.m){u.m=!0;var v=u.Ea;_||S(),F||(_(),F=!0),T.add(v,u),u.D=0}}function HE(u,v){return Qa(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=v.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Js(c(u.Ea,u,v),Fg(u,u.D)),u.D++,!0)}e.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const X=new O(this,this.j,u);let J=this.o;if(this.U&&(J?(J=Ae(J),G(J,this.U)):J=this.U),this.u!==null||this.R||(X.J=J,J=null),this.S)e:{for(var v=0,E=0;E<this.i.length;E++){t:{var P=this.i[E];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(v+=P,v>4096){v=E;break e}if(v===4096||E===this.i.length-1){v=E+1;break e}}v=1e3}else v=1e3;v=Dg(this,X,v),E=ra(this.J),wt(E,"RID",u),wt(E,"CVER",22),this.G&&wt(E,"X-HTTP-Session-Id",this.G),yl(this,E),J&&(this.R?v="headers="+C(Sg(J))+"&"+v:this.u&&Td(E,this.u,J)),Ca(this.h,X),this.Ra&&wt(E,"TYPE","init"),this.S?(wt(E,"$req",v),wt(E,"SID","null"),X.U=!0,K(X,E,null)):K(X,E,v),this.I=2}}else this.I==3&&(u?Rg(this,u):this.i.length==0||_r(this.h)||Rg(this))};function Rg(u,v){var E;v?E=v.l:E=u.V++;const P=ra(u.J);wt(P,"SID",u.M),wt(P,"RID",E),wt(P,"AID",u.K),yl(u,P),u.u&&u.o&&Td(P,u.u,u.o),E=new O(u,u.j,E,u.D+1),u.u===null&&(E.J=u.o),v&&(u.i=v.G.concat(u.i)),v=Dg(u,E,1e3),E.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Ca(u.h,E),K(E,P,v)}function yl(u,v){u.H&&te(u.H,function(E,P){wt(v,P,E)}),u.l&&te({},function(E,P){wt(v,P,E)})}function Dg(u,v,E){E=Math.min(u.i.length,E);const P=u.l?c(u.l.Ka,u.l,u):null;e:{var X=u.i;let He=-1;for(;;){const er=["count="+E];He==-1?E>0?(He=X[0].g,er.push("ofs="+He)):He=0:er.push("ofs="+He);let kt=!0;for(let cr=0;cr<E;cr++){var J=X[cr].g;const na=X[cr].map;if(J-=He,J<0)He=Math.max(0,X[cr].g-100),kt=!1;else try{J="req"+J+"_"||"";try{var Ee=na instanceof Map?na:Object.entries(na);for(const[qi,ts]of Ee){let rs=ts;o(ts)&&(rs=on(ts)),er.push(J+qi+"="+encodeURIComponent(rs))}}catch(qi){throw er.push(J+"type="+encodeURIComponent("_badmap")),qi}}catch{P&&P(na)}}if(kt){Ee=er.join("&");break e}}Ee=void 0}return u=u.i.splice(0,E),v.G=u,Ee}function Og(u){if(!u.g&&!u.v){u.Y=1;var v=u.Da;_||S(),F||(_(),F=!0),T.add(v,u),u.A=0}}function Sd(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Js(c(u.Da,u),Fg(u,u.A)),u.A++,!0)}e.Da=function(){if(this.v=null,Pg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Js(c(this.Wa,this),u)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Zt(10),Eu(this),Pg(this))};function xd(u){u.B!=null&&(i.clearTimeout(u.B),u.B=null)}function Pg(u){u.g=new O(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var v=ra(u.na);wt(v,"RID","rpc"),wt(v,"SID",u.M),wt(v,"AID",u.K),wt(v,"CI",u.F?"0":"1"),!u.F&&u.ia&&wt(v,"TO",u.ia),wt(v,"TYPE","xmlhttp"),yl(u,v),u.u&&u.o&&Td(v,u.u,u.o),u.O&&(u.g.H=u.O);var E=u.g;u=u.ba,E.M=1,E.A=wu(ra(v)),E.u=null,E.R=!0,Q(E,u)}e.Va=function(){this.C!=null&&(this.C=null,Eu(this),Sd(this),Zt(19))};function xu(u){u.C!=null&&(i.clearTimeout(u.C),u.C=null)}function Lg(u,v){var E=null;if(u.g==v){xu(u),xd(u),u.g=null;var P=2}else if(_a(u.h,v))E=v.G,ta(u.h,v),P=1;else return;if(u.I!=0){if(v.o)if(P==1){E=v.u?v.u.length:0,v=Date.now()-v.F;var X=u.D;P=Ys(),st(P,new vu(P,E)),Su(u)}else Og(u);else if(X=v.m,X==3||X==0&&v.X>0||!(P==1&&HE(u,v)||P==2&&Sd(u)))switch(E&&E.length>0&&(v=u.h,v.i=v.i.concat(E)),X){case 1:ti(u,5);break;case 4:ti(u,10);break;case 3:ti(u,6);break;default:ti(u,2)}}}function Fg(u,v){let E=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(E*=2),E*v}function ti(u,v){if(u.j.info("Error code "+v),v==2){var E=c(u.bb,u),P=u.Ua;const X=!P;P=new Ja(P||"//www.google.com/images/cleardot.gif"),i.location&&i.location.protocol=="http"||fl(P,"https"),wu(P),X?UE(P.toString(),E):jE(P.toString(),E)}else Zt(2);u.I=0,u.l&&u.l.pa(v),Mg(u),Ig(u)}e.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function Mg(u){if(u.I=0,u.ja=[],u.l){const v=Hi(u.h);(v.length!=0||u.i.length!=0)&&(g(u.ja,v),g(u.ja,u.i),u.h.i.length=0,p(u.i),u.i.length=0),u.l.oa()}}function Ug(u,v,E){var P=E instanceof Ja?ra(E):new Ja(E);if(P.g!="")v&&(P.g=v+"."+P.g),hl(P,P.u);else{var X=i.location;P=X.protocol,v=v?v+"."+X.hostname:X.hostname,X=+X.port;const J=new Ja(null);P&&fl(J,P),v&&(J.g=v),X&&hl(J,X),E&&(J.h=E),P=J}return E=u.G,v=u.wa,E&&v&&wt(P,E,v),wt(P,"VER",u.ka),yl(u,P),P}function jg(u,v,E){if(v&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Aa&&!u.ma?new Mt(new kd({ab:E})):new Mt(u.ma),v.Fa(u.L),v}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function zg(){}e=zg.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function _u(){}_u.prototype.g=function(u,v){return new cn(u,v)};function cn(u,v){dt.call(this),this.g=new Ng(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(u?u["X-WebChannel-Client-Profile"]=v.sa:u={"X-WebChannel-Client-Profile":v.sa}),this.g.U=u,(u=v&&v.Qb)&&!D(u)&&(this.g.u=u),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!D(v)&&(this.g.G=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new Gi(this)}h(cn,dt),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Ed(this.g)},cn.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.v&&(E={},E.__data__=on(u),u=E);v.i.push(new yt(v.Ya++,u)),v.I==3&&Su(v)},cn.prototype.N=function(){this.g.l=null,delete this.j,Ed(this.g),delete this.g,cn.Z.N.call(this)};function Vg(u){Wi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const E in v){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}h(Vg,Wi);function Bg(){ol.call(this),this.status=1}h(Bg,ol);function Gi(u){this.g=u}h(Gi,zg),Gi.prototype.ra=function(){st(this.g,"a")},Gi.prototype.qa=function(u){st(this.g,new Vg(u))},Gi.prototype.pa=function(u){st(this.g,new Bg)},Gi.prototype.oa=function(){st(this.g,"b")},_u.prototype.createWebChannel=_u.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,V4=function(){return new _u},z4=function(){return Ys()},j4=xa,k1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ya.NO_ERROR=0,Ya.TIMEOUT=8,Ya.HTTP_ERROR=6,Tf=Ya,bu.COMPLETE="complete",U4=bu,Ft.EventType=ln,ln.OPEN="a",ln.CLOSE="b",ln.ERROR="c",ln.MESSAGE="d",dt.prototype.listen=dt.prototype.J,Ol=Ft,Mt.prototype.listenOnce=Mt.prototype.K,Mt.prototype.getLastError=Mt.prototype.Ha,Mt.prototype.getLastErrorCode=Mt.prototype.ya,Mt.prototype.getStatus=Mt.prototype.ca,Mt.prototype.getResponseJson=Mt.prototype.La,Mt.prototype.getResponseText=Mt.prototype.la,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Fa,M4=Mt}).apply(typeof $u<"u"?$u:typeof self<"u"?self:typeof window<"u"?window:{});const u2="@firebase/firestore",f2="4.9.3";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Rr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Rr.UNAUTHENTICATED=new Rr(null),Rr.GOOGLE_CREDENTIALS=new Rr("google-credentials-uid"),Rr.FIRST_PARTY=new Rr("first-party-uid"),Rr.MOCK_USER=new Rr("mock-user");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Zo="12.7.0";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ki=new I4("@firebase/firestore");function Ji(){return ki.logLevel}function _e(e,...t){if(ki.logLevel<=et.DEBUG){const r=t.map(K0);ki.debug(`Firestore (${Zo}): ${e}`,...r)}}function Ba(e,...t){if(ki.logLevel<=et.ERROR){const r=t.map(K0);ki.error(`Firestore (${Zo}): ${e}`,...r)}}function jo(e,...t){if(ki.logLevel<=et.WARN){const r=t.map(K0);ki.warn(`Firestore (${Zo}): ${e}`,...r)}}function K0(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(e)}catch{return e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Pe(e,t,r){let n="Unexpected state";typeof t=="string"?n=t:r=t,B4(e,n,r)}function B4(e,t,r){let n=`FIRESTORE (${Zo}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ba(n),new Error(n)}function lt(e,t,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,e||B4(t,a,n)}function Me(e,t){return e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends Jo{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ns{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class W4{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class n_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Rr.UNAUTHENTICATED))}shutdown(){}}class a_{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class s_{constructor(t){this.t=t,this.currentUser=Rr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){lt(this.o===void 0,42304);let n=this.i;const a=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Ns;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ns,t.enqueueRetryable(()=>a(this.currentUser))};const i=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await a(this.currentUser)})},o=l=>{_e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(_e("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ns)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(_e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(lt(typeof n.accessToken=="string",31837,{l:n}),new W4(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return lt(t===null||typeof t=="string",2055,{h:t}),new Rr(t)}}class i_{constructor(t,r,n){this.P=t,this.T=r,this.I=n,this.type="FirstParty",this.user=Rr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class o_{constructor(t,r,n){this.P=t,this.T=r,this.I=n}getToken(){return Promise.resolve(new i_(this.P,this.T,this.I))}start(t,r){t.enqueueRetryable(()=>r(Rr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class h2{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class l_{constructor(t,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zx(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,r){lt(this.o===void 0,3512);const n=s=>{s.error!=null&&_e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const i=s.token!==this.m;return this.m=s.token,_e("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>n(s))};const a=s=>{_e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?a(s):_e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new h2(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(lt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new h2(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function c_(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class X0{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=c_(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=t.charAt(a[s]%62))}return n}}function Xe(e,t){return e<t?-1:e>t?1:0}function T1(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const a=e.charAt(n),s=t.charAt(n);if(a!==s)return np(a)===np(s)?Xe(a,s):np(a)?1:-1}return Xe(e.length,t.length)}const u_=55296,f_=57343;function np(e){const t=e.charCodeAt(0);return t>=u_&&t<=f_}function zo(e,t,r){return e.length===t.length&&e.every((n,a)=>r(n,t[a]))}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const d2="__name__";class ca{constructor(t,r,n){r===void 0?r=0:r>t.length&&Pe(637,{offset:r,range:t.length}),n===void 0?n=t.length-r:n>t.length-r&&Pe(1746,{length:n,range:t.length-r}),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return ca.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof ca?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let a=0;a<n;a++){const s=ca.compareSegments(t.get(a),r.get(a));if(s!==0)return s}return Xe(t.length,r.length)}static compareSegments(t,r){const n=ca.isNumericId(t),a=ca.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?ca.extractNumericId(t).compare(ca.extractNumericId(r)):T1(t,r)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return As.fromString(t.substring(4,t.length-2))}}class It extends ca{construct(t,r,n){return new It(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ne(oe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new It(r)}static emptyPath(){return new It([])}}const h_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kr extends ca{construct(t,r,n){return new kr(t,r,n)}static isValidIdentifier(t){return h_.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===d2}static keyField(){return new kr([d2])}static fromServerFormat(t){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Ne(oe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;a<t.length;){const o=t[a];if(o==="\\"){if(a+1===t.length)throw new Ne(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[a+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ne(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,a+=2}else o==="`"?(i=!i,a++):o!=="."||i?(n+=o,a++):(s(),a++)}if(s(),i)throw new Ne(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new kr(r)}static emptyPath(){return new kr([])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class De{constructor(t){this.path=t}static fromPath(t){return new De(It.fromString(t))}static fromName(t){return new De(It.fromString(t).popFirst(5))}static empty(){return new De(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&It.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return It.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new De(new It(t.slice()))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function d_(e,t,r){if(!r)throw new Ne(oe.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function p_(e,t,r,n){if(t===!0&&n===!0)throw new Ne(oe.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function p2(e){if(!De.isDocumentKey(e))throw new Ne(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function H4(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Y0(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Pe(12329,{type:typeof e})}function Is(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ne(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Y0(e);throw new Ne(oe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Jt(e,t){const r={typeString:e};return t&&(r.value=t),r}function ru(e,t){if(!H4(e))throw new Ne(oe.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in t)if(t[n]){const a=t[n].typeString,s="value"in t[n]?{value:t[n].value}:void 0;if(!(n in e)){r=`JSON missing required field: '${n}'`;break}const i=e[n];if(a&&typeof i!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(s!==void 0&&i!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new Ne(oe.INVALID_ARGUMENT,r);return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const m2=-62135596800,g2=1e6;class St{static now(){return St.fromMillis(Date.now())}static fromDate(t){return St.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor((t-1e3*r)*g2);return new St(r,n)}constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Ne(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ne(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<m2)throw new Ne(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ne(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/g2}_compareTo(t){return this.seconds===t.seconds?Xe(this.nanoseconds,t.nanoseconds):Xe(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:St._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(ru(t,St._jsonSchema))return new St(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-m2;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}St._jsonSchemaVersion="firestore/timestamp/1.0",St._jsonSchema={type:Jt("string",St._jsonSchemaVersion),seconds:Jt("number"),nanoseconds:Jt("number")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Fe{static fromTimestamp(t){return new Fe(t)}static min(){return new Fe(new St(0,0))}static max(){return new Fe(new St(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ac=-1;function m_(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,a=Fe.fromTimestamp(n===1e9?new St(r+1,0):new St(r,n));return new Os(a,De.empty(),t)}function g_(e){return new Os(e.readTime,e.key,Ac)}class Os{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new Os(Fe.min(),De.empty(),Ac)}static max(){return new Os(Fe.max(),De.empty(),Ac)}}function v_(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=De.comparator(e.documentKey,t.documentKey),r!==0?r:Xe(e.largestBatchId,t.largestBatchId))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const b_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class y_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function el(e){if(e.code!==oe.FAILED_PRECONDITION||e.message!==b_)throw e;_e("LocalStore","Unexpectedly lost primary lease")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ae{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new ae((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof ae?r:ae.resolve(r)}catch(r){return ae.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):ae.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):ae.reject(r)}static resolve(t){return new ae((r,n)=>{r(t)})}static reject(t){return new ae((r,n)=>{n(t)})}static waitFor(t){return new ae((r,n)=>{let a=0,s=0,i=!1;t.forEach(o=>{++a,o.next(()=>{++s,i&&s===a&&r()},l=>n(l))}),i=!0,s===a&&r()})}static or(t){let r=ae.resolve(!1);for(const n of t)r=r.next(a=>a?ae.resolve(a):n());return r}static forEach(t,r){const n=[];return t.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(t,r){return new ae((n,a)=>{const s=t.length,i=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(t[c]).next(f=>{i[c]=f,++o,o===s&&n(i)},f=>a(f))}})}static doWhile(t,r){return new ae((n,a)=>{const s=()=>{t()===!0?r().next(()=>{s()},a):n()};s()})}}function w_(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function tl(e){return e.name==="IndexedDbTransactionError"}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wh{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Wh.ce=-1;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Q0=-1;function Hh(e){return e==null}function rh(e){return e===0&&1/e==-1/0}function k_(e){return typeof e=="number"&&Number.isInteger(e)&&!rh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const $4="";function T_(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=v2(t)),t=E_(e.get(r),t);return v2(t)}function E_(e,t){let r=t;const n=e.length;for(let a=0;a<n;a++){const s=e.charAt(a);switch(s){case"\0":r+="";break;case $4:r+="";break;default:r+=s}}return r}function v2(e){return e+$4+""}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function b2(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Di(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function G4(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Pt{constructor(t,r){this.comparator=t,this.root=r||yr.EMPTY}insert(t,r){return new Pt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,yr.BLACK,null,null))}remove(t){return new Pt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,yr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(t,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gu(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gu(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gu(this.root,t,this.comparator,!0)}}class Gu{constructor(t,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?n(t.key,r):1,r&&a&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class yr{constructor(t,r,n,a,s){this.key=t,this.value=r,this.color=n??yr.RED,this.left=a??yr.EMPTY,this.right=s??yr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,a,s){return new yr(t??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let a=this;const s=n(t,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(t,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return yr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,a=this;if(r(t,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(t,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(t,a.key)===0){if(a.right.isEmpty())return yr.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(t,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,yr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,yr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Pe(27949);return t+(this.isRed()?0:1)}}yr.EMPTY=null,yr.RED=!0,yr.BLACK=!1;yr.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,t,r,n,a){return this}insert(e,t,r){return new yr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ir{constructor(t){this.comparator=t,this.data=new Pt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,t[1])>=0)return;r(a.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new y2(this.data.getIterator())}getIteratorFrom(t){return new y2(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof ir)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new ir(this.comparator);return r.data=t,r}}class y2{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qn{constructor(t){this.fields=t,t.sort(kr.comparator)}static empty(){return new qn([])}unionWith(t){let r=new ir(kr.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new qn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return zo(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class q4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class xr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(n){try{return atob(n)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new q4("Invalid base64 string: "+a):a}}(t);return new xr(r)}static fromUint8Array(t){const r=function(n){let a="";for(let s=0;s<n.length;++s)a+=String.fromCharCode(n[s]);return a}(t);return new xr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Xe(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}xr.EMPTY_BYTE_STRING=new xr("");const S_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ps(e){if(lt(!!e,39018),typeof e=="string"){let t=0;const r=S_.exec(e);if(lt(!!r,46558,{timestamp:e}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),t=Number(a)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Ht(e.seconds),nanos:Ht(e.nanos)}}function Ht(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Ls(e){return typeof e=="string"?xr.fromBase64String(e):xr.fromUint8Array(e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const K4="server_timestamp",X4="__type__",Y4="__previous_value__",Q4="__local_write_time__";function J0(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)==null?void 0:t.fields)||{})[X4])==null?void 0:r.stringValue)===K4}function $h(e){const t=e.mapValue.fields[Y4];return J0(t)?$h(t):t}function Nc(e){const t=Ps(e.mapValue.fields[Q4].timestampValue);return new St(t.seconds,t.nanos)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class x_{constructor(t,r,n,a,s,i,o,l,c,f){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=f}}const nh="(default)";class Ic{constructor(t,r){this.projectId=t,this.database=r||nh}static empty(){return new Ic("","")}get isDefaultDatabase(){return this.database===nh}isEqual(t){return t instanceof Ic&&t.projectId===this.projectId&&t.database===this.database}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const J4="__type__",__="__max__",qu={mapValue:{}},Z4="__vector__",ah="value";function Fs(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?J0(e)?4:A_(e)?9007199254740991:C_(e)?10:11:Pe(28295,{value:e})}function ya(e,t){if(e===t)return!0;const r=Fs(e);if(r!==Fs(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Nc(e).isEqual(Nc(t));case 3:return function(n,a){if(typeof n.timestampValue=="string"&&typeof a.timestampValue=="string"&&n.timestampValue.length===a.timestampValue.length)return n.timestampValue===a.timestampValue;const s=Ps(n.timestampValue),i=Ps(a.timestampValue);return s.seconds===i.seconds&&s.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(n,a){return Ls(n.bytesValue).isEqual(Ls(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(n,a){return Ht(n.geoPointValue.latitude)===Ht(a.geoPointValue.latitude)&&Ht(n.geoPointValue.longitude)===Ht(a.geoPointValue.longitude)}(e,t);case 2:return function(n,a){if("integerValue"in n&&"integerValue"in a)return Ht(n.integerValue)===Ht(a.integerValue);if("doubleValue"in n&&"doubleValue"in a){const s=Ht(n.doubleValue),i=Ht(a.doubleValue);return s===i?rh(s)===rh(i):isNaN(s)&&isNaN(i)}return!1}(e,t);case 9:return zo(e.arrayValue.values||[],t.arrayValue.values||[],ya);case 10:case 11:return function(n,a){const s=n.mapValue.fields||{},i=a.mapValue.fields||{};if(b2(s)!==b2(i))return!1;for(const o in s)if(s.hasOwnProperty(o)&&(i[o]===void 0||!ya(s[o],i[o])))return!1;return!0}(e,t);default:return Pe(52216,{left:e})}}function Rc(e,t){return(e.values||[]).find(r=>ya(r,t))!==void 0}function Vo(e,t){if(e===t)return 0;const r=Fs(e),n=Fs(t);if(r!==n)return Xe(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Xe(e.booleanValue,t.booleanValue);case 2:return function(a,s){const i=Ht(a.integerValue||a.doubleValue),o=Ht(s.integerValue||s.doubleValue);return i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1}(e,t);case 3:return w2(e.timestampValue,t.timestampValue);case 4:return w2(Nc(e),Nc(t));case 5:return T1(e.stringValue,t.stringValue);case 6:return function(a,s){const i=Ls(a),o=Ls(s);return i.compareTo(o)}(e.bytesValue,t.bytesValue);case 7:return function(a,s){const i=a.split("/"),o=s.split("/");for(let l=0;l<i.length&&l<o.length;l++){const c=Xe(i[l],o[l]);if(c!==0)return c}return Xe(i.length,o.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,s){const i=Xe(Ht(a.latitude),Ht(s.latitude));return i!==0?i:Xe(Ht(a.longitude),Ht(s.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return k2(e.arrayValue,t.arrayValue);case 10:return function(a,s){var i,o,l,c;const f=a.fields||{},h=s.fields||{},d=(i=f[ah])==null?void 0:i.arrayValue,p=(o=h[ah])==null?void 0:o.arrayValue,g=Xe(((l=d==null?void 0:d.values)==null?void 0:l.length)||0,((c=p==null?void 0:p.values)==null?void 0:c.length)||0);return g!==0?g:k2(d,p)}(e.mapValue,t.mapValue);case 11:return function(a,s){if(a===qu.mapValue&&s===qu.mapValue)return 0;if(a===qu.mapValue)return 1;if(s===qu.mapValue)return-1;const i=a.fields||{},o=Object.keys(i),l=s.fields||{},c=Object.keys(l);o.sort(),c.sort();for(let f=0;f<o.length&&f<c.length;++f){const h=T1(o[f],c[f]);if(h!==0)return h;const d=Vo(i[o[f]],l[c[f]]);if(d!==0)return d}return Xe(o.length,c.length)}(e.mapValue,t.mapValue);default:throw Pe(23264,{he:r})}}function w2(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Xe(e,t);const r=Ps(e),n=Ps(t),a=Xe(r.seconds,n.seconds);return a!==0?a:Xe(r.nanos,n.nanos)}function k2(e,t){const r=e.values||[],n=t.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=Vo(r[a],n[a]);if(s)return s}return Xe(r.length,n.length)}function Bo(e){return E1(e)}function E1(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){const r=Ps(t);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(t){return Ls(t).toBase64()}(e.bytesValue):"referenceValue"in e?function(t){return De.fromName(t).toString()}(e.referenceValue):"geoPointValue"in e?function(t){return`geo(${t.latitude},${t.longitude})`}(e.geoPointValue):"arrayValue"in e?function(t){let r="[",n=!0;for(const a of t.values||[])n?n=!1:r+=",",r+=E1(a);return r+"]"}(e.arrayValue):"mapValue"in e?function(t){const r=Object.keys(t.fields||{}).sort();let n="{",a=!0;for(const s of r)a?a=!1:n+=",",n+=`${s}:${E1(t.fields[s])}`;return n+"}"}(e.mapValue):Pe(61005,{value:e})}function Ef(e){switch(Fs(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=$h(e);return t?16+Ef(t):16;case 5:return 2*e.stringValue.length;case 6:return Ls(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((n,a)=>n+Ef(a),0)}(e.arrayValue);case 10:case 11:return function(r){let n=0;return Di(r.fields,(a,s)=>{n+=a.length+Ef(s)}),n}(e.mapValue);default:throw Pe(13486,{value:e})}}function S1(e){return!!e&&"integerValue"in e}function Z0(e){return!!e&&"arrayValue"in e}function T2(e){return!!e&&"nullValue"in e}function E2(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Sf(e){return!!e&&"mapValue"in e}function C_(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)==null?void 0:t.fields)||{})[J4])==null?void 0:r.stringValue)===Z4}function Yl(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Di(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=Yl(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=Yl(e.arrayValue.values[r]);return t}return{...e}}function A_(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===__}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Dn{constructor(t){this.value=t}static empty(){return new Dn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!Sf(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=Yl(r)}setAll(t){let r=kr.emptyPath(),n={},a=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,a),n={},a=[],r=o.popLast()}i?n[o.lastSegment()]=Yl(i):a.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(t){const r=this.field(t.popLast());Sf(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return ya(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let a=r.mapValue.fields[t.get(n)];Sf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(t,r,n){Di(r,(a,s)=>t[a]=s);for(const a of n)delete t[a]}clone(){return new Dn(Yl(this.value))}}function ek(e){const t=[];return Di(e.fields,(r,n)=>{const a=new kr([r]);if(Sf(n)){const s=ek(n.mapValue).fields;if(s.length===0)t.push(a);else for(const i of s)t.push(a.child(i))}else t.push(a)}),new qn(t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Lr{constructor(t,r,n,a,s,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new Lr(t,0,Fe.min(),Fe.min(),Fe.min(),Dn.empty(),0)}static newFoundDocument(t,r,n,a){return new Lr(t,1,r,Fe.min(),n,a,0)}static newNoDocument(t,r){return new Lr(t,2,r,Fe.min(),Fe.min(),Dn.empty(),0)}static newUnknownDocument(t,r){return new Lr(t,3,r,Fe.min(),Fe.min(),Dn.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Dn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Lr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sh{constructor(t,r){this.position=t,this.inclusive=r}}function S2(e,t,r){let n=0;for(let a=0;a<e.position.length;a++){const s=t[a],i=e.position[a];if(s.field.isKeyField()?n=De.comparator(De.fromName(i.referenceValue),r.key):n=Vo(i,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function x2(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!ya(e.position[r],t.position[r]))return!1;return!0}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ih{constructor(t,r="asc"){this.field=t,this.dir=r}}function N_(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class tk{}class rr extends tk{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new R_(t,r,n):r==="array-contains"?new P_(t,n):r==="in"?new L_(t,n):r==="not-in"?new F_(t,n):r==="array-contains-any"?new M_(t,n):new rr(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new D_(t,n):new O_(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Vo(r,this.value)):r!==null&&Fs(this.value)===Fs(r)&&this.matchesComparison(Vo(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class wa extends tk{constructor(t,r){super(),this.filters=t,this.op=r,this.Pe=null}static create(t,r){return new wa(t,r)}matches(t){return rk(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rk(e){return e.op==="and"}function nk(e){return I_(e)&&rk(e)}function I_(e){for(const t of e.filters)if(t instanceof wa)return!1;return!0}function x1(e){if(e instanceof rr)return e.field.canonicalString()+e.op.toString()+Bo(e.value);if(nk(e))return e.filters.map(t=>x1(t)).join(",");{const t=e.filters.map(r=>x1(r)).join(",");return`${e.op}(${t})`}}function ak(e,t){return e instanceof rr?function(r,n){return n instanceof rr&&r.op===n.op&&r.field.isEqual(n.field)&&ya(r.value,n.value)}(e,t):e instanceof wa?function(r,n){return n instanceof wa&&r.op===n.op&&r.filters.length===n.filters.length?r.filters.reduce((a,s,i)=>a&&ak(s,n.filters[i]),!0):!1}(e,t):void Pe(19439)}function sk(e){return e instanceof rr?function(t){return`${t.field.canonicalString()} ${t.op} ${Bo(t.value)}`}(e):e instanceof wa?function(t){return t.op.toString()+" {"+t.getFilters().map(sk).join(" ,")+"}"}(e):"Filter"}class R_ extends rr{constructor(t,r,n){super(t,r,n),this.key=De.fromName(n.referenceValue)}matches(t){const r=De.comparator(t.key,this.key);return this.matchesComparison(r)}}class D_ extends rr{constructor(t,r){super(t,"in",r),this.keys=ik("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class O_ extends rr{constructor(t,r){super(t,"not-in",r),this.keys=ik("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function ik(e,t){var r;return(((r=t.arrayValue)==null?void 0:r.values)||[]).map(n=>De.fromName(n.referenceValue))}class P_ extends rr{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return Z0(r)&&Rc(r.arrayValue,this.value)}}class L_ extends rr{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&Rc(this.value.arrayValue,r)}}class F_ extends rr{constructor(t,r){super(t,"not-in",r)}matches(t){if(Rc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Rc(this.value.arrayValue,r)}}class M_ extends rr{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!Z0(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Rc(this.value.arrayValue,n))}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class U_{constructor(t,r=null,n=[],a=[],s=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=i,this.endAt=o,this.Te=null}}function _2(e,t=null,r=[],n=[],a=null,s=null,i=null){return new U_(e,t,r,n,a,s,i)}function em(e){const t=Me(e);if(t.Te===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>x1(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Hh(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>Bo(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>Bo(n)).join(",")),t.Te=r}return t.Te}function tm(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!N_(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!ak(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!x2(e.startAt,t.startAt)&&x2(e.endAt,t.endAt)}function _1(e){return De.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Gh{constructor(t,r=null,n=[],a=[],s=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function j_(e,t,r,n,a,s,i,o){return new Gh(e,t,r,n,a,s,i,o)}function qh(e){return new Gh(e)}function C2(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function z_(e){return e.collectionGroup!==null}function Ql(e){const t=Me(e);if(t.Ie===null){t.Ie=[];const r=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let s=new ir(kr.comparator);return a.filters.forEach(i=>{i.getFlattenedFilters().forEach(o=>{o.isInequality()&&(s=s.add(o.field))})}),s})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new ih(a,n))}),r.has(kr.keyField().canonicalString())||t.Ie.push(new ih(kr.keyField(),n))}return t.Ie}function pa(e){const t=Me(e);return t.Ee||(t.Ee=V_(t,Ql(e))),t.Ee}function V_(e,t){if(e.limitType==="F")return _2(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new ih(a.field,s)});const r=e.endAt?new sh(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new sh(e.startAt.position,e.startAt.inclusive):null;return _2(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function C1(e,t,r){return new Gh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Kh(e,t){return tm(pa(e),pa(t))&&e.limitType===t.limitType}function ok(e){return`${em(pa(e))}|lt:${e.limitType}`}function Zi(e){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(n=>sk(n)).join(", ")}]`),Hh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(n=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(n)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>Bo(n)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>Bo(n)).join(",")),`Target(${r})`}(pa(e))}; limitType=${e.limitType})`}function Xh(e,t){return t.isFoundDocument()&&function(r,n){const a=n.key.path;return r.collectionGroup!==null?n.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):De.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(e,t)&&function(r,n){for(const a of Ql(r))if(!a.field.isKeyField()&&n.data.field(a.field)===null)return!1;return!0}(e,t)&&function(r,n){for(const a of r.filters)if(!a.matches(n))return!1;return!0}(e,t)&&function(r,n){return!(r.startAt&&!function(a,s,i){const o=S2(a,s,i);return a.inclusive?o<=0:o<0}(r.startAt,Ql(r),n)||r.endAt&&!function(a,s,i){const o=S2(a,s,i);return a.inclusive?o>=0:o>0}(r.endAt,Ql(r),n))}(e,t)}function B_(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function lk(e){return(t,r)=>{let n=!1;for(const a of Ql(e)){const s=W_(a,t,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function W_(e,t,r){const n=e.field.isKeyField()?De.comparator(t.key,r.key):function(a,s,i){const o=s.data.field(a),l=i.data.field(a);return o!==null&&l!==null?Vo(o,l):Pe(42886)}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Pe(19790,{direction:e.dir})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Oi{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),a=this.inner[n];if(a===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],t))return void(a[s]=[t,r]);a.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],t))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(t){Di(this.inner,(r,n)=>{for(const[a,s]of n)t(a,s)})}isEmpty(){return G4(this.inner)}size(){return this.innerSize}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const H_=new Pt(De.comparator);function Wa(){return H_}const ck=new Pt(De.comparator);function Pl(...e){let t=ck;for(const r of e)t=t.insert(r.key,r);return t}function uk(e){let t=ck;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function ci(){return Jl()}function fk(){return Jl()}function Jl(){return new Oi(e=>e.toString(),(e,t)=>e.isEqual(t))}const $_=new Pt(De.comparator),G_=new ir(De.comparator);function Ye(...e){let t=G_;for(const r of e)t=t.add(r);return t}const q_=new ir(Xe);function K_(){return q_}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function rm(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rh(t)?"-0":t}}function hk(e){return{integerValue:""+e}}function X_(e,t){return k_(t)?hk(t):rm(e,t)}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Yh{constructor(){this._=void 0}}function Y_(e,t,r){return e instanceof oh?function(n,a){const s={fields:{[X4]:{stringValue:K4},[Q4]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return a&&J0(a)&&(a=$h(a)),a&&(s.fields[Y4]=a),{mapValue:s}}(r,t):e instanceof Dc?pk(e,t):e instanceof Oc?mk(e,t):function(n,a){const s=dk(n,a),i=A2(s)+A2(n.Ae);return S1(s)&&S1(n.Ae)?hk(i):rm(n.serializer,i)}(e,t)}function Q_(e,t,r){return e instanceof Dc?pk(e,t):e instanceof Oc?mk(e,t):r}function dk(e,t){return e instanceof lh?function(r){return S1(r)||function(n){return!!n&&"doubleValue"in n}(r)}(t)?t:{integerValue:0}:null}class oh extends Yh{}class Dc extends Yh{constructor(t){super(),this.elements=t}}function pk(e,t){const r=gk(t);for(const n of e.elements)r.some(a=>ya(a,n))||r.push(n);return{arrayValue:{values:r}}}class Oc extends Yh{constructor(t){super(),this.elements=t}}function mk(e,t){let r=gk(t);for(const n of e.elements)r=r.filter(a=>!ya(a,n));return{arrayValue:{values:r}}}class lh extends Yh{constructor(t,r){super(),this.serializer=t,this.Ae=r}}function A2(e){return Ht(e.integerValue||e.doubleValue)}function gk(e){return Z0(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function J_(e,t){return e.field.isEqual(t.field)&&function(r,n){return r instanceof Dc&&n instanceof Dc||r instanceof Oc&&n instanceof Oc?zo(r.elements,n.elements,ya):r instanceof lh&&n instanceof lh?ya(r.Ae,n.Ae):r instanceof oh&&n instanceof oh}(e.transform,t.transform)}class Z_{constructor(t,r){this.version=t,this.transformResults=r}}class Pa{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Pa}static exists(t){return new Pa(void 0,t)}static updateTime(t){return new Pa(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function xf(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Qh{}function vk(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new yk(e.key,Pa.none()):new nu(e.key,e.data,Pa.none());{const r=e.data,n=Dn.empty();let a=new ir(kr.comparator);for(let s of t.fields)if(!a.has(s)){let i=r.field(s);i===null&&s.length>1&&(s=s.popLast(),i=r.field(s)),i===null?n.delete(s):n.set(s,i),a=a.add(s)}return new Pi(e.key,n,new qn(a.toArray()),Pa.none())}}function eC(e,t,r){e instanceof nu?function(n,a,s){const i=n.value.clone(),o=I2(n.fieldTransforms,a,s.transformResults);i.setAll(o),a.convertToFoundDocument(s.version,i).setHasCommittedMutations()}(e,t,r):e instanceof Pi?function(n,a,s){if(!xf(n.precondition,a))return void a.convertToUnknownDocument(s.version);const i=I2(n.fieldTransforms,a,s.transformResults),o=a.data;o.setAll(bk(n)),o.setAll(i),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(e,t,r):function(n,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,t,r)}function Zl(e,t,r,n){return e instanceof nu?function(a,s,i,o){if(!xf(a.precondition,s))return i;const l=a.value.clone(),c=R2(a.fieldTransforms,o,s);return l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(e,t,r,n):e instanceof Pi?function(a,s,i,o){if(!xf(a.precondition,s))return i;const l=R2(a.fieldTransforms,o,s),c=s.data;return c.setAll(bk(a)),c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),i===null?null:i.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(f=>f.field))}(e,t,r,n):function(a,s,i){return xf(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):i}(e,t,r)}function tC(e,t){let r=null;for(const n of e.fieldTransforms){const a=t.data.field(n.field),s=dk(n.transform,a||null);s!=null&&(r===null&&(r=Dn.empty()),r.set(n.field,s))}return r||null}function N2(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,n){return r===void 0&&n===void 0||!(!r||!n)&&zo(r,n,(a,s)=>J_(a,s))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class nu extends Qh{constructor(t,r,n,a=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Pi extends Qh{constructor(t,r,n,a,s=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function bk(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function I2(e,t,r){const n=new Map;lt(e.length===r.length,32656,{Re:r.length,Ve:e.length});for(let a=0;a<r.length;a++){const s=e[a],i=s.transform,o=t.data.field(s.field);n.set(s.field,Q_(i,o,r[a]))}return n}function R2(e,t,r){const n=new Map;for(const a of e){const s=a.transform,i=r.data.field(a.field);n.set(a.field,Y_(s,i,t))}return n}class yk extends Qh{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rC extends Qh{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class nC{constructor(t,r,n,a){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(t.key)&&eC(s,t,n[a])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Zl(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Zl(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=fk();return this.mutations.forEach(a=>{const s=t.get(a.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=r.has(a.key)?null:o;const l=vk(i,o);l!==null&&n.set(a.key,l),i.isValidDocument()||i.convertToNoDocument(Fe.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Ye())}isEqual(t){return this.batchId===t.batchId&&zo(this.mutations,t.mutations,(r,n)=>N2(r,n))&&zo(this.baseMutations,t.baseMutations,(r,n)=>N2(r,n))}}class nm{constructor(t,r,n,a){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(t,r,n){lt(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let a=function(){return $_}();const s=t.mutations;for(let i=0;i<s.length;i++)a=a.insert(s[i].key,n[i].version);return new nm(t,r,n,a)}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class aC{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sC{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Kt,Ze;function iC(e){switch(e){case oe.OK:return Pe(64938);case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0;default:return Pe(15467,{code:e})}}function wk(e){if(e===void 0)return Ba("GRPC error has no .code"),oe.UNKNOWN;switch(e){case Kt.OK:return oe.OK;case Kt.CANCELLED:return oe.CANCELLED;case Kt.UNKNOWN:return oe.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return oe.INTERNAL;case Kt.UNAVAILABLE:return oe.UNAVAILABLE;case Kt.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case Kt.NOT_FOUND:return oe.NOT_FOUND;case Kt.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case Kt.ABORTED:return oe.ABORTED;case Kt.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case Kt.DATA_LOSS:return oe.DATA_LOSS;default:return Pe(39323,{code:e})}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function oC(){return new TextEncoder}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const lC=new As([4294967295,4294967295],0);function D2(e){const t=oC().encode(e),r=new F4;return r.update(t),new Uint8Array(r.digest())}function O2(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),a=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new As([r,n],0),new As([a,s],0)]}class am{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ll(`Invalid padding: ${r}`);if(n<0)throw new Ll(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Ll(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new Ll(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*t.length-r,this.pe=As.fromNumber(this.ge)}ye(t,r,n){let a=t.add(r.multiply(As.fromNumber(n)));return a.compare(lC)===1&&(a=new As([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const r=D2(t),[n,a]=O2(r);for(let s=0;s<this.hashCount;s++){const i=this.ye(n,a,s);if(!this.we(i))return!1}return!0}static create(t,r,n){const a=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),i=new am(s,a,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.ge===0)return;const r=D2(t),[n,a]=O2(r);for(let s=0;s<this.hashCount;s++){const i=this.ye(n,a,s);this.Se(i)}}Se(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class Ll extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Jh{constructor(t,r,n,a,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const a=new Map;return a.set(t,au.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new Jh(Fe.min(),a,new Pt(Xe),Wa(),Ye())}}class au{constructor(t,r,n,a,s){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new au(n,r,Ye(),Ye(),Ye())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _f{constructor(t,r,n,a){this.be=t,this.removedTargetIds=r,this.key=n,this.De=a}}class kk{constructor(t,r){this.targetId=t,this.Ce=r}}class Tk{constructor(t,r,n=xr.EMPTY_BYTE_STRING,a=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=a}}class P2{constructor(){this.ve=0,this.Fe=L2(),this.Me=xr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Ye(),r=Ye(),n=Ye();return this.Fe.forEach((a,s)=>{switch(s){case 0:t=t.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:Pe(38017,{changeType:s})}}),new au(this.Me,this.xe,t,r,n)}qe(){this.Oe=!1,this.Fe=L2()}Qe(t,r){this.Oe=!0,this.Fe=this.Fe.insert(t,r)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class cC{constructor(t){this.Ge=t,this.ze=new Map,this.je=Wa(),this.Je=Ku(),this.He=Ku(),this.Ye=new Pt(Xe)}Ze(t){for(const r of t.be)t.De&&t.De.isFoundDocument()?this.Xe(r,t.De):this.et(r,t.key,t.De);for(const r of t.removedTargetIds)this.et(r,t.key,t.De)}tt(t){this.forEachTarget(t,r=>{const n=this.nt(r);switch(t.state){case 0:this.rt(r)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(t.resumeToken));break;default:Pe(56790,{state:t.state})}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ze.forEach((n,a)=>{this.rt(a)&&r(a)})}st(t){const r=t.targetId,n=t.Ce.count,a=this.ot(r);if(a){const s=a.target;if(_1(s))if(n===0){const i=new De(s.path);this.et(r,i,Lr.newNoDocument(i,Fe.min()))}else lt(n===1,20013,{expectedCount:n});else{const i=this._t(r);if(i!==n){const o=this.ut(t),l=o?this.ct(o,t,i):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(t){const r=t.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let i,o;try{i=Ls(n).toUint8Array()}catch(l){if(l instanceof q4)return jo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new am(i,a,s)}catch(l){return jo(l instanceof Ll?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(t,r,n){return r.Ce.count===n-this.Pt(t,r.targetId)?0:2}Pt(t,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const i=this.Ge.ht(),o=`projects/${i.projectId}/databases/${i.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.et(r,s,null),a++)}),a}Tt(t){const r=new Map;this.ze.forEach((s,i)=>{const o=this.ot(i);if(o){if(s.current&&_1(o.target)){const l=new De(o.target.path);this.It(l).has(i)||this.Et(i,l)||this.et(i,l,Lr.newNoDocument(l,t))}s.Be&&(r.set(i,s.ke()),s.qe())}});let n=Ye();this.He.forEach((s,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.je.forEach((s,i)=>i.setReadTime(t));const a=new Jh(t,r,this.Ye,this.je,n);return this.je=Wa(),this.Je=Ku(),this.He=Ku(),this.Ye=new Pt(Xe),a}Xe(t,r){if(!this.rt(t))return;const n=this.Et(t,r.key)?2:0;this.nt(t).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(t)),this.He=this.He.insert(r.key,this.dt(r.key).add(t))}et(t,r,n){if(!this.rt(t))return;const a=this.nt(t);this.Et(t,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(t)),this.He=this.He.insert(r,this.dt(r).add(t)),n&&(this.je=this.je.insert(r,n))}removeTarget(t){this.ze.delete(t)}_t(t){const r=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let r=this.ze.get(t);return r||(r=new P2,this.ze.set(t,r)),r}dt(t){let r=this.He.get(t);return r||(r=new ir(Xe),this.He=this.He.insert(t,r)),r}It(t){let r=this.Je.get(t);return r||(r=new ir(Xe),this.Je=this.Je.insert(t,r)),r}rt(t){const r=this.ot(t)!==null;return r||_e("WatchChangeAggregator","Detected inactive target",t),r}ot(t){const r=this.ze.get(t);return r&&r.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new P2),this.Ge.getRemoteKeysForTarget(t).forEach(r=>{this.et(t,r,null)})}Et(t,r){return this.Ge.getRemoteKeysForTarget(t).has(r)}}function Ku(){return new Pt(De.comparator)}function L2(){return new Pt(De.comparator)}const uC={asc:"ASCENDING",desc:"DESCENDING"},fC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hC={and:"AND",or:"OR"};class dC{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function A1(e,t){return e.useProto3Json||Hh(t)?t:{value:t}}function ch(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ek(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function pC(e,t){return ch(e,t.toTimestamp())}function ma(e){return lt(!!e,49232),Fe.fromTimestamp(function(t){const r=Ps(t);return new St(r.seconds,r.nanos)}(e))}function sm(e,t){return N1(e,t).canonicalString()}function N1(e,t){const r=function(n){return new It(["projects",n.projectId,"databases",n.database])}(e).child("documents");return t===void 0?r:r.child(t)}function Sk(e){const t=It.fromString(e);return lt(Nk(t),10190,{key:t.toString()}),t}function I1(e,t){return sm(e.databaseId,t.path)}function ap(e,t){const r=Sk(t);if(r.get(1)!==e.databaseId.projectId)throw new Ne(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Ne(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new De(_k(r))}function xk(e,t){return sm(e.databaseId,t)}function mC(e){const t=Sk(e);return t.length===4?It.emptyPath():_k(t)}function R1(e){return new It(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function _k(e){return lt(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function F2(e,t,r){return{name:I1(e,t),fields:r.value.mapValue.fields}}function gC(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Pe(39313,{state:l})}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],s=function(l,c){return l.useProto3Json?(lt(c===void 0||typeof c=="string",58123),xr.fromBase64String(c||"")):(lt(c===void 0||c instanceof Buffer||c instanceof Uint8Array,16193),xr.fromUint8Array(c||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(l){const c=l.code===void 0?oe.UNKNOWN:wk(l.code);return new Ne(c,l.message||"")}(i);r=new Tk(n,a,s,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const a=ap(e,n.document.name),s=ma(n.document.updateTime),i=n.document.createTime?ma(n.document.createTime):Fe.min(),o=new Dn({mapValue:{fields:n.document.fields}}),l=Lr.newFoundDocument(a,s,i,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new _f(c,f,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const a=ap(e,n.document),s=n.readTime?ma(n.readTime):Fe.min(),i=Lr.newNoDocument(a,s),o=n.removedTargetIds||[];r=new _f([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const a=ap(e,n.document),s=n.removedTargetIds||[];r=new _f([],s,a,null)}else{if(!("filter"in t))return Pe(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,i=new sC(a,s),o=n.targetId;r=new kk(o,i)}}return r}function vC(e,t){let r;if(t instanceof nu)r={update:F2(e,t.key,t.value)};else if(t instanceof yk)r={delete:I1(e,t.key)};else if(t instanceof Pi)r={update:F2(e,t.key,t.data),updateMask:_C(t.fieldMask)};else{if(!(t instanceof rC))return Pe(16599,{Vt:t.type});r={verify:I1(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,s){const i=s.transform;if(i instanceof oh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(i instanceof Dc)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:i.elements}};if(i instanceof Oc)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:i.elements}};if(i instanceof lh)return{fieldPath:s.field.canonicalString(),increment:i.Ae};throw Pe(20930,{transform:s.transform})}(0,n))),t.precondition.isNone||(r.currentDocument=function(n,a){return a.updateTime!==void 0?{updateTime:pC(n,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Pe(27497)}(e,t.precondition)),r}function bC(e,t){return e&&e.length>0?(lt(t!==void 0,14353),e.map(r=>function(n,a){let s=n.updateTime?ma(n.updateTime):ma(a);return s.isEqual(Fe.min())&&(s=ma(a)),new Z_(s,n.transformResults||[])}(r,t))):[]}function yC(e,t){return{documents:[xk(e,t.path)]}}function wC(e,t){const r={structuredQuery:{}},n=t.path;let a;t.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=xk(e,a);const s=function(l){if(l.length!==0)return Ak(wa.create(l,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(f){return{field:eo(f.field),direction:EC(f.dir)}}(c))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=A1(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{ft:r,parent:a}}function kC(e){let t=mC(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){lt(n===1,65062);const f=r.from[0];f.allDescendants?a=f.collectionId:t=t.child(f.collectionId)}let s=[];r.where&&(s=function(f){const h=Ck(f);return h instanceof wa&&nk(h)?h.getFilters():[h]}(r.where));let i=[];r.orderBy&&(i=function(f){return f.map(h=>function(d){return new ih(to(d.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,Hh(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,d=f.values||[];return new sh(d,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,d=f.values||[];return new sh(d,h)}(r.endAt)),j_(t,a,i,s,o,"F",l,c)}function TC(e,t){const r=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:n})}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function Ck(e){return e.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=to(t.unaryFilter.field);return rr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const n=to(t.unaryFilter.field);return rr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=to(t.unaryFilter.field);return rr.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=to(t.unaryFilter.field);return rr.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}}(e):e.fieldFilter!==void 0?function(t){return rr.create(to(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(t){return wa.create(t.compositeFilter.filters.map(r=>Ck(r)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}}(t.compositeFilter.op))}(e):Pe(30097,{filter:e})}function EC(e){return uC[e]}function SC(e){return fC[e]}function xC(e){return hC[e]}function eo(e){return{fieldPath:e.canonicalString()}}function to(e){return kr.fromServerFormat(e.fieldPath)}function Ak(e){return e instanceof rr?function(t){if(t.op==="=="){if(E2(t.value))return{unaryFilter:{field:eo(t.field),op:"IS_NAN"}};if(T2(t.value))return{unaryFilter:{field:eo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(E2(t.value))return{unaryFilter:{field:eo(t.field),op:"IS_NOT_NAN"}};if(T2(t.value))return{unaryFilter:{field:eo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:eo(t.field),op:SC(t.op),value:t.value}}}(e):e instanceof wa?function(t){const r=t.getFilters().map(n=>Ak(n));return r.length===1?r[0]:{compositeFilter:{op:xC(t.op),filters:r}}}(e):Pe(54877,{filter:e})}function _C(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function Nk(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ds{constructor(t,r,n,a,s=Fe.min(),i=Fe.min(),o=xr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new ds(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class CC{constructor(t){this.yt=t}}function AC(e){const t=kC({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?C1(t,t.limit,"L"):t}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class NC{constructor(){this.Cn=new IC}addToCollectionParentIndex(t,r){return this.Cn.add(r),ae.resolve()}getCollectionParents(t,r){return ae.resolve(this.Cn.getEntries(r))}addFieldIndex(t,r){return ae.resolve()}deleteFieldIndex(t,r){return ae.resolve()}deleteAllFieldIndexes(t){return ae.resolve()}createTargetIndexes(t,r){return ae.resolve()}getDocumentsMatchingTarget(t,r){return ae.resolve(null)}getIndexType(t,r){return ae.resolve(0)}getFieldIndexes(t,r){return ae.resolve([])}getNextCollectionGroupToUpdate(t){return ae.resolve(null)}getMinOffset(t,r){return ae.resolve(Os.min())}getMinOffsetFromCollectionGroup(t,r){return ae.resolve(Os.min())}updateCollectionGroup(t,r,n){return ae.resolve()}updateIndexEntries(t,r){return ae.resolve()}}class IC{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),a=this.index[r]||new ir(It.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(t){const r=t.lastSegment(),n=t.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(t){return(this.index[t]||new ir(It.comparator)).toArray()}}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const M2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ik=41943040;class Zr{static withCacheSize(t){return new Zr(t,Zr.DEFAULT_COLLECTION_PERCENTILE,Zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,r,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/Zr.DEFAULT_COLLECTION_PERCENTILE=10,Zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zr.DEFAULT=new Zr(Ik,Zr.DEFAULT_COLLECTION_PERCENTILE,Zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zr.DISABLED=new Zr(-1,0,0);/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wo{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Wo(0)}static cr(){return new Wo(-1)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const U2="LruGarbageCollector",RC=1048576;function j2([e,t],[r,n]){const a=Xe(e,r);return a===0?Xe(t,n):a}class DC{constructor(t){this.Ir=t,this.buffer=new ir(j2),this.Er=0}dr(){return++this.Er}Ar(t){const r=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();j2(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class OC{constructor(t,r,n){this.garbageCollector=t,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){_e(U2,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){tl(r)?_e(U2,"Ignoring IndexedDB error during garbage collection: ",r):await el(r)}await this.Vr(3e5)})}}class PC{constructor(t,r){this.mr=t,this.params=r}calculateTargetCount(t,r){return this.mr.gr(t).next(n=>Math.floor(r/100*n))}nthSequenceNumber(t,r){if(r===0)return ae.resolve(Wh.ce);const n=new DC(r);return this.mr.forEachTarget(t,a=>n.Ar(a.sequenceNumber)).next(()=>this.mr.pr(t,a=>n.Ar(a))).next(()=>n.maxValue)}removeTargets(t,r,n){return this.mr.removeTargets(t,r,n)}removeOrphanedDocuments(t,r){return this.mr.removeOrphanedDocuments(t,r)}collect(t,r){return this.params.cacheSizeCollectionThreshold===-1?(_e("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(M2)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(_e("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),M2):this.yr(t,r))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,r){let n,a,s,i,o,l,c;const f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(_e("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),a=this.params.maximumSequenceNumbersToCollect):a=h,i=Date.now(),this.nthSequenceNumber(t,a))).next(h=>(n=h,o=Date.now(),this.removeTargets(t,n,r))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(t,n))).next(h=>(c=Date.now(),Ji()<=et.DEBUG&&_e("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-f}ms
	Determined least recently used ${a} in `+(o-i)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-f}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:h})))}}function LC(e,t){return new PC(e,t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class FC{constructor(){this.changes=new Oi(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Lr.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ae.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class MC{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class UC{constructor(t,r,n,a){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(t,r))).next(a=>(n!==null&&Zl(n.mutation,a,qn.empty(),St.now()),a))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Ye()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Ye()){const a=ci();return this.populateOverlays(t,a,r).next(()=>this.computeViews(t,r,a,n).next(s=>{let i=Pl();return s.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=ci();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Ye()))}populateOverlays(t,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(t,a).next(s=>{s.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,a){let s=Wa();const i=Jl(),o=function(){return Jl()}();return r.forEach((l,c)=>{const f=n.get(c.key);a.has(c.key)&&(f===void 0||f.mutation instanceof Pi)?s=s.insert(c.key,c):f!==void 0?(i.set(c.key,f.mutation.getFieldMask()),Zl(f.mutation,c,f.mutation.getFieldMask(),St.now())):i.set(c.key,qn.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,f)=>i.set(c,f)),r.forEach((c,f)=>o.set(c,new MC(f,i.get(c)??null))),o))}recalculateAndSaveOverlays(t,r){const n=Jl();let a=new Pt((i,o)=>i-o),s=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||qn.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(a.get(o.batchId)||Ye()).add(l);a=a.insert(o.batchId,h)})}).next(()=>{const i=[],o=a.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=fk();f.forEach(d=>{if(!s.has(d)){const p=vk(r.get(d),n.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),i.push(this.documentOverlayCache.saveOverlays(t,c,h))}return ae.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,a){return function(s){return De.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):z_(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,a):this.getDocumentsMatchingCollectionQuery(t,r,n,a)}getNextDocuments(t,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,a).next(s=>{const i=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,a-s.size):ae.resolve(ci());let o=Ac,l=s;return i.next(c=>ae.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?ae.resolve():this.remoteDocumentCache.getEntry(t,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,Ye())).next(f=>({batchId:o,changes:uk(f)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new De(r)).next(n=>{let a=Pl();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(t,r,n,a){const s=r.collectionGroup;let i=Pl();return this.indexManager.getCollectionParents(t,s).next(o=>ae.forEach(o,l=>{const c=function(f,h){return new Gh(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,n,a).next(f=>{f.forEach((h,d)=>{i=i.insert(h,d)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,s,a))).next(i=>{s.forEach((l,c)=>{const f=c.getKey();i.get(f)===null&&(i=i.insert(f,Lr.newInvalidDocument(f)))});let o=Pl();return i.forEach((l,c)=>{const f=s.get(l);f!==void 0&&Zl(f.mutation,c,qn.empty(),St.now()),Xh(r,c)&&(o=o.insert(l,c))}),o})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class jC{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,r){return ae.resolve(this.Lr.get(r))}saveBundleMetadata(t,r){return this.Lr.set(r.id,function(n){return{id:n.id,version:n.version,createTime:ma(n.createTime)}}(r)),ae.resolve()}getNamedQuery(t,r){return ae.resolve(this.kr.get(r))}saveNamedQuery(t,r){return this.kr.set(r.name,function(n){return{name:n.name,query:AC(n.bundledQuery),readTime:ma(n.readTime)}}(r)),ae.resolve()}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zC{constructor(){this.overlays=new Pt(De.comparator),this.qr=new Map}getOverlay(t,r){return ae.resolve(this.overlays.get(r))}getOverlays(t,r){const n=ci();return ae.forEach(r,a=>this.getOverlay(t,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((a,s)=>{this.St(t,r,s)}),ae.resolve()}removeOverlaysForBatchId(t,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(n)),ae.resolve()}getOverlaysForCollection(t,r,n){const a=ci(),s=r.length+1,i=new De(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&a.set(l.getKey(),l)}return ae.resolve(a)}getOverlaysForCollectionGroup(t,r,n,a){let s=new Pt((c,f)=>c-f);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=s.get(c.largestBatchId);f===null&&(f=ci(),s=s.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=ci(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=a)););return ae.resolve(o)}St(t,r,n){const a=this.overlays.get(n.key);if(a!==null){const i=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new aC(r,n));let s=this.qr.get(r);s===void 0&&(s=Ye(),this.qr.set(r,s)),this.qr.set(r,s.add(n.key))}}/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class VC{constructor(){this.sessionToken=xr.EMPTY_BYTE_STRING}getSessionToken(t){return ae.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,ae.resolve()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class im{constructor(){this.Qr=new ir(ur.$r),this.Ur=new ir(ur.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,r){const n=new ur(t,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Gr(new ur(t,r))}zr(t,r){t.forEach(n=>this.removeReference(n,r))}jr(t){const r=new De(new It([])),n=new ur(r,t),a=new ur(r,t+1),s=[];return this.Ur.forEachInRange([n,a],i=>{this.Gr(i),s.push(i.key)}),s}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const r=new De(new It([])),n=new ur(r,t),a=new ur(r,t+1);let s=Ye();return this.Ur.forEachInRange([n,a],i=>{s=s.add(i.key)}),s}containsKey(t){const r=new ur(t,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class ur{constructor(t,r){this.key=t,this.Yr=r}static $r(t,r){return De.comparator(t.key,r.key)||Xe(t.Yr,r.Yr)}static Kr(t,r){return Xe(t.Yr,r.Yr)||De.comparator(t.key,r.key)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class BC{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ir(ur.$r)}checkEmpty(t){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,a){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new nC(s,r,n,a);this.mutationQueue.push(i);for(const o of a)this.Zr=this.Zr.add(new ur(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ae.resolve(i)}lookupMutationBatch(t,r){return ae.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,a=this.ei(n),s=a<0?0:a;return ae.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?Q0:this.tr-1)}getAllMutationBatches(t){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new ur(r,0),a=new ur(r,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,a],i=>{const o=this.Xr(i.Yr);s.push(o)}),ae.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new ir(Xe);return r.forEach(a=>{const s=new ur(a,0),i=new ur(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,i],o=>{n=n.add(o.Yr)})}),ae.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,a=n.length+1;let s=n;De.isDocumentKey(s)||(s=s.child(""));const i=new ur(new De(s),0);let o=new ir(Xe);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===a&&(o=o.add(l.Yr)),!0)},i),ae.resolve(this.ti(o))}ti(t){const r=[];return t.forEach(n=>{const a=this.Xr(n);a!==null&&r.push(a)}),r}removeMutationBatch(t,r){lt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ae.forEach(r.mutations,a=>{const s=new ur(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,a.key)}).next(()=>{this.Zr=n})}ir(t){}containsKey(t,r){const n=new ur(r,0),a=this.Zr.firstAfterOrEqual(n);return ae.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(t){return this.mutationQueue.length,ae.resolve()}ni(t,r){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const r=this.ei(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class WC{constructor(t){this.ri=t,this.docs=function(){return new Pt(De.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,i=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return ae.resolve(n?n.document.mutableCopy():Lr.newInvalidDocument(r))}getEntries(t,r){let n=Wa();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Lr.newInvalidDocument(a))}),ae.resolve(n)}getDocumentsMatchingQuery(t,r,n,a){let s=Wa();const i=r.path,o=new De(i.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||v_(g_(f),n)<=0||(a.has(f.key)||Xh(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ae.resolve(s)}getAllFromCollectionGroup(t,r,n,a){Pe(9500)}ii(t,r){return ae.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new HC(this)}getSize(t){return ae.resolve(this.size)}}class HC extends FC{constructor(t){super(),this.Nr=t}applyChanges(t){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(t,a)):this.Nr.removeEntry(n)}),ae.waitFor(r)}getFromCache(t,r){return this.Nr.getEntry(t,r)}getAllFromCache(t,r){return this.Nr.getEntries(t,r)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $C{constructor(t){this.persistence=t,this.si=new Oi(r=>em(r),tm),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this.oi=0,this._i=new im,this.targetCount=0,this.ai=Wo.ur()}forEachTarget(t,r){return this.si.forEach((n,a)=>r(a)),ae.resolve()}getLastRemoteSnapshotVersion(t){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ae.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),ae.resolve()}Pr(t){this.si.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.ai=new Wo(r),this.highestTargetId=r),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,r){return this.Pr(r),this.targetCount+=1,ae.resolve()}updateTargetData(t,r){return this.Pr(r),ae.resolve()}removeTargetData(t,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,ae.resolve()}removeTargets(t,r,n){let a=0;const s=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(i),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),a++)}),ae.waitFor(s).next(()=>a)}getTargetCount(t){return ae.resolve(this.targetCount)}getTargetData(t,r){const n=this.si.get(r)||null;return ae.resolve(n)}addMatchingKeys(t,r,n){return this._i.Wr(r,n),ae.resolve()}removeMatchingKeys(t,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(i=>{s.push(a.markPotentiallyOrphaned(t,i))}),ae.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this._i.jr(r),ae.resolve()}getMatchingKeysForTargetId(t,r){const n=this._i.Hr(r);return ae.resolve(n)}containsKey(t,r){return ae.resolve(this._i.containsKey(r))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Rk{constructor(t,r){this.ui={},this.overlays={},this.ci=new Wh(0),this.li=!1,this.li=!0,this.hi=new VC,this.referenceDelegate=t(this),this.Pi=new $C(this),this.indexManager=new NC,this.remoteDocumentCache=function(n){return new WC(n)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new CC(r),this.Ii=new jC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new zC,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.ui[t.toKey()];return n||(n=new BC(r,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,r,n){_e("MemoryPersistence","Starting transaction:",t);const a=new GC(this.ci.next());return this.referenceDelegate.Ei(),n(a).next(s=>this.referenceDelegate.di(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Ai(t,r){return ae.or(Object.values(this.ui).map(n=>()=>n.containsKey(t,r)))}}class GC extends y_{constructor(t){super(),this.currentSequenceNumber=t}}class om{constructor(t){this.persistence=t,this.Ri=new im,this.Vi=null}static mi(t){return new om(t)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(t,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),ae.resolve()}removeReference(t,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),ae.resolve()}markPotentiallyOrphaned(t,r){return this.fi.add(r.toString()),ae.resolve()}removeTarget(t,r){this.Ri.jr(r.targetId).forEach(a=>this.fi.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(a=>{a.forEach(s=>this.fi.add(s.toString()))}).next(()=>n.removeTargetData(t,r))}Ei(){this.Vi=new Set}di(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,n=>{const a=De.fromPath(n);return this.gi(t,a).next(s=>{s||r.removeEntry(a,Fe.min())})}).next(()=>(this.Vi=null,r.apply(t)))}updateLimboDocument(t,r){return this.gi(t,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(t){return 0}gi(t,r){return ae.or([()=>ae.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Ai(t,r)])}}class uh{constructor(t,r){this.persistence=t,this.pi=new Oi(n=>T_(n.path),(n,a)=>n.isEqual(a)),this.garbageCollector=LC(this,r)}static mi(t,r){return new uh(t,r)}Ei(){}di(t){return ae.resolve()}forEachTarget(t,r){return this.persistence.getTargetCache().forEachTarget(t,r)}gr(t){const r=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(n=>r.next(a=>n+a))}wr(t){let r=0;return this.pr(t,n=>{r++}).next(()=>r)}pr(t,r){return ae.forEach(this.pi,(n,a)=>this.br(t,n,a).next(s=>s?ae.resolve():r(a)))}removeTargets(t,r,n){return this.persistence.getTargetCache().removeTargets(t,r,n)}removeOrphanedDocuments(t,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),s=a.newChangeBuffer();return a.ii(t,i=>this.br(t,i,r).next(o=>{o||(n++,s.removeEntry(i,Fe.min()))})).next(()=>s.apply(t)).next(()=>n)}markPotentiallyOrphaned(t,r){return this.pi.set(r,t.currentSequenceNumber),ae.resolve()}removeTarget(t,r){const n=r.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,r,n){return this.pi.set(n,t.currentSequenceNumber),ae.resolve()}removeReference(t,r,n){return this.pi.set(n,t.currentSequenceNumber),ae.resolve()}updateLimboDocument(t,r){return this.pi.set(r,t.currentSequenceNumber),ae.resolve()}Ti(t){let r=t.key.toString().length;return t.isFoundDocument()&&(r+=Ef(t.data.value)),r}br(t,r,n){return ae.or([()=>this.persistence.Ai(t,r),()=>this.persistence.getTargetCache().containsKey(t,r),()=>{const a=this.pi.get(r);return ae.resolve(a!==void 0&&a>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class lm{constructor(t,r,n,a){this.targetId=t,this.fromCache=r,this.Es=n,this.ds=a}static As(t,r){let n=Ye(),a=Ye();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new lm(t,r.fromCache,n,a)}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class KC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return M5()?8:w_(L5())>0?6:4}()}initialize(t,r){this.ps=t,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(t,r,n,a){const s={result:null};return this.ys(t,r).next(i=>{s.result=i}).next(()=>{if(!s.result)return this.ws(t,r,a,n).next(i=>{s.result=i})}).next(()=>{if(s.result)return;const i=new qC;return this.Ss(t,r,i).next(o=>{if(s.result=o,this.Vs)return this.bs(t,r,i,o.size)})}).next(()=>s.result)}bs(t,r,n,a){return n.documentReadCount<this.fs?(Ji()<=et.DEBUG&&_e("QueryEngine","SDK will not create cache indexes for query:",Zi(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(Ji()<=et.DEBUG&&_e("QueryEngine","Query:",Zi(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(Ji()<=et.DEBUG&&_e("QueryEngine","The SDK decides to create cache indexes for query:",Zi(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,pa(r))):ae.resolve())}ys(t,r){if(C2(r))return ae.resolve(null);let n=pa(r);return this.indexManager.getIndexType(t,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=C1(r,null,"F"),n=pa(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(s=>{const i=Ye(...s);return this.ps.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,i,l.readTime)?this.ys(t,C1(r,null,"F")):this.vs(t,c,r,l)}))})))}ws(t,r,n,a){return C2(r)||a.isEqual(Fe.min())?ae.resolve(null):this.ps.getDocuments(t,n).next(s=>{const i=this.Ds(r,s);return this.Cs(r,i,n,a)?ae.resolve(null):(Ji()<=et.DEBUG&&_e("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Zi(r)),this.vs(t,i,r,m_(a,Ac)).next(o=>o))})}Ds(t,r){let n=new ir(lk(t));return r.forEach((a,s)=>{Xh(t,s)&&(n=n.add(s))}),n}Cs(t,r,n,a){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Ss(t,r,n){return Ji()<=et.DEBUG&&_e("QueryEngine","Using full collection scan to execute query:",Zi(r)),this.ps.getDocumentsMatchingQuery(t,r,Os.min(),n)}vs(t,r,n,a){return this.ps.getDocumentsMatchingQuery(t,n,a).next(s=>(r.forEach(i=>{s=s.insert(i.key,i)}),s))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const cm="LocalStore",XC=3e8;class YC{constructor(t,r,n,a){this.persistence=t,this.Fs=r,this.serializer=a,this.Ms=new Pt(Xe),this.xs=new Oi(s=>em(s),tm),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new UC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.Ms))}}function QC(e,t,r,n){return new YC(e,t,r,n)}async function Dk(e,t){const r=Me(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.Bs(t),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const i=[],o=[];let l=Ye();for(const c of a){i.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of s){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:i,addedBatchIds:o}))})})}function JC(e,t){const r=Me(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=t.batch.keys(),s=r.Ns.newChangeBuffer({trackRemovals:!0});return function(i,o,l,c){const f=l.batch,h=f.keys();let d=ae.resolve();return h.forEach(p=>{d=d.next(()=>c.getEntry(o,p)).next(g=>{const m=l.docVersions.get(p);lt(m!==null,48541),g.version.compareTo(m)<0&&(f.applyToRemoteDocument(g,l),g.isValidDocument()&&(g.setReadTime(l.commitVersion),c.addEntry(g)))})}),d.next(()=>i.mutationQueue.removeMutationBatch(o,f))}(r,n,t,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(i){let o=Ye();for(let l=0;l<i.mutationResults.length;++l)i.mutationResults[l].transformResults.length>0&&(o=o.add(i.batch.mutations[l].key));return o}(t))).next(()=>r.localDocuments.getDocuments(n,a))})}function Ok(e){const t=Me(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Pi.getLastRemoteSnapshotVersion(r))}function ZC(e,t){const r=Me(e),n=t.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const i=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const o=[];t.targetChanges.forEach((f,h)=>{const d=a.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(s,f.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(h)!==null?p=p.withResumeToken(xr.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),a=a.insert(h,p),function(g,m,y){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=XC?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,p,f)&&o.push(r.Pi.updateTargetData(s,p))});let l=Wa(),c=Ye();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(eA(s,i,t.documentUpdates).next(f=>{l=f.ks,c=f.qs})),!n.isEqual(Fe.min())){const f=r.Pi.getLastRemoteSnapshotVersion(s).next(h=>r.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return ae.waitFor(o).next(()=>i.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.Ms=a,s))}function eA(e,t,r){let n=Ye(),a=Ye();return r.forEach(s=>n=n.add(s)),t.getEntries(e,n).next(s=>{let i=Wa();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(a=a.add(o)),l.isNoDocument()&&l.version.isEqual(Fe.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):_e(cm,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:i,qs:a}})}function tA(e,t){const r=Me(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=Q0),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function rA(e,t){const r=Me(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Pi.getTargetData(n,t).next(s=>s?(a=s,ae.resolve(a)):r.Pi.allocateTargetId(n).next(i=>(a=new ds(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(t,n.targetId)),n})}async function D1(e,t,r){const n=Me(e),a=n.Ms.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,i=>n.persistence.referenceDelegate.removeTarget(i,a))}catch(i){if(!tl(i))throw i;_e(cm,`Failed to update sequence numbers for target ${t}: ${i}`)}n.Ms=n.Ms.remove(t),n.xs.delete(a.target)}function z2(e,t,r){const n=Me(e);let a=Fe.min(),s=Ye();return n.persistence.runTransaction("Execute query","readwrite",i=>function(o,l,c){const f=Me(o),h=f.xs.get(c);return h!==void 0?ae.resolve(f.Ms.get(h)):f.Pi.getTargetData(l,c)}(n,i,pa(t)).next(o=>{if(o)return a=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(i,o.targetId).next(l=>{s=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(i,t,r?a:Fe.min(),r?s:Ye())).next(o=>(nA(n,B_(t),o),{documents:o,Qs:s})))}function nA(e,t,r){let n=e.Os.get(t)||Fe.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),e.Os.set(t,n)}class V2{constructor(){this.activeTargetIds=K_()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class aA{constructor(){this.Mo=new V2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,r,n){this.xo[t]=r}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new V2,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sA{Oo(t){}shutdown(){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const B2="ConnectivityMonitor";class W2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){_e(B2,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){_e(B2,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Xu=null;function O1(){return Xu===null?Xu=function(){return 268435456+Math.round(2147483648*Math.random())}():Xu++,"0x"+Xu.toString(16)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const sp="RestConnection",iA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oA{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+t.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===nh?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(t,r,n,a,s){const i=O1(),o=this.zo(t,r.toUriEncodedString());_e(sp,`Sending RPC '${t}' ${i}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,a,s);const{host:c}=new URL(o),f=G0(c);return this.Jo(t,o,l,n,f).then(h=>(_e(sp,`Received RPC '${t}' ${i}: `,h),h),h=>{throw jo(sp,`RPC '${t}' ${i} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(t,r,n,a,s,i){return this.Go(t,r,n,a,s)}jo(t,r,n){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,s)=>t[s]=a),n&&n.headers.forEach((a,s)=>t[s]=a)}zo(t,r){const n=iA[t];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class lA{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Nr="WebChannelConnection";class cA extends oA{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,r,n,a,s){const i=O1();return new Promise((o,l)=>{const c=new M4;c.setWithCredentials(!0),c.listenOnce(U4.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Tf.NO_ERROR:const h=c.getResponseJson();_e(Nr,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(h)),o(h);break;case Tf.TIMEOUT:_e(Nr,`RPC '${t}' ${i} timed out`),l(new Ne(oe.DEADLINE_EXCEEDED,"Request time out"));break;case Tf.HTTP_ERROR:const d=c.getStatus();if(_e(Nr,`RPC '${t}' ${i} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const m=function(y){const k=y.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(k)>=0?k:oe.UNKNOWN}(g.status);l(new Ne(m,g.message))}else l(new Ne(oe.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ne(oe.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:t,streamId:i,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{_e(Nr,`RPC '${t}' ${i} completed.`)}});const f=JSON.stringify(a);_e(Nr,`RPC '${t}' ${i} sending request:`,a),c.send(r,"POST",f,n,15)})}T_(t,r,n){const a=O1(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=V4(),o=z4(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");_e(Nr,`Creating RPC '${t}' stream ${a}: ${f}`,l);const h=i.createWebChannel(f,l);this.I_(h);let d=!1,p=!1;const g=new lA({Yo:y=>{p?_e(Nr,`Not sending because RPC '${t}' stream ${a} is closed:`,y):(d||(_e(Nr,`Opening RPC '${t}' stream ${a} transport.`),h.open(),d=!0),_e(Nr,`RPC '${t}' stream ${a} sending:`,y),h.send(y))},Zo:()=>h.close()}),m=(y,k,b)=>{y.listen(k,w=>{try{b(w)}catch(N){setTimeout(()=>{throw N},0)}})};return m(h,Ol.EventType.OPEN,()=>{p||(_e(Nr,`RPC '${t}' stream ${a} transport opened.`),g.o_())}),m(h,Ol.EventType.CLOSE,()=>{p||(p=!0,_e(Nr,`RPC '${t}' stream ${a} transport closed`),g.a_(),this.E_(h))}),m(h,Ol.EventType.ERROR,y=>{p||(p=!0,jo(Nr,`RPC '${t}' stream ${a} transport errored. Name:`,y.name,"Message:",y.message),g.a_(new Ne(oe.UNAVAILABLE,"The operation could not be completed")))}),m(h,Ol.EventType.MESSAGE,y=>{var k;if(!p){const b=y.data[0];lt(!!b,16349);const w=b,N=(w==null?void 0:w.error)||((k=w[0])==null?void 0:k.error);if(N){_e(Nr,`RPC '${t}' stream ${a} received error:`,N);const _=N.status;let F=function(S){const x=Kt[S];if(x!==void 0)return wk(x)}(_),T=N.message;F===void 0&&(F=oe.INTERNAL,T="Unknown error status: "+_+" with message "+N.message),p=!0,g.a_(new Ne(F,T)),h.close()}else _e(Nr,`RPC '${t}' stream ${a} received:`,b),g.u_(b)}}),m(o,j4.STAT_EVENT,y=>{y.stat===k1.PROXY?_e(Nr,`RPC '${t}' stream ${a} detected buffering proxy`):y.stat===k1.NOPROXY&&_e(Nr,`RPC '${t}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(r=>r===t)}}function ip(){return typeof document<"u"?document:null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Zh(e){return new dC(e,!0)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Pk{constructor(t,r,n=1e3,a=1.5,s=6e4){this.Mi=t,this.timerId=r,this.d_=n,this.A_=a,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&_e("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const H2="PersistentStream";class Lk{constructor(t,r,n,a,s,i,o,l){this.Mi=t,this.S_=n,this.b_=a,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Pk(t,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():r&&r.code===oe.RESOURCE_EXHAUSTED?(Ba(r.toString()),Ba("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(r)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.D_===r&&this.G_(n,a)},n=>{t(()=>{const a=new Ne(oe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)})})}G_(t,r){const n=this.W_(this.D_);this.stream=this.j_(t,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(a=>{n(()=>this.z_(a))}),this.stream.onMessage(a=>{n(()=>++this.F_==1?this.J_(a):this.onNext(a))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return _e(H2,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return r=>{this.Mi.enqueueAndForget(()=>this.D_===t?r():(_e(H2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class uA extends Lk{constructor(t,r,n,a,s,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,i),this.serializer=s}j_(t,r){return this.connection.T_("Listen",t,r)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const r=gC(this.serializer,t),n=function(a){if(!("targetChange"in a))return Fe.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?Fe.min():s.readTime?ma(s.readTime):Fe.min()}(t);return this.listener.H_(r,n)}Y_(t){const r={};r.database=R1(this.serializer),r.addTarget=function(a,s){let i;const o=s.target;if(i=_1(o)?{documents:yC(a,o)}:{query:wC(a,o).ft},i.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){i.resumeToken=Ek(a,s.resumeToken);const l=A1(a,s.expectedCount);l!==null&&(i.expectedCount=l)}else if(s.snapshotVersion.compareTo(Fe.min())>0){i.readTime=ch(a,s.snapshotVersion.toTimestamp());const l=A1(a,s.expectedCount);l!==null&&(i.expectedCount=l)}return i}(this.serializer,t);const n=TC(this.serializer,t);n&&(r.labels=n),this.q_(r)}Z_(t){const r={};r.database=R1(this.serializer),r.removeTarget=t,this.q_(r)}}class fA extends Lk{constructor(t,r,n,a,s,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,i),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,r){return this.connection.T_("Write",t,r)}J_(t){return lt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,lt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){lt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const r=bC(t.writeResults,t.commitTime),n=ma(t.commitTime);return this.listener.na(n,r)}ra(){const t={};t.database=R1(this.serializer),this.q_(t)}ea(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>vC(this.serializer,n))};this.q_(r)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hA{}class dA extends hA{constructor(t,r,n,a){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Ne(oe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Go(t,N1(r,n),a,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ne(oe.UNKNOWN,s.toString())})}Ho(t,r,n,a,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(t,N1(r,n),a,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ne(oe.UNKNOWN,i.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class pA{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ba(r),this.aa=!1):_e("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ti="RemoteStore";class mA{constructor(t,r,n,a,s){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(i=>{n.enqueueAndForget(async()=>{Li(this)&&(_e(Ti,"Restarting streams for network reachability change."),await async function(o){const l=Me(o);l.Ea.add(4),await su(l),l.Ra.set("Unknown"),l.Ea.delete(4),await ed(l)}(this))})}),this.Ra=new pA(n,a)}}async function ed(e){if(Li(e))for(const t of e.da)await t(!0)}async function su(e){for(const t of e.da)await t(!1)}function Fk(e,t){const r=Me(e);r.Ia.has(t.targetId)||(r.Ia.set(t.targetId,t),dm(r)?hm(r):rl(r).O_()&&fm(r,t))}function um(e,t){const r=Me(e),n=rl(r);r.Ia.delete(t),n.O_()&&Mk(r,t),r.Ia.size===0&&(n.O_()?n.L_():Li(r)&&r.Ra.set("Unknown"))}function fm(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Fe.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}rl(e).Y_(t)}function Mk(e,t){e.Va.Ue(t),rl(e).Z_(t)}function hm(e){e.Va=new cC({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),rl(e).start(),e.Ra.ua()}function dm(e){return Li(e)&&!rl(e).x_()&&e.Ia.size>0}function Li(e){return Me(e).Ea.size===0}function Uk(e){e.Va=void 0}async function gA(e){e.Ra.set("Online")}async function vA(e){e.Ia.forEach((t,r)=>{fm(e,t)})}async function bA(e,t){Uk(e),dm(e)?(e.Ra.ha(t),hm(e)):e.Ra.set("Unknown")}async function yA(e,t,r){if(e.Ra.set("Online"),t instanceof Tk&&t.state===2&&t.cause)try{await async function(n,a){const s=a.cause;for(const i of a.targetIds)n.Ia.has(i)&&(await n.remoteSyncer.rejectListen(i,s),n.Ia.delete(i),n.Va.removeTarget(i))}(e,t)}catch(n){_e(Ti,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await fh(e,n)}else if(t instanceof _f?e.Va.Ze(t):t instanceof kk?e.Va.st(t):e.Va.tt(t),!r.isEqual(Fe.min()))try{const n=await Ok(e.localStore);r.compareTo(n)>=0&&await function(a,s){const i=a.Va.Tt(s);return i.targetChanges.forEach((o,l)=>{if(o.resumeToken.approximateByteSize()>0){const c=a.Ia.get(l);c&&a.Ia.set(l,c.withResumeToken(o.resumeToken,s))}}),i.targetMismatches.forEach((o,l)=>{const c=a.Ia.get(o);if(!c)return;a.Ia.set(o,c.withResumeToken(xr.EMPTY_BYTE_STRING,c.snapshotVersion)),Mk(a,o);const f=new ds(c.target,o,l,c.sequenceNumber);fm(a,f)}),a.remoteSyncer.applyRemoteEvent(i)}(e,r)}catch(n){_e(Ti,"Failed to raise snapshot:",n),await fh(e,n)}}async function fh(e,t,r){if(!tl(t))throw t;e.Ea.add(1),await su(e),e.Ra.set("Offline"),r||(r=()=>Ok(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{_e(Ti,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await ed(e)})}function jk(e,t){return t().catch(r=>fh(e,r,t))}async function td(e){const t=Me(e),r=Ms(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Q0;for(;wA(t);)try{const a=await tA(t.localStore,n);if(a===null){t.Ta.length===0&&r.L_();break}n=a.batchId,kA(t,a)}catch(a){await fh(t,a)}zk(t)&&Vk(t)}function wA(e){return Li(e)&&e.Ta.length<10}function kA(e,t){e.Ta.push(t);const r=Ms(e);r.O_()&&r.X_&&r.ea(t.mutations)}function zk(e){return Li(e)&&!Ms(e).x_()&&e.Ta.length>0}function Vk(e){Ms(e).start()}async function TA(e){Ms(e).ra()}async function EA(e){const t=Ms(e);for(const r of e.Ta)t.ea(r.mutations)}async function SA(e,t,r){const n=e.Ta.shift(),a=nm.from(n,t,r);await jk(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await td(e)}async function xA(e,t){t&&Ms(e).X_&&await async function(r,n){if(function(a){return iC(a)&&a!==oe.ABORTED}(n.code)){const a=r.Ta.shift();Ms(r).B_(),await jk(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,n)),await td(r)}}(e,t),zk(e)&&Vk(e)}async function $2(e,t){const r=Me(e);r.asyncQueue.verifyOperationInProgress(),_e(Ti,"RemoteStore received new credentials");const n=Li(r);r.Ea.add(3),await su(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.Ea.delete(3),await ed(r)}async function _A(e,t){const r=Me(e);t?(r.Ea.delete(2),await ed(r)):t||(r.Ea.add(2),await su(r),r.Ra.set("Unknown"))}function rl(e){return e.ma||(e.ma=function(t,r,n){const a=Me(t);return a.sa(),new uA(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,n)}(e.datastore,e.asyncQueue,{Xo:gA.bind(null,e),t_:vA.bind(null,e),r_:bA.bind(null,e),H_:yA.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),dm(e)?hm(e):e.Ra.set("Unknown")):(await e.ma.stop(),Uk(e))})),e.ma}function Ms(e){return e.fa||(e.fa=function(t,r,n){const a=Me(t);return a.sa(),new fA(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:TA.bind(null,e),r_:xA.bind(null,e),ta:EA.bind(null,e),na:SA.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await td(e)):(await e.fa.stop(),e.Ta.length>0&&(_e(Ti,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class pm{constructor(t,r,n,a,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new Ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,a,s){const i=Date.now()+n,o=new pm(t,r,i,a,s);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(oe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mm(e,t){if(Ba("AsyncQueue",`${t}: ${e}`),tl(e))return new Ne(oe.UNAVAILABLE,`${t}: ${e}`);throw e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class xo{static emptySet(t){return new xo(t.comparator)}constructor(t){this.comparator=t?(r,n)=>t(r,n)||De.comparator(r.key,n.key):(r,n)=>De.comparator(r.key,n.key),this.keyedMap=Pl(),this.sortedSet=new Pt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof xo)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new xo;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class G2{constructor(){this.ga=new Pt(De.comparator)}track(t){const r=t.doc.key,n=this.ga.get(r);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(r,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(r):t.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:t.doc}):Pe(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(r,t)}ya(){const t=[];return this.ga.inorderTraversal((r,n)=>{t.push(n)}),t}}class Ho{constructor(t,r,n,a,s,i,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,a,s){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new Ho(t,r,xo.emptySet(r),i,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Kh(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class CA{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class AA{constructor(){this.queries=q2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const n=Me(t),a=n.queries;n.queries=q2(),a.forEach((s,i)=>{for(const o of i.Sa)o.onError(r)})})(this,new Ne(oe.ABORTED,"Firestore shutting down"))}}function q2(){return new Oi(e=>ok(e),Kh)}async function Bk(e,t){const r=Me(e);let n=3;const a=t.query;let s=r.queries.get(a);s?!s.ba()&&t.Da()&&(n=2):(s=new CA,n=t.Da()?0:1);try{switch(n){case 0:s.wa=await r.onListen(a,!0);break;case 1:s.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(i){const o=mm(i,`Initialization of query '${Zi(t.query)}' failed`);return void t.onError(o)}r.queries.set(a,s),s.Sa.push(t),t.va(r.onlineState),s.wa&&t.Fa(s.wa)&&gm(r)}async function Wk(e,t){const r=Me(e),n=t.query;let a=3;const s=r.queries.get(n);if(s){const i=s.Sa.indexOf(t);i>=0&&(s.Sa.splice(i,1),s.Sa.length===0?a=t.Da()?0:1:!s.ba()&&t.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function NA(e,t){const r=Me(e);let n=!1;for(const a of t){const s=a.query,i=r.queries.get(s);if(i){for(const o of i.Sa)o.Fa(a)&&(n=!0);i.wa=a}}n&&gm(r)}function IA(e,t,r){const n=Me(e),a=n.queries.get(t);if(a)for(const s of a.Sa)s.onError(r);n.queries.delete(t)}function gm(e){e.Ca.forEach(t=>{t.next()})}var P1,K2;(K2=P1||(P1={})).Ma="default",K2.Cache="cache";class Hk{constructor(t,r,n){this.query=t,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const a of t.docChanges)a.type!==3&&n.push(a);t=new Ho(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),r=!0):this.La(t,this.onlineState)&&(this.ka(t),r=!0),this.Na=t,r}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),r=!0),r}La(t,r){if(!t.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(t){t=Ho.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==P1.Cache}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $k{constructor(t){this.key=t}}class Gk{constructor(t){this.key=t}}class RA{constructor(t,r){this.query=t,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ye(),this.mutatedKeys=Ye(),this.eu=lk(t),this.tu=new xo(this.eu)}get nu(){return this.Ya}ru(t,r){const n=r?r.iu:new G2,a=r?r.tu:this.tu;let s=r?r.mutatedKeys:this.mutatedKeys,i=a,o=!1;const l=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,c=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(t.inorderTraversal((f,h)=>{const d=a.get(f),p=Xh(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let y=!1;d&&p?d.data.isEqual(p.data)?g!==m&&(n.track({type:3,doc:p}),y=!0):this.su(d,p)||(n.track({type:2,doc:p}),y=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),y=!0):d&&!p&&(n.track({type:1,doc:d}),y=!0,(l||c)&&(o=!0)),y&&(p?(i=i.add(p),s=m?s.add(f):s.delete(f)):(i=i.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const f=this.query.limitType==="F"?i.last():i.first();i=i.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{tu:i,iu:n,Cs:o,mutatedKeys:s}}su(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,a){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const i=t.iu.ya();i.sort((f,h)=>function(d,p){const g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:m})}};return g(d)-g(p)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),a=a??!1;const o=r&&!a?this._u():[],l=this.Xa.size===0&&this.current&&!a?1:0,c=l!==this.Za;return this.Za=l,i.length!==0||c?{snapshot:new Ho(this.query,t.tu,s,i,t.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new G2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Ye(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return t.forEach(n=>{this.Xa.has(n)||r.push(new Gk(n))}),this.Xa.forEach(n=>{t.has(n)||r.push(new $k(n))}),r}cu(t){this.Ya=t.Qs,this.Xa=Ye();const r=this.ru(t.documents);return this.applyChanges(r,!0)}lu(){return Ho.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const vm="SyncEngine";class DA{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class OA{constructor(t){this.key=t,this.hu=!1}}class PA{constructor(t,r,n,a,s,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Oi(o=>ok(o),Kh),this.Iu=new Map,this.Eu=new Set,this.du=new Pt(De.comparator),this.Au=new Map,this.Ru=new im,this.Vu={},this.mu=new Map,this.fu=Wo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function LA(e,t,r=!0){const n=Jk(e);let a;const s=n.Tu.get(t);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.lu()):a=await qk(n,t,r,!0),a}async function FA(e,t){const r=Jk(e);await qk(r,t,!0,!1)}async function qk(e,t,r,n){const a=await rA(e.localStore,pa(t)),s=a.targetId,i=e.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await MA(e,t,s,i==="current",a.resumeToken)),e.isPrimaryClient&&r&&Fk(e.remoteStore,a),o}async function MA(e,t,r,n,a){e.pu=(h,d,p)=>async function(g,m,y,k){let b=m.view.ru(y);b.Cs&&(b=await z2(g.localStore,m.query,!1).then(({documents:F})=>m.view.ru(F,b)));const w=k&&k.targetChanges.get(m.targetId),N=k&&k.targetMismatches.get(m.targetId)!=null,_=m.view.applyChanges(b,g.isPrimaryClient,w,N);return Y2(g,m.targetId,_.au),_.snapshot}(e,h,d,p);const s=await z2(e.localStore,t,!0),i=new RA(t,s.Qs),o=i.ru(s.documents),l=au.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",a),c=i.applyChanges(o,e.isPrimaryClient,l);Y2(e,r,c.au);const f=new DA(t,r,i);return e.Tu.set(t,f),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),c.snapshot}async function UA(e,t,r){const n=Me(e),a=n.Tu.get(t),s=n.Iu.get(a.targetId);if(s.length>1)return n.Iu.set(a.targetId,s.filter(i=>!Kh(i,t))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await D1(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&um(n.remoteStore,a.targetId),L1(n,a.targetId)}).catch(el)):(L1(n,a.targetId),await D1(n.localStore,a.targetId,!0))}async function jA(e,t){const r=Me(e),n=r.Tu.get(t),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),um(r.remoteStore,n.targetId))}async function zA(e,t,r){const n=qA(e);try{const a=await function(s,i){const o=Me(s),l=St.now(),c=i.reduce((d,p)=>d.add(p.key),Ye());let f,h;return o.persistence.runTransaction("Locally write mutations","readwrite",d=>{let p=Wa(),g=Ye();return o.Ns.getEntries(d,c).next(m=>{p=m,p.forEach((y,k)=>{k.isValidDocument()||(g=g.add(y))})}).next(()=>o.localDocuments.getOverlayedDocuments(d,p)).next(m=>{f=m;const y=[];for(const k of i){const b=tC(k,f.get(k.key).overlayedDocument);b!=null&&y.push(new Pi(k.key,b,ek(b.value.mapValue),Pa.exists(!0)))}return o.mutationQueue.addMutationBatch(d,l,y,i)}).next(m=>{h=m;const y=m.applyToLocalDocumentSet(f,g);return o.documentOverlayCache.saveOverlays(d,m.batchId,y)})}).then(()=>({batchId:h.batchId,changes:uk(f)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(a.batchId),function(s,i,o){let l=s.Vu[s.currentUser.toKey()];l||(l=new Pt(Xe)),l=l.insert(i,o),s.Vu[s.currentUser.toKey()]=l}(n,a.batchId,r),await iu(n,a.changes),await td(n.remoteStore)}catch(a){const s=mm(a,"Failed to persist write");r.reject(s)}}async function Kk(e,t){const r=Me(e);try{const n=await ZC(r.localStore,t);t.targetChanges.forEach((a,s)=>{const i=r.Au.get(s);i&&(lt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?i.hu=!0:a.modifiedDocuments.size>0?lt(i.hu,14607):a.removedDocuments.size>0&&(lt(i.hu,42227),i.hu=!1))}),await iu(r,n,t)}catch(n){await el(n)}}function X2(e,t,r){const n=Me(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach((s,i)=>{const o=i.view.va(t);o.snapshot&&a.push(o.snapshot)}),function(s,i){const o=Me(s);o.onlineState=i;let l=!1;o.queries.forEach((c,f)=>{for(const h of f.Sa)h.va(i)&&(l=!0)}),l&&gm(o)}(n.eventManager,t),a.length&&n.Pu.H_(a),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function VA(e,t,r){const n=Me(e);n.sharedClientState.updateQueryState(t,"rejected",r);const a=n.Au.get(t),s=a&&a.key;if(s){let i=new Pt(De.comparator);i=i.insert(s,Lr.newNoDocument(s,Fe.min()));const o=Ye().add(s),l=new Jh(Fe.min(),new Map,new Pt(Xe),i,o);await Kk(n,l),n.du=n.du.remove(s),n.Au.delete(t),bm(n)}else await D1(n.localStore,t,!1).then(()=>L1(n,t,r)).catch(el)}async function BA(e,t){const r=Me(e),n=t.batch.batchId;try{const a=await JC(r.localStore,t);Yk(r,n,null),Xk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await iu(r,a)}catch(a){await el(a)}}async function WA(e,t,r){const n=Me(e);try{const a=await function(s,i){const o=Me(s);return o.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return o.mutationQueue.lookupMutationBatch(l,i).next(f=>(lt(f!==null,37113),c=f.keys(),o.mutationQueue.removeMutationBatch(l,f))).next(()=>o.mutationQueue.performConsistencyCheck(l)).next(()=>o.documentOverlayCache.removeOverlaysForBatchId(l,c,i)).next(()=>o.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>o.localDocuments.getDocuments(l,c))})}(n.localStore,t);Yk(n,t,r),Xk(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await iu(n,a)}catch(a){await el(a)}}function Xk(e,t){(e.mu.get(t)||[]).forEach(r=>{r.resolve()}),e.mu.delete(t)}function Yk(e,t,r){const n=Me(e);let a=n.Vu[n.currentUser.toKey()];if(a){const s=a.get(t);s&&(r?s.reject(r):s.resolve(),a=a.remove(t)),n.Vu[n.currentUser.toKey()]=a}}function L1(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Iu.get(t))e.Tu.delete(n),r&&e.Pu.yu(n,r);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(n=>{e.Ru.containsKey(n)||Qk(e,n)})}function Qk(e,t){e.Eu.delete(t.path.canonicalString());const r=e.du.get(t);r!==null&&(um(e.remoteStore,r),e.du=e.du.remove(t),e.Au.delete(r),bm(e))}function Y2(e,t,r){for(const n of r)n instanceof $k?(e.Ru.addReference(n.key,t),HA(e,n)):n instanceof Gk?(_e(vm,"Document no longer in limbo: "+n.key),e.Ru.removeReference(n.key,t),e.Ru.containsKey(n.key)||Qk(e,n.key)):Pe(19791,{wu:n})}function HA(e,t){const r=t.key,n=r.path.canonicalString();e.du.get(r)||e.Eu.has(n)||(_e(vm,"New document in limbo: "+r),e.Eu.add(n),bm(e))}function bm(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const r=new De(It.fromString(t)),n=e.fu.next();e.Au.set(n,new OA(r)),e.du=e.du.insert(r,n),Fk(e.remoteStore,new ds(pa(qh(r.path)),n,"TargetPurposeLimboResolution",Wh.ce))}}async function iu(e,t,r){const n=Me(e),a=[],s=[],i=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{i.push(n.pu(l,t,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){a.push(c);const h=lm.As(l.targetId,c);s.push(h)}}))}),await Promise.all(i),n.Pu.H_(a),await async function(o,l){const c=Me(o);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ae.forEach(l,h=>ae.forEach(h.Es,d=>c.persistence.referenceDelegate.addReference(f,h.targetId,d)).next(()=>ae.forEach(h.ds,d=>c.persistence.referenceDelegate.removeReference(f,h.targetId,d)))))}catch(f){if(!tl(f))throw f;_e(cm,"Failed to update sequence numbers: "+f)}for(const f of l){const h=f.targetId;if(!f.fromCache){const d=c.Ms.get(h),p=d.snapshotVersion,g=d.withLastLimboFreeSnapshotVersion(p);c.Ms=c.Ms.insert(h,g)}}}(n.localStore,s))}async function $A(e,t){const r=Me(e);if(!r.currentUser.isEqual(t)){_e(vm,"User change. New user:",t.toKey());const n=await Dk(r.localStore,t);r.currentUser=t,function(a,s){a.mu.forEach(i=>{i.forEach(o=>{o.reject(new Ne(oe.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await iu(r,n.Ls)}}function GA(e,t){const r=Me(e),n=r.Au.get(t);if(n&&n.hu)return Ye().add(n.key);{let a=Ye();const s=r.Iu.get(t);if(!s)return a;for(const i of s){const o=r.Tu.get(i);a=a.unionWith(o.view.nu)}return a}}function Jk(e){const t=Me(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Kk.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=GA.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=VA.bind(null,t),t.Pu.H_=NA.bind(null,t.eventManager),t.Pu.yu=IA.bind(null,t.eventManager),t}function qA(e){const t=Me(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=BA.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=WA.bind(null,t),t}class hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Zh(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return QC(this.persistence,new KC,t.initialUser,this.serializer)}Cu(t){return new Rk(om.mi,this.serializer)}Du(t){return new aA}async terminate(){var t,r;(t=this.gcScheduler)==null||t.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hh.provider={build:()=>new hh};class KA extends hh{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,r){lt(this.persistence.referenceDelegate instanceof uh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new OC(n,t.asyncQueue,r)}Cu(t){const r=this.cacheSizeBytes!==void 0?Zr.withCacheSize(this.cacheSizeBytes):Zr.DEFAULT;return new Rk(n=>uh.mi(n,r),this.serializer)}}class F1{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>X2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=$A.bind(null,this.syncEngine),await _A(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new AA}()}createDatastore(t){const r=Zh(t.databaseInfo.databaseId),n=function(a){return new cA(a)}(t.databaseInfo);return function(a,s,i,o){return new dA(a,s,i,o)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(r,n,a,s,i){return new mA(r,n,a,s,i)}(this.localStore,this.datastore,t.asyncQueue,r=>X2(this.syncEngine,r,0),function(){return W2.v()?new W2:new sA}())}createSyncEngine(t,r){return function(n,a,s,i,o,l,c){const f=new PA(n,a,s,i,o,l);return c&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(n){const a=Me(n);_e(Ti,"RemoteStore shutting down."),a.Ea.add(5),await su(a),a.Aa.shutdown(),a.Ra.set("Unknown")}(this.remoteStore),(t=this.datastore)==null||t.terminate(),(r=this.eventManager)==null||r.terminate()}}F1.provider={build:()=>new F1};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Zk{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Ba("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Us="FirestoreClient";class XA{constructor(t,r,n,a,s){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Rr.UNAUTHENTICATED,this.clientId=X0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async i=>{_e(Us,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(_e(Us,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=mm(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function op(e,t){e.asyncQueue.verifyOperationInProgress(),_e(Us,"Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async a=>{n.isEqual(a)||(await Dk(t.localStore,a),n=a)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Q2(e,t){e.asyncQueue.verifyOperationInProgress();const r=await YA(e);_e(Us,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>$2(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,a)=>$2(t.remoteStore,a)),e._onlineComponents=t}async function YA(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){_e(Us,"Using user provided OfflineComponentProvider");try{await op(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(n){return n.name==="FirebaseError"?n.code===oe.FAILED_PRECONDITION||n.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}(r))throw r;jo("Error using user provided cache. Falling back to memory cache: "+r),await op(e,new hh)}}else _e(Us,"Using default OfflineComponentProvider"),await op(e,new KA(void 0));return e._offlineComponents}async function e3(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(_e(Us,"Using user provided OnlineComponentProvider"),await Q2(e,e._uninitializedComponentsProvider._online)):(_e(Us,"Using default OnlineComponentProvider"),await Q2(e,new F1))),e._onlineComponents}function QA(e){return e3(e).then(t=>t.syncEngine)}async function M1(e){const t=await e3(e),r=t.eventManager;return r.onListen=LA.bind(null,t.syncEngine),r.onUnlisten=UA.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=FA.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=jA.bind(null,t.syncEngine),r}function JA(e,t,r={}){const n=new Ns;return e.asyncQueue.enqueueAndForget(async()=>function(a,s,i,o,l){const c=new Zk({next:h=>{c.Nu(),s.enqueueAndForget(()=>Wk(a,f));const d=h.docs.has(i);!d&&h.fromCache?l.reject(new Ne(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&o&&o.source==="server"?l.reject(new Ne(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),f=new Hk(qh(i.path),c,{includeMetadataChanges:!0,qa:!0});return Bk(a,f)}(await M1(e),e.asyncQueue,t,r,n)),n.promise}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function t3(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const J2=new Map;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const r3="firestore.googleapis.com",Z2=!0;class eb{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new Ne(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=r3,this.ssl=Z2}else this.host=t.host,this.ssl=t.ssl??Z2;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Ik;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<RC)throw new Ne(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}p_("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=t3(t.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ne(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ne(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ne(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,n){return r.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ym{constructor(t,r,n,a){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ne(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eb(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new n_;switch(r.type){case"firstParty":return new o_(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ne(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=J2.get(t);r&&(_e("ComponentProvider","Removing Datastore"),J2.delete(t),r.terminate())}(this),Promise.resolve()}}function ZA(e,t,r,n={}){var a;e=Is(e,ym);const s=G0(t),i=e._getSettings(),o={...i,emulatorOptions:e._getEmulatorOptions()},l=`${t}:${r}`;s&&(I5(`https://${l}`),P5("Firestore",!0)),i.host!==r3&&i.host!==l&&jo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:l,ssl:s,emulatorOptions:n};if(!Zf(c,o)&&(e._setSettings(c),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=Rr.MOCK_USER;else{f=R5(n.mockUserToken,(a=e._app)==null?void 0:a.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Ne(oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Rr(d)}e._authCredentials=new a_(new W4(f,h))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rd{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new rd(this.firestore,t,this._query)}}class sr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pc(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new sr(this.firestore,t,this._key)}toJSON(){return{type:sr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,r,n){if(ru(r,sr._jsonSchema))return new sr(t,n||null,new De(It.fromString(r.referencePath)))}}sr._jsonSchemaVersion="firestore/documentReference/1.0",sr._jsonSchema={type:Jt("string",sr._jsonSchemaVersion),referencePath:Jt("string")};class Pc extends rd{constructor(t,r,n){super(t,r,qh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new sr(this.firestore,null,new De(t))}withConverter(t){return new Pc(this.firestore,t,this._path)}}function wm(e,t,...r){if(e=xc(e),arguments.length===1&&(t=X0.newId()),d_("doc","path",t),e instanceof ym){const n=It.fromString(t,...r);return p2(n),new sr(e,null,new De(n))}{if(!(e instanceof sr||e instanceof Pc))throw new Ne(oe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(It.fromString(t,...r));return p2(n),new sr(e.firestore,e instanceof Pc?e.converter:null,new De(n))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const tb="AsyncQueue";class rb{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Pk(this,"async_queue_retry"),this._c=()=>{const n=ip();n&&_e(tb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const r=ip();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const r=ip();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ns;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!tl(t))throw t;_e(tb,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const r=this.ac.then(()=>(this.rc=!0,t().catch(n=>{throw this.nc=n,this.rc=!1,Ba("INTERNAL UNHANDLED ERROR: ",nb(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(t,r,n){this.uc(),this.oc.indexOf(t)>-1&&(r=0);const a=pm.createAndSchedule(this,t,r,n,s=>this.hc(s));return this.tc.push(a),a}uc(){this.nc&&Pe(47125,{Pc:nb(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const r of this.tc)if(r.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const r=this.tc.indexOf(t);this.tc.splice(r,1)}}function nb(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ab(e){return function(t,r){if(typeof t!="object"||t===null)return!1;const n=t;for(const a of r)if(a in n&&typeof n[a]=="function")return!0;return!1}(e,["next","error","complete"])}class Lc extends ym{constructor(t,r,n,a){super(t,r,n,a),this.type="firestore",this._queue=new rb,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new rb(t),this._firestoreClient=void 0,await t}}}function e8(e,t){const r=typeof e=="object"?e:Hx(),n=typeof e=="string"?e:nh,a=jx(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=A5("firestore");s&&ZA(a,...s)}return a}function km(e){if(e._terminated)throw new Ne(oe.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||t8(e),e._firestoreClient}function t8(e){var t,r,n;const a=e._freezeSettings(),s=function(i,o,l,c){return new x_(i,o,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,t3(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(e._databaseId,((t=e._app)==null?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||(r=a.localCache)!=null&&r._offlineComponentProvider&&(n=a.localCache)!=null&&n._onlineComponentProvider&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new XA(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(i){const o=i==null?void 0:i._online.build();return{_offline:i==null?void 0:i._offline.build(o),_online:o}}(e._componentsProvider))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class On{constructor(t){this._byteString=t}static fromBase64String(t){try{return new On(xr.fromBase64String(t))}catch(r){throw new Ne(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new On(xr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:On._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(ru(t,On._jsonSchema))return On.fromBase64String(t.bytes)}}On._jsonSchemaVersion="firestore/bytes/1.0",On._jsonSchema={type:Jt("string",On._jsonSchemaVersion),bytes:Jt("string")};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Tm{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Ne(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class n3{constructor(t){this._methodName=t}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ga{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Ne(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Ne(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Xe(this._lat,t._lat)||Xe(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ga._jsonSchemaVersion}}static fromJSON(t){if(ru(t,ga._jsonSchema))return new ga(t.latitude,t.longitude)}}ga._jsonSchemaVersion="firestore/geoPoint/1.0",ga._jsonSchema={type:Jt("string",ga._jsonSchemaVersion),latitude:Jt("number"),longitude:Jt("number")};/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class va{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,n){if(r.length!==n.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==n[a])return!1;return!0}(this._values,t._values)}toJSON(){return{type:va._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(ru(t,va._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(r=>typeof r=="number"))return new va(t.vectorValues);throw new Ne(oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}va._jsonSchemaVersion="firestore/vectorValue/1.0",va._jsonSchema={type:Jt("string",va._jsonSchemaVersion),vectorValues:Jt("object")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const r8=/^__.*__$/;class n8{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new Pi(t,this.data,this.fieldMask,r,this.fieldTransforms):new nu(t,this.data,r,this.fieldTransforms)}}function a3(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:e})}}class Em{constructor(t,r,n,a,s,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new Em({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){var r;const n=(r=this.path)==null?void 0:r.child(t),a=this.Vc({path:n,fc:!1});return a.gc(t),a}yc(t){var r;const n=(r=this.path)==null?void 0:r.child(t),a=this.Vc({path:n,fc:!1});return a.Rc(),a}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return dh(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(a3(this.Ac)&&r8.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class a8{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||Zh(t)}Cc(t,r,n,a=!1){return new Em({Ac:t,methodName:r,Dc:n,path:kr.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function s8(e){const t=e._freezeSettings(),r=Zh(e._databaseId);return new a8(e._databaseId,!!t.ignoreUndefinedProperties,r)}function i8(e,t,r,n,a,s={}){const i=e.Cc(s.merge||s.mergeFields?2:0,t,r,a);l3("Data must be an object, but it was:",i,n);const o=i3(n,i);let l,c;if(s.merge)l=new qn(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=o8(t,h,r);if(!i.contains(d))throw new Ne(oe.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);c8(f,d)||f.push(d)}l=new qn(f),c=i.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=i.fieldTransforms;return new n8(new Dn(o),l,c)}function s3(e,t){if(o3(e=xc(e)))return l3("Unsupported field value:",t,e),i3(e,t);if(e instanceof n3)return function(r,n){if(!a3(n.Ac))throw n.Sc(`${r._methodName}() can only be used with update() and set()`);if(!n.path)throw n.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(n);a&&n.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return function(r,n){const a=[];let s=0;for(const i of r){let o=s3(i,n.wc(s));o==null&&(o={nullValue:"NULL_VALUE"}),a.push(o),s++}return{arrayValue:{values:a}}}(e,t)}return function(r,n){if((r=xc(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return X_(n.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=St.fromDate(r);return{timestampValue:ch(n.serializer,a)}}if(r instanceof St){const a=new St(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ch(n.serializer,a)}}if(r instanceof ga)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof On)return{bytesValue:Ek(n.serializer,r._byteString)};if(r instanceof sr){const a=n.databaseId,s=r.firestore._databaseId;if(!s.isEqual(a))throw n.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:sm(r.firestore._databaseId||n.databaseId,r._key.path)}}if(r instanceof va)return function(a,s){return{mapValue:{fields:{[J4]:{stringValue:Z4},[ah]:{arrayValue:{values:a.toArray().map(i=>{if(typeof i!="number")throw s.Sc("VectorValues must only contain numeric values.");return rm(s.serializer,i)})}}}}}}(r,n);throw n.Sc(`Unsupported field value: ${Y0(r)}`)}(e,t)}function i3(e,t){const r={};return G4(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Di(e,(n,a)=>{const s=s3(a,t.mc(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function o3(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof St||e instanceof ga||e instanceof On||e instanceof sr||e instanceof n3||e instanceof va)}function l3(e,t,r){if(!o3(r)||!H4(r)){const n=Y0(r);throw n==="an object"?t.Sc(e+" a custom object"):t.Sc(e+" "+n)}}function o8(e,t,r){if((t=xc(t))instanceof Tm)return t._internalPath;if(typeof t=="string")return c3(e,t);throw dh("Field path arguments must be of type string or ",e,!1,void 0,r)}const l8=new RegExp("[~\\*/\\[\\]]");function c3(e,t,r){if(t.search(l8)>=0)throw dh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new Tm(...t.split("."))._internalPath}catch{throw dh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function dh(e,t,r,n,a){const s=n&&!n.isEmpty(),i=a!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=` in field ${n}`),i&&(l+=` in document ${a}`),l+=")"),new Ne(oe.INVALID_ARGUMENT,o+e+l)}function c8(e,t){return e.some(r=>r.isEqual(t))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class u3{constructor(t,r,n,a,s){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new sr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new u8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(f3("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class u8 extends u3{data(){return super.data()}}function f3(e,t){return typeof t=="string"?c3(e,t):t instanceof Tm?t._internalPath:t._delegate._internalPath}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function f8(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Ne(oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class h8{convertValue(t,r="none"){switch(Fs(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ht(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Ls(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw Pe(62114,{value:t})}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return Di(t,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(t){var r,n,a;const s=(a=(n=(r=t.fields)==null?void 0:r[ah].arrayValue)==null?void 0:n.values)==null?void 0:a.map(i=>Ht(i.doubleValue));return new va(s)}convertGeoPoint(t){return new ga(Ht(t.latitude),Ht(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=$h(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Nc(t));default:return null}}convertTimestamp(t){const r=Ps(t);return new St(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=It.fromString(t);lt(Nk(n),9688,{name:t});const a=new Ic(n.get(1),n.get(3)),s=new De(n.popFirst(5));return a.isEqual(r)||Ba(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function d8(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}class Fl{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class hi extends u3{constructor(t,r,n,a,s,i){super(t,r,n,a,i),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new Cf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(f3("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,r={};return r.type=hi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()||(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED")),r}}hi._jsonSchemaVersion="firestore/documentSnapshot/1.0",hi._jsonSchema={type:Jt("string",hi._jsonSchemaVersion),bundleSource:Jt("string","DocumentSnapshot"),bundleName:Jt("string"),bundle:Jt("string")};class Cf extends hi{data(t={}){return super.data(t)}}class _o{constructor(t,r,n,a){this._firestore=t,this._userDataWriter=r,this._snapshot=a,this.metadata=new Fl(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new Cf(this._firestore,this._userDataWriter,n.key,n,new Fl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ne(oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(n,a){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(i=>{const o=new Cf(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Fl(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter);return i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:s++}})}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(i=>a||i.type!==3).map(i=>{const o=new Cf(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Fl(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter);let l=-1,c=-1;return i.type!==0&&(l=s.indexOf(i.doc.key),s=s.delete(i.doc.key)),i.type!==1&&(s=s.add(i.doc),c=s.indexOf(i.doc.key)),{type:p8(i.type),doc:o,oldIndex:l,newIndex:c}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=_o._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=X0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach(s=>{s._document!==null&&(r.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),a.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function p8(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:e})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function m8(e){e=Is(e,sr);const t=Is(e.firestore,Lc);return JA(km(t),e._key).then(r=>d3(t,e,r))}_o._jsonSchemaVersion="firestore/querySnapshot/1.0",_o._jsonSchema={type:Jt("string",_o._jsonSchemaVersion),bundleSource:Jt("string","QuerySnapshot"),bundleName:Jt("string"),bundle:Jt("string")};class h3 extends h8{constructor(t){super(),this.firestore=t}convertBytes(t){return new On(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new sr(this.firestore,null,r)}}function g8(e,t,r){e=Is(e,sr);const n=Is(e.firestore,Lc),a=d8(e.converter,t,r);return b8(n,[i8(s8(n),"setDoc",e._key,a,e.converter!==null,r).toMutation(e._key,Pa.none())])}function v8(e,...t){var r,n,a;e=xc(e);let s={includeMetadataChanges:!1,source:"default"},i=0;typeof t[i]!="object"||ab(t[i])||(s=t[i++]);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ab(t[i])){const h=t[i];t[i]=(r=h.next)==null?void 0:r.bind(h),t[i+1]=(n=h.error)==null?void 0:n.bind(h),t[i+2]=(a=h.complete)==null?void 0:a.bind(h)}let l,c,f;if(e instanceof sr)c=Is(e.firestore,Lc),f=qh(e._key.path),l={next:h=>{t[i]&&t[i](d3(c,e,h))},error:t[i+1],complete:t[i+2]};else{const h=Is(e,rd);c=Is(h.firestore,Lc),f=h._query;const d=new h3(c);l={next:p=>{t[i]&&t[i](new _o(c,d,h,p))},error:t[i+1],complete:t[i+2]},f8(e._query)}return function(h,d,p,g){const m=new Zk(g),y=new Hk(d,m,p);return h.asyncQueue.enqueueAndForget(async()=>Bk(await M1(h),y)),()=>{m.Nu(),h.asyncQueue.enqueueAndForget(async()=>Wk(await M1(h),y))}}(km(c),f,o,l)}function b8(e,t){return function(r,n){const a=new Ns;return r.asyncQueue.enqueueAndForget(async()=>zA(await QA(r),n,a)),a.promise}(km(e),t)}function d3(e,t,r){const n=r.docs.get(t._key),a=new h3(e);return new hi(e,a,t._key,n,new Fl(r.hasPendingWrites,r.fromCache),t.converter)}(function(e,t=!0){(function(r){Zo=r})(Wx),th(new _c("firestore",(r,{instanceIdentifier:n,options:a})=>{const s=r.getProvider("app").getImmediate(),i=new Lc(new s_(r.getProvider("auth-internal")),new l_(s,r.getProvider("app-check-internal")),function(o,l){if(!Object.prototype.hasOwnProperty.apply(o.options,["projectId"]))throw new Ne(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ic(o.options.projectId,l)}(s,n),s);return a={useFetchStreams:t,...a},i._setSettings(a),i},"PUBLIC").setMultipleInstances(!0)),So(u2,f2,e),So(u2,f2,"esm2020")})();const di={apiKey:"AIzaSyAI0ZIVgSH1Muw2CDrgQ56lbr0E-F0lL4g",authDomain:"bethel-attendance.firebaseapp.com",projectId:"bethel-attendance",storageBucket:"bethel-attendance.firebasestorage.app",messagingSenderId:"335829758506",appId:"1:335829758506:web:d8b687557c08282691c953",measurementId:"G-7MGPJFKF9H"};let lp=null,cp=!1;function Sm(){if(console.log("initFirebase , isInitialized:",cp),cp)return console.log(" , db "),lp;if(!di)return console.log("Firebase  . LocalStorage ."),null;console.log("Firebase  ...",di.projectId);try{const e=O4(di);return lp=e8(e),cp=!0,console.log(" Firebase !"),lp}catch(e){return console.error(" Firebase  :",e),console.error(" :",e.message,e.code),null}}async function y8(e,t=null){const r=Sm();if(!r)return console.log(`Firebase  . ${e}  .`),null;try{const n=wm(r,"attendanceApp",e),a=await m8(n);if(a.exists()){const s=a.data().value;return console.log(`Firebase ${e}  :`,s),s}return console.log(`Firebase ${e}  .`),null}catch(n){return console.error(`Error loading ${e} from Firebase:`,n),console.error("Error details:",n.message,n.code),null}}async function w8(e,t){const r=Sm();if(!r)return console.log(`Firebase  . ${e}  .`),!1;try{const n=wm(r,"attendanceApp",e);return await g8(n,{value:t},{merge:!0}),console.log(`Firebase ${e}  `),!0}catch(n){return console.error(`Error saving ${e} to Firebase:`,n),console.error("Error details:",n.message,n.code),!1}}function Yu(e,t){const r=Sm();if(!r)return()=>{};try{const n=wm(r,"attendanceApp",e);return v8(n,a=>{a.exists()?t(a.data().value):t(null)},a=>{console.error(`Error subscribing to ${e}:`,a)})}catch(n){return console.error(`Error subscribing to ${e}:`,n),()=>{}}}const p3=di!==null;async function Qu(e,t=null){if(p3)try{const r=await y8(e,t);if(r!==null)try{return localStorage.setItem(e,JSON.stringify(r)),r}catch{return r}}catch(r){console.error("Firebase  , LocalStorage :",r)}try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch(r){return console.error(`Error loading ${e} from storage:`,r),t}}function as(e,t=null){try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch(r){return console.error(`Error loading ${e} from storage:`,r),t}}async function ss(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(r){console.error(`Error saving ${e} to localStorage:`,r)}if(p3)try{await w8(e,t)}catch(r){console.error(`Error saving ${e} to Firebase:`,r)}return!0}function Ju(e){return Array.isArray(e)?e.map(t=>(typeof t.talent>"u"&&(t.talent=0),typeof t.department>"u"&&(t.department=""),t)):[]}const m3=qe.createContext();function Gs(){const e=qe.useContext(m3);if(!e)throw new Error("useApp must be used within AppProvider");return e}function k8({children:e}){const t=di!==null;console.log("=== AppProvider  ==="),console.log("firebaseConfig:",di),console.log("useFirebase:",t),qe.useEffect(()=>{console.log("=== AppProvider useEffect  ==="),console.log("Firebase :",di?"":""),console.log("useFirebase:",t)},[t]);const[r,n]=qe.useState(()=>{const h=as("students",[]);return Ju(h)}),[a,s]=qe.useState(()=>as("attendanceData",[])),[i,o]=qe.useState(()=>as("isAdminMode",!1)),[l,c]=qe.useState(()=>as("adminPassword",null));qe.useEffect(()=>{if(!t)return;let h=[],d=!1;return(async()=>{try{console.log("Firebase    ...");const[p,g,m,y]=await Promise.all([Qu("students",null),Qu("attendanceData",null),Qu("isAdminMode",null),Qu("adminPassword",null)]);console.log("Firebase :",{firebaseStudents:p,firebaseAttendance:g,firebaseAdminMode:m,firebasePassword:y});const k=as("students",[]),b=as("attendanceData",[]),w=as("isAdminMode",!1),N=as("adminPassword",null);if(p!==null)n(Ju(p));else if(k.length>0){console.log("LocalStorage   Firebase ...");const _=Ju(k);n(_),await ss("students",_)}g!==null?s(g):b.length>0&&(console.log("LocalStorage   Firebase ..."),s(b),await ss("attendanceData",b)),m!==null?o(m):w!==!1&&(o(w),await ss("isAdminMode",w)),y!==null?c(y):N!==null&&(c(N),await ss("adminPassword",N)),d=!0,console.log("Firebase    "),h.push(Yu("students",_=>{d&&_!==null&&Array.isArray(_)&&(console.log("Firebase students  :",_),n(Ju(_)))})),h.push(Yu("attendanceData",_=>{d&&_!==null&&Array.isArray(_)&&(console.log("Firebase attendanceData  :",_),s(_))})),h.push(Yu("isAdminMode",_=>{d&&typeof _=="boolean"&&o(_)})),h.push(Yu("adminPassword",_=>{d&&_!==null&&c(_)}))}catch(p){console.error("Firebase   :",p),d=!0}})(),()=>{h.forEach(p=>p&&p()),h=[]}},[t]),qe.useEffect(()=>{ss("students",r)},[r]),qe.useEffect(()=>{ss("attendanceData",a)},[a]),qe.useEffect(()=>{ss("isAdminMode",i)},[i]),qe.useEffect(()=>{l&&ss("adminPassword",l)},[l]);const f={students:r,attendanceData:a,isAdminMode:i,adminPassword:l,addStudent:(h,d,p="",g="")=>{const m={name:h,grade:d,baptismName:p,department:g,talent:0};n(y=>[...y,m])},deleteStudent:(h,d)=>{n(p=>p.filter(g=>!(g.name===h&&String(g.grade)===String(d))))},addAttendanceRecord:(h,d,p,g,m=!1,y="")=>{const k={date:h,student:d,grade:p,department:y,status:g,talentEarned:m};s(b=>[...b,k])},deleteAttendanceRecord:(h,d,p)=>{s(g=>g.filter(m=>!(m.date===h&&m.student===d&&String(m.grade)===String(p))))},loginAdmin:h=>l?l===h?(o(!0),!0):!1:(c(h),o(!0),!0),logoutAdmin:()=>{o(!1)},changePassword:(h,d)=>l===h?(c(d),!0):!1,awardTalent:(h,d)=>{n(p=>p.map(g=>g.name===h&&String(g.grade)===String(d)?{...g,talent:(g.talent||0)+1}:g))},setStudents:n,setAttendanceData:s};return B.jsx(m3.Provider,{value:f,children:e})}function T8({onClose:e}){const{loginAdmin:t,adminPassword:r}=Gs(),[n,a]=qe.useState(""),[s,i]=qe.useState(""),[o,l]=qe.useState(""),[c,f]=qe.useState(!r);qe.useEffect(()=>{f(!r)},[r]);const h=d=>{if(d.preventDefault(),l(""),c){if(!n||n.length<4){l(" 4  .");return}if(n!==s){l("  .");return}t(n)?(a(""),i(""),e()):l("  .")}else t(n)?(a(""),e()):l("  .")};return B.jsx("div",{className:"modal-overlay",onClick:e,children:B.jsxs("div",{className:"modal-content",onClick:d=>d.stopPropagation(),children:[B.jsxs("div",{className:"modal-header",children:[B.jsx("h2",{children:c?"  ":" "}),B.jsx("button",{className:"modal-close",onClick:e,children:""})]}),B.jsxs("form",{onSubmit:h,className:"login-form",children:[B.jsxs("div",{className:"form-group",children:[B.jsx("label",{children:""}),B.jsx("input",{type:"password",value:n,onChange:d=>a(d.target.value),placeholder:" ",required:!0})]}),c&&B.jsxs("div",{className:"form-group",children:[B.jsx("label",{children:" "}),B.jsx("input",{type:"password",value:s,onChange:d=>i(d.target.value),placeholder:"  ",required:!0})]}),o&&B.jsx("div",{className:"error-message",children:o}),B.jsx("button",{type:"submit",className:"btn-primary",children:c?"":""})]})]})})}function E8(){const{isAdminMode:e,logoutAdmin:t}=Gs(),[r,n]=Ty.useState(!1);return B.jsxs("header",{className:"header",children:[B.jsxs("div",{className:"header-content",children:[B.jsx("h1",{children:"  "}),B.jsx("div",{className:"header-actions",children:e?B.jsxs(B.Fragment,{children:[B.jsx("span",{className:"admin-badge",children:" "}),B.jsx("button",{onClick:t,className:"btn-logout",children:""})]}):B.jsx("button",{onClick:()=>n(!0),className:"btn-login",children:" "})})]}),r&&B.jsx(T8,{onClose:()=>n(!1)})]})}function S8(e){return e.reduce((t,r)=>t+(r.talent||0),0)}function nd(e,t,r,n=""){const a=t?` (${t})`:"",s=n?` [: ${n}]`:"",i=r>0?` [: ${r}]`:"";return`${e}${a}${s}${i}`}function x8(){const{students:e,addStudent:t,deleteStudent:r,isAdminMode:n}=Gs(),[a,s]=qe.useState(""),[i,o]=qe.useState("1"),[l,c]=qe.useState(""),[f,h]=qe.useState(""),[d,p]=qe.useState("");if(!n)return null;const g=b=>{if(b.preventDefault(),!a.trim()){alert(" .");return}if(e.some(w=>w.name===a.trim()&&String(w.grade)===i)){alert("  .");return}t(a.trim(),i,l.trim(),f),s(""),c(""),o("1"),h("")},m={};e.forEach(b=>{const w=String(b.grade);m[w]||(m[w]=[]),m[w].push(b)});const y=Object.keys(m).sort((b,w)=>{const N=parseInt(b)||999,_=parseInt(w)||999;return N!==_?N-_:b.localeCompare(w)}),k=d?d==="all"?y:y.filter(b=>String(b)===d):[];return B.jsxs("section",{className:"section student-management",children:[B.jsx("h2",{children:" "}),B.jsxs("div",{className:"grade-filter",style:{marginBottom:"20px"},children:[B.jsx("label",{children:" : "}),B.jsxs("select",{value:d,onChange:b=>p(b.target.value),style:{padding:"8px",marginLeft:"10px",minWidth:"150px"},children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"all",children:" "}),B.jsx("option",{value:"1",children:"1"}),B.jsx("option",{value:"2",children:"2"}),B.jsx("option",{value:"4",children:"4"}),B.jsx("option",{value:"5",children:"5"}),B.jsx("option",{value:"6",children:"6"}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]})]}),B.jsxs("div",{className:"student-form",children:[B.jsx("input",{type:"text",value:a,onChange:b=>s(b.target.value),placeholder:" "}),B.jsxs("select",{value:i,onChange:b=>o(b.target.value),children:[B.jsx("option",{value:"1",children:"1"}),B.jsx("option",{value:"2",children:"2"}),B.jsx("option",{value:"4",children:"4"}),B.jsx("option",{value:"5",children:"5"}),B.jsx("option",{value:"6",children:"6"}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]}),B.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:" ()"}),B.jsxs("select",{value:f,onChange:b=>h(b.target.value),children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]}),B.jsx("button",{onClick:g,className:"btn-primary",children:" "})]}),B.jsx("div",{className:"student-list",children:k.length>0?k.map(b=>{const w=m[b],N=/^\d+$/.test(b)?`${b}`:b;return B.jsxs("div",{className:"grade-section",children:[B.jsxs("h3",{children:[N," (",w.length,")"]}),B.jsx("ul",{children:w.map((_,F)=>B.jsxs("li",{className:"student-item",children:[B.jsx("span",{children:nd(_.name,_.baptismName,_.talent||0,_.department||"")}),B.jsx("button",{onClick:()=>r(_.name,_.grade),className:"btn-delete",children:""})]},`${_.name}-${_.grade}-${F}`))})]},b)}):B.jsx("div",{className:"empty-message",children:d&&d!=="all"?"    .":" ."})})]})}function g3(){const e=[];for(let t=0;t<12;t++){const r=new Date(2026,t+1,0).getDate();for(let n=1;n<=r;n++)if(new Date(2026,t,n).getDay()===0){const a=`2026-${String(t+1).padStart(2,"0")}-${String(n).padStart(2,"0")}`;e.push(a)}}return e}function U1(e){const t=new Date(e),r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}.${n}.${a} ()`}function _8(){const{students:e,attendanceData:t,addAttendanceRecord:r,awardTalent:n,isAdminMode:a,setAttendanceData:s}=Gs(),[i,o]=qe.useState("grade"),[l,c]=qe.useState(""),[f,h]=qe.useState(""),[d,p]=qe.useState(""),[g,m]=qe.useState({}),y=g3();if(qe.useEffect(()=>{if(l){const _=t.filter(T=>T.date===l),F={};_.forEach(T=>{const S=`${T.student}_${String(T.grade)}`;F[S]=T.status}),m(F)}else m({})},[l,t]),!a)return null;let k=e;i==="grade"?f&&(k=k.filter(_=>String(_.grade)===f)):d&&(k=k.filter(_=>_.department===d));const b=(_,F,T)=>{const S=`${_}_${String(F)}`;m(x=>({...x,[S]:T}))},w=()=>{if(!l){alert(" .");return}if(i==="grade"&&!f){alert(" .");return}if(i==="department"&&!d){alert(" .");return}if(k.length===0){alert("    .");return}s(_=>_.filter(F=>!!(F.date!==l||i==="grade"&&f&&String(F.grade)!==f||i==="department"&&d&&F.department!==d))),k.forEach(_=>{const F=`${_.name}_${String(_.grade)}`,T=g[F]||"present",S=T==="present";r(l,_.name,_.grade,T,S,_.department||""),S&&n(_.name,_.grade)}),alert(" .")},N=_=>{o(_),h(""),p(""),m({})};return B.jsxs("section",{className:"section attendance-check",children:[B.jsx("h2",{children:" "}),B.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",borderBottom:"2px solid #e0e0e0"},children:[B.jsx("button",{onClick:()=>N("grade"),style:{padding:"10px 20px",border:"none",background:i==="grade"?"#4CAF50":"transparent",color:i==="grade"?"white":"#666",cursor:"pointer",borderBottom:i==="grade"?"3px solid #4CAF50":"3px solid transparent",fontWeight:i==="grade"?"bold":"normal"},children:"  "}),B.jsx("button",{onClick:()=>N("department"),style:{padding:"10px 20px",border:"none",background:i==="department"?"#4CAF50":"transparent",color:i==="department"?"white":"#666",cursor:"pointer",borderBottom:i==="department"?"3px solid #4CAF50":"3px solid transparent",fontWeight:i==="department"?"bold":"normal"},children:"  "})]}),B.jsxs("div",{className:"attendance-controls",children:[B.jsxs("div",{className:"form-group",children:[B.jsx("label",{children:"  (2026 )"}),B.jsxs("select",{value:l,onChange:_=>c(_.target.value),className:"date-select",children:[B.jsx("option",{value:"",children:" "}),y.map(_=>B.jsx("option",{value:_,children:U1(_)},_))]})]}),i==="grade"?B.jsxs("div",{className:"form-group",children:[B.jsx("label",{children:"  ()"}),B.jsxs("select",{value:f,onChange:_=>h(_.target.value),className:"grade-select",children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"1",children:"1"}),B.jsx("option",{value:"2",children:"2"}),B.jsx("option",{value:"4",children:"4"}),B.jsx("option",{value:"5",children:"5"}),B.jsx("option",{value:"6",children:"6"}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]})]}):B.jsxs("div",{className:"form-group",children:[B.jsx("label",{children:"  ()"}),B.jsxs("select",{value:d,onChange:_=>p(_.target.value),className:"department-select",children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]})]})]}),i==="grade"&&!f&&B.jsx("div",{className:"empty-message",children:" ."}),i==="department"&&!d&&B.jsx("div",{className:"empty-message",children:" ."}),(i==="grade"&&f||i==="department"&&d)&&k.length===0&&B.jsx("div",{className:"empty-message",children:"    ."}),(i==="grade"&&f||i==="department"&&d)&&k.length>0&&B.jsxs(B.Fragment,{children:[B.jsx("div",{className:"attendance-list",children:k.map((_,F)=>{const T=`${_.name}_${String(_.grade)}`,S=g[T]||"present";return B.jsxs("div",{className:"attendance-item",children:[B.jsx("span",{children:nd(_.name,_.baptismName,_.talent||0,_.department||"")}),B.jsxs("div",{className:"status-buttons",children:[B.jsx("button",{className:`status-btn present ${S==="present"?"active":""}`,onClick:()=>b(_.name,_.grade,"present"),children:""}),B.jsx("button",{className:`status-btn absent ${S==="absent"?"active":""}`,onClick:()=>b(_.name,_.grade,"absent"),children:""})]})]},`${_.name}-${_.grade}-${F}`)})}),B.jsx("button",{onClick:w,className:"btn-primary save-btn",children:" "})]})]})}function C8(){const{students:e,attendanceData:t}=Gs(),[r,n]=qe.useState(""),[a,s]=qe.useState(""),[i,o]=qe.useState(null),l=()=>{if(!r.trim()||!a){alert("   .");return}const c=e.find(p=>p.name===r.trim()&&String(p.grade)===a);if(!c){alert("    ."),o(null);return}const f=t.filter(p=>p.student===c.name&&String(p.grade)===String(c.grade)),h=f.filter(p=>p.status==="present").length,d=f.filter(p=>p.status==="absent").length;o({student:c,records:f.sort((p,g)=>new Date(g.date)-new Date(p.date)),presentCount:h,absentCount:d})};return B.jsxs("section",{className:"section student-record-search",children:[B.jsx("h2",{children:"  "}),B.jsxs("div",{className:"search-form",children:[B.jsx("input",{type:"text",value:r,onChange:c=>n(c.target.value),placeholder:" "}),B.jsxs("select",{value:a,onChange:c=>s(c.target.value),children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"1",children:"1"}),B.jsx("option",{value:"2",children:"2"}),B.jsx("option",{value:"4",children:"4"}),B.jsx("option",{value:"5",children:"5"}),B.jsx("option",{value:"6",children:"6"}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]}),B.jsx("button",{onClick:l,className:"btn-primary",children:""})]}),i&&B.jsxs("div",{className:"search-results",children:[B.jsxs("div",{className:"student-info",children:[B.jsx("h3",{children:nd(i.student.name,i.student.baptismName,i.student.talent||0,i.student.department||"")}),B.jsxs("div",{className:"stats",children:[B.jsxs("div",{className:"stat-item",children:[B.jsx("span",{className:"stat-label",children:":"}),B.jsxs("span",{className:"stat-value",children:[i.presentCount,""]})]}),B.jsxs("div",{className:"stat-item",children:[B.jsx("span",{className:"stat-label",children:":"}),B.jsxs("span",{className:"stat-value",children:[i.absentCount,""]})]}),B.jsxs("div",{className:"stat-item",children:[B.jsx("span",{className:"stat-label",children:" :"}),B.jsxs("span",{className:"stat-value",children:[i.student.talent||0,""]})]})]})]}),B.jsxs("div",{className:"records-list",children:[B.jsx("h4",{children:" "}),i.records.length===0?B.jsx("div",{className:"empty-message",children:"  ."}):B.jsx("ul",{children:i.records.map((c,f)=>B.jsxs("li",{className:"record-item",children:[B.jsx("span",{className:"record-date",children:c.date}),B.jsx("span",{className:`record-status ${c.status}`,children:c.status==="present"?"":""})]},`${c.date}-${f}`))})]})]})]})}function A8(){const{attendanceData:e,students:t,isAdminMode:r}=Gs(),[n,a]=qe.useState(""),[s,i]=qe.useState(""),[o,l]=qe.useState(""),[c,f]=qe.useState("");if(!r)return null;const h=g3();let d=[...e];n&&n!=="all"&&(d=d.filter(g=>String(g.grade)===n)),s&&s!=="all"&&(d=d.filter(g=>g.department===s)),o&&(d=d.filter(g=>g.student===o)),c&&(d=d.filter(g=>g.date===c)),d.sort((g,m)=>new Date(m.date)-new Date(g.date));const p=[...new Set(t.map(g=>g.name))].sort();return B.jsxs("section",{className:"section admin-record-view",children:[B.jsx("h2",{children:"  "}),B.jsxs("div",{className:"filter-controls",children:[B.jsxs("select",{value:n,onChange:g=>a(g.target.value),children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"all",children:" "}),B.jsx("option",{value:"1",children:"1"}),B.jsx("option",{value:"2",children:"2"}),B.jsx("option",{value:"4",children:"4"}),B.jsx("option",{value:"5",children:"5"}),B.jsx("option",{value:"6",children:"6"}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]}),B.jsxs("select",{value:s,onChange:g=>i(g.target.value),children:[B.jsx("option",{value:"",children:" "}),B.jsx("option",{value:"all",children:" "}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""}),B.jsx("option",{value:"",children:""})]}),B.jsxs("select",{value:o,onChange:g=>l(g.target.value),children:[B.jsx("option",{value:"",children:" "}),p.map(g=>B.jsx("option",{value:g,children:g},g))]}),B.jsxs("select",{value:c,onChange:g=>f(g.target.value),children:[B.jsx("option",{value:"",children:" "}),h.map(g=>B.jsx("option",{value:g,children:U1(g)},g))]})]}),B.jsx("div",{className:"records-table",children:!n&&!s?B.jsx("div",{className:"empty-message",children:"   ."}):d.length===0?B.jsx("div",{className:"empty-message",children:"  ."}):B.jsxs("table",{children:[B.jsx("thead",{children:B.jsxs("tr",{children:[B.jsx("th",{children:""}),B.jsx("th",{children:""}),B.jsx("th",{children:""}),B.jsx("th",{children:""}),B.jsx("th",{children:""})]})}),B.jsx("tbody",{children:d.map((g,m)=>{const y=t.find(k=>k.name===g.student&&String(k.grade)===String(g.grade));return B.jsxs("tr",{children:[B.jsx("td",{children:U1(g.date)}),B.jsx("td",{children:nd(g.student,(y==null?void 0:y.baptismName)||"",(y==null?void 0:y.talent)||0,(y==null?void 0:y.department)||g.department||"")}),B.jsx("td",{children:/^\d+$/.test(String(g.grade))?`${g.grade}`:g.grade}),B.jsx("td",{children:g.department||"-"}),B.jsx("td",{children:B.jsx("span",{className:`record-status ${g.status}`,children:g.status==="present"?"":""})})]},`${g.date}-${g.student}-${m}`)})})]})})]})}const N8=function(e,t,r){let n=Promise.resolve();function a(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return n.then(s=>{for(const i of s||[])i.status==="rejected"&&a(i.reason);return e().catch(a)})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Fc={};Fc.version="0.18.5";var gn=1200,Ei=1252,I8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ad=function(e){I8.indexOf(e)!=-1&&(Ei=xm[0]=e)};function R8(){ad(1252)}var Ln=function(e){gn=e,ad(e)};function sd(){Ln(1200),R8()}function ph(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function D8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function v3(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var go=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?D8(e.slice(2)):t==254&&r==255?v3(e.slice(2)):t==65279?e.slice(1):e},Ml=function(e){return String.fromCharCode(e)},j1=function(e){return String.fromCharCode(e)},tt;function O8(e){tt=e,Ln=function(t){gn=t,ad(t)},go=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?tt.utils.decode(1200,ph(t.slice(2))):t},Ml=function(t){return gn===1200?String.fromCharCode(t):tt.utils.decode(gn,[t&255,t>>8])[0]},j1=function(t){return tt.utils.decode(Ei,[t])[0]},G3()}var ps="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mc(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=ps.charAt(s)+ps.charAt(i)+ps.charAt(o)+ps.charAt(l);return t}function bn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=ps.indexOf(e.charAt(c++)),i=ps.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=ps.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=ps.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$a=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function js(e){return $e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function sb(e){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var hn=function(e){return $e?$a(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function ou(e){if(typeof ArrayBuffer>"u")return hn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function qs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function P8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function _m(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return _m(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var pr=$e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:$a(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function L8(e){for(var t=[],r=0,n=e.length+250,a=js(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=js(65535),n=65530)}return t.push(a.slice(0,r)),pr(t)}var Ur=/\u0000/g,Ul=/[\u0001-\u0006]/g;function Co(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Kn(e,t){var r=""+e;return r.length>=t?r:jt("0",t-r.length)+r}function Cm(e,t){var r=""+e;return r.length>=t?r:jt(" ",t-r.length)+r}function mh(e,t){var r=""+e;return r.length>=t?r:r+jt(" ",t-r.length)}function F8(e,t){var r=""+Math.round(e);return r.length>=t?r:jt("0",t-r.length)+r}function M8(e,t){var r=""+e;return r.length>=t?r:jt("0",t-r.length)+r}var ib=Math.pow(2,32);function Xi(e,t){if(e>ib||e<-ib)return F8(e,t);var r=Math.round(e);return M8(r,t)}function gh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ob=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],up=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function U8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Re={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},lb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},j8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,f=0,h=Math.floor(a);c<t&&(h=Math.floor(a),o=h*i+s,f=h*c+l,!(a-h<5e-8));)a=1/(a-h),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function ms(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=$8(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var b3=new Date(1899,11,31,0,0,0),z8=b3.getTime(),V8=new Date(1900,2,1,0,0,0);function y3(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=V8&&(r+=24*60*60*1e3),(r-(z8+(e.getTimezoneOffset()-b3.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Am(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function B8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function W8(e){var t=e<0?12:11,r=Am(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function H8(e){var t=Am(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Uc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=W8(e):t===10?r=e.toFixed(10).substr(0,12):r=H8(e),Am(B8(r.toUpperCase()))}function Si(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Uc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return yn(14,y3(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function $8(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function G8(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return up[r.m-1][1];case 5:return up[r.m-1][0];default:return up[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return ob[r.q][0];default:return ob[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Kn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Kn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Kn(l,c):"";return f}function gs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var w3=/%/g;function q8(e,t,r){var n=t.replace(w3,""),a=t.length-n.length;return La(e,n,r*Math.pow(10,2*a))+jt("%",a)}function K8(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return La(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function k3(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+k3(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var T3=/# (\?+)( ?)\/( ?)(\d+)/;function X8(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?jt(" ",e[1].length+1+e[4].length):Cm(i,e[1].length)+e[2]+"/"+e[3]+Kn(o,e[4].length))}function Y8(e,t,r){return r+(t===0?"":""+t)+jt(" ",e[1].length+2+e[4].length)}var E3=/^#*0*\.([0#]+)/,S3=/\).*[0#]/,x3=/\(###\) ###\\?-####/;function $r(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function cb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ub(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Q8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function J8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(S3)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xn("n",n,r):"("+xn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return K8(e,t,r);if(t.indexOf("%")!==-1)return q8(e,t,r);if(t.indexOf("E")!==-1)return k3(t,r);if(t.charCodeAt(0)===36)return"$"+xn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Xi(l,t.length);if(t.match(/^[#?]+$/))return a=Xi(r,0),a==="0"&&(a=""),a.length>t.length?a:$r(t.substr(0,t.length-a.length))+a;if(s=t.match(T3))return X8(s,l,c);if(t.match(/^#+0+$/))return c+Xi(l,t.length-t.indexOf("0"));if(s=t.match(E3))return a=cb(r,s[1].length).replace(/^([^\.]+)$/,"$1."+$r(s[1])).replace(/\.$/,"."+$r(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+jt("0",$r(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+cb(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+gs(Xi(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xn(e,t,-r):gs(""+(Math.floor(r)+Q8(r,s[1].length)))+"."+Kn(ub(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return xn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Co(xn(e,t.replace(/[\\-]/g,""),r)),i=0,Co(Co(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(x3))return a=xn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=vh(l,Math.pow(10,i)-1,!1),a=""+c,f=La("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=mh(o[2],i),f.length<s[4].length&&(f=$r(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=vh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Cm(o[1],i)+s[2]+"/"+s[3]+mh(o[2],i):jt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Xi(r,0),t.length<=a.length?a:$r(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,d=t.length-a.length-h;return $r(t.substr(0,h)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=ub(r,s[1].length),r<0?"-"+xn(e,t,-r):gs(J8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Kn(0,3-g.length):"")+g})+"."+Kn(i,s[1].length);switch(t){case"###,##0.00":return xn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=gs(Xi(l,0));return p!=="0"?c+p:"";case"###,###.00":return xn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Z8(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return La(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function eN(e,t,r){var n=t.replace(w3,""),a=t.length-n.length;return La(e,n,r*Math.pow(10,2*a))+jt("%",a)}function _3(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_3(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ia(e,t,r){if(e.charCodeAt(0)===40&&!t.match(S3)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ia("n",n,r):"("+ia("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Z8(e,t,r);if(t.indexOf("%")!==-1)return eN(e,t,r);if(t.indexOf("E")!==-1)return _3(t,r);if(t.charCodeAt(0)===36)return"$"+ia(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Kn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:$r(t.substr(0,t.length-a.length))+a;if(s=t.match(T3))return Y8(s,l,c);if(t.match(/^#+0+$/))return c+Kn(l,t.length-t.indexOf("0"));if(s=t.match(E3))return a=(""+r).replace(/^([^\.]+)$/,"$1."+$r(s[1])).replace(/\.$/,"."+$r(s[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+jt("0",$r(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+gs(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ia(e,t,-r):gs(""+r)+"."+jt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ia(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Co(ia(e,t.replace(/[\\-]/g,""),r)),i=0,Co(Co(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(x3))return a=ia(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=vh(l,Math.pow(10,i)-1,!1),a=""+c,f=La("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=mh(o[2],i),f.length<s[4].length&&(f=$r(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=vh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Cm(o[1],i)+s[2]+"/"+s[3]+mh(o[2],i):jt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:$r(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,d=t.length-a.length-h;return $r(t.substr(0,h)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ia(e,t,-r):gs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Kn(0,3-g.length):"")+g})+"."+Kn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=gs(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return ia(e,t.slice(0,t.lastIndexOf(".")),r)+$r(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function La(e,t,r){return(r|0)===r?ia(e,t,r):xn(e,t,r)}function tN(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var C3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(C3))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function rN(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,f,h,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!gh(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(h=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(h);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),g=p==="("||p===")"?p:"t";a[a.length]={t:g,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ms(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ms(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=ms(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,d="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(C3)){if(c==null&&(c=ms(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fi(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var y=0,k=0,b;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=d,l="h",y<1&&(y=1);break;case"s":(b=a[i].v.match(/\.0+$/))&&(k=Math.max(k,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[i].v.match(/[Hh]/)&&(y=1),y<2&&a[i].v.match(/[Mm]/)&&(y=2),y<3&&a[i].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",N;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=G8(a[i].t.charCodeAt(0),a[i].v,c,k),a[i].t="t";break;case"n":case"?":for(N=i+1;a[N]!=null&&((o=a[N].t)==="?"||o==="D"||(o===" "||o==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[i].v+=a[N].v,a[N]={v:"",t:";"},++N;w+=a[i].v,i=N-1;break;case"G":a[i].t="t",a[i].v=Si(t,r);break}var _="",F,T;if(w.length>0){w.charCodeAt(0)==40?(F=t<0&&w.charCodeAt(0)===45?-t:t,T=La("n",w,F)):(F=t<0&&n>1?-t:t,T=La("n",w,F),F<0&&a[0]&&a[0].t=="t"&&(T=T.substr(1),a[0].v="-"+a[0].v)),N=T.length-1;var S=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){S=i;break}var x=a.length;if(S===a.length&&T.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(N>=a[i].v.length-1?(N-=a[i].v.length,a[i].v=T.substr(N+1,a[i].v.length)):N<0?a[i].v="":(a[i].v=T.substr(0,N+1),N=-1),a[i].t="t",x=i);N>=0&&x<a.length&&(a[x].v=T.substr(0,N+1)+a[x].v)}else if(S!==a.length&&T.indexOf("E")===-1){for(N=T.indexOf(".")-1,i=S;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===S?a[i].v.indexOf(".")-1:a[i].v.length-1,_=a[i].v.substr(f+1);f>=0;--f)N>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(_=T.charAt(N--)+_);a[i].v=_,a[i].t="t",x=i}for(N>=0&&x<a.length&&(a[x].v=T.substr(0,N+1)+a[x].v),N=T.indexOf(".")+1,i=S;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==S)){for(f=a[i].v.indexOf(".")>-1&&i===S?a[i].v.indexOf(".")+1:0,_=a[i].v.substr(0,f);f<a[i].v.length;++f)N<T.length&&(_+=T.charAt(N++));a[i].v=_,a[i].t="t",x=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(F=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=La(a[i].t,a[i].v,F),a[i].t="t");var I="";for(i=0;i!==a.length;++i)a[i]!=null&&(I+=a[i].v);return I}var fb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function nN(e,t){var r=tN(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(fb),o=r[1].match(fb);return hb(t,i)?[n,r[0]]:hb(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function yn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Re)[e],n==null&&(n=r.table&&r.table[lb[e]]||Re[lb[e]]),n==null&&(n=j8[e]||"General");break}if(gh(n,0))return Si(t,r);t instanceof Date&&(t=y3(t,r.date1904));var a=nN(n,t);if(gh(a[1]))return Si(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return rN(a[1],t,r,a[0])}function ba(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Re[r]==null){t<0&&(t=r);continue}if(Re[r]==e){t=r;break}}t<0&&(t=391)}return Re[t]=e,t}function lu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ba(e[t],t)}function nl(){Re=U8()}var A3={format:yn,load:ba,_table:Re,load_table:lu,parse_date_code:ms,is_date:Fi,get_table:function(){return A3._table=Re}},aN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},N3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function sN(e){var t=typeof e=="number"?Re[e]:e;return t=t.replace(N3,"(\\d+)"),new RegExp("^"+t+"$")}function iN(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(N3)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?f:c+"T"+f}var oN=function(){var e={};e.version="1.2.0";function t(){for(var T=0,S=new Array(256),x=0;x!=256;++x)T=x,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,S[x]=T;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function n(T){var S=0,x=0,I=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)A[I]=T[I];for(I=0;I!=256;++I)for(x=T[I],S=256+I;S<4096;S+=256)x=A[S]=x>>>8^T[x&255];var R=[];for(I=1;I!=16;++I)R[I-1]=typeof Int32Array<"u"?A.subarray(I*256,I*256+256):A.slice(I*256,I*256+256);return R}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],f=a[5],h=a[6],d=a[7],p=a[8],g=a[9],m=a[10],y=a[11],k=a[12],b=a[13],w=a[14];function N(T,S){for(var x=S^-1,I=0,A=T.length;I<A;)x=x>>>8^r[(x^T.charCodeAt(I++))&255];return~x}function _(T,S){for(var x=S^-1,I=T.length-15,A=0;A<I;)x=w[T[A++]^x&255]^b[T[A++]^x>>8&255]^k[T[A++]^x>>16&255]^y[T[A++]^x>>>24]^m[T[A++]]^g[T[A++]]^p[T[A++]]^d[T[A++]]^h[T[A++]]^f[T[A++]]^c[T[A++]]^l[T[A++]]^o[T[A++]]^i[T[A++]]^s[T[A++]]^r[T[A++]];for(I+=15;A<I;)x=x>>>8^r[(x^T[A++])&255];return~x}function F(T,S){for(var x=S^-1,I=0,A=T.length,R=0,D=0;I<A;)R=T.charCodeAt(I++),R<128?x=x>>>8^r[(x^R)&255]:R<2048?(x=x>>>8^r[(x^(192|R>>6&31))&255],x=x>>>8^r[(x^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,D=T.charCodeAt(I++)&1023,x=x>>>8^r[(x^(240|R>>8&7))&255],x=x>>>8^r[(x^(128|R>>2&63))&255],x=x>>>8^r[(x^(128|D>>6&15|(R&3)<<4))&255],x=x>>>8^r[(x^(128|D&63))&255]):(x=x>>>8^r[(x^(224|R>>12&15))&255],x=x>>>8^r[(x^(128|R>>6&63))&255],x=x>>>8^r[(x^(128|R&63))&255]);return~x}return e.table=r,e.bstr=N,e.buf=_,e.str=F,e}(),Ie=function(){var e={};e.version="1.2.1";function t(C,M){for(var O=C.split("/"),L=M.split("/"),U=0,z=0,K=Math.min(O.length,L.length);U<K;++U){if(z=O[U].length-L[U].length)return z;if(O[U]!=L[U])return O[U]<L[U]?-1:1}return O.length-L.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(0,M+1)}function n(C){if(C.charAt(C.length-1)=="/")return n(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(M+1)}function a(C,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,C.write_shift(2,O);var L=M.getFullYear()-1980;L=L<<4|M.getMonth()+1,L=L<<5|M.getDate(),C.write_shift(2,L)}function s(C){var M=C.read_shift(2)&65535,O=C.read_shift(2)&65535,L=new Date,U=O&31;O>>>=5;var z=O&15;O>>>=4,L.setMilliseconds(0),L.setFullYear(O+1980),L.setMonth(z-1),L.setDate(U);var K=M&31;M>>>=5;var Q=M&63;return M>>>=6,L.setHours(M),L.setMinutes(Q),L.setSeconds(K<<1),L}function i(C){wr(C,0);for(var M={},O=0;C.l<=C.length-4;){var L=C.read_shift(2),U=C.read_shift(2),z=C.l+U,K={};switch(L){case 21589:O=C.read_shift(1),O&1&&(K.mtime=C.read_shift(4)),U>5&&(O&2&&(K.atime=C.read_shift(4)),O&4&&(K.ctime=C.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}C.l=z,M[L]=K}return M}var o;function l(){return o||(o={})}function c(C,M){if(C[0]==80&&C[1]==75)return cl(C,M);if((C[0]|32)==109&&(C[1]|32)==105)return Xa(C,M);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var O=3,L=512,U=0,z=0,K=0,Q=0,Y=0,Z=[],re=C.slice(0,512);wr(re,0);var le=f(re);switch(O=le[0],O){case 3:L=512;break;case 4:L=4096;break;case 0:if(le[1]==0)return cl(C,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}L!==512&&(re=C.slice(0,L),wr(re,28));var ke=C.slice(0,L);h(re,O);var ye=re.read_shift(4,"i");if(O===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);re.l+=4,K=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),Q=re.read_shift(4,"i"),U=re.read_shift(4,"i"),Y=re.read_shift(4,"i"),z=re.read_shift(4,"i");for(var ve=-1,Te=0;Te<109&&(ve=re.read_shift(4,"i"),!(ve<0));++Te)Z[Te]=ve;var We=d(C,L);m(Y,z,We,L,Z);var yt=k(We,K,Z,L);yt[K].name="!Directory",U>0&&Q!==R&&(yt[Q].name="!MiniFAT"),yt[Z[0]].name="!FAT",yt.fat_addrs=Z,yt.ssz=L;var vt={},_r=[],Qa=[],_a=[];b(K,yt,We,_r,U,vt,Qa,Q),p(Qa,_a,_r),_r.shift();var Ca={FileIndex:Qa,FullPaths:_a};return M&&M.raw&&(Ca.raw={header:ke,sectors:We}),Ca}function f(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(D,"Header Signature: "),C.l+=16;var M=C.read_shift(2,"u");return[C.read_shift(2,"u"),M]}function h(C,M){var O=9;switch(C.l+=2,O=C.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function d(C,M){for(var O=Math.ceil(C.length/M)-1,L=[],U=1;U<O;++U)L[U-1]=C.slice(U*M,(U+1)*M);return L[O-1]=C.slice(O*M),L}function p(C,M,O){for(var L=0,U=0,z=0,K=0,Q=0,Y=O.length,Z=[],re=[];L<Y;++L)Z[L]=re[L]=L,M[L]=O[L];for(;Q<re.length;++Q)L=re[Q],U=C[L].L,z=C[L].R,K=C[L].C,Z[L]===L&&(U!==-1&&Z[U]!==U&&(Z[L]=Z[U]),z!==-1&&Z[z]!==z&&(Z[L]=Z[z])),K!==-1&&(Z[K]=L),U!==-1&&L!=Z[L]&&(Z[U]=Z[L],re.lastIndexOf(U)<Q&&re.push(U)),z!==-1&&L!=Z[L]&&(Z[z]=Z[L],re.lastIndexOf(z)<Q&&re.push(z));for(L=1;L<Y;++L)Z[L]===L&&(z!==-1&&Z[z]!==z?Z[L]=Z[z]:U!==-1&&Z[U]!==U&&(Z[L]=Z[U]));for(L=1;L<Y;++L)if(C[L].type!==0){if(Q=L,Q!=Z[Q])do Q=Z[Q],M[L]=M[Q]+"/"+M[L];while(Q!==0&&Z[Q]!==-1&&Q!=Z[Q]);Z[L]=-1}for(M[0]+="/",L=1;L<Y;++L)C[L].type!==2&&(M[L]+="/")}function g(C,M,O){for(var L=C.start,U=C.size,z=[],K=L;O&&U>0&&K>=0;)z.push(M.slice(K*A,K*A+A)),U-=A,K=si(O,K*4);return z.length===0?ne(0):pr(z).slice(0,C.size)}function m(C,M,O,L,U){var z=R;if(C===R){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var K=O[C],Q=(L>>>2)-1;if(!K)return;for(var Y=0;Y<Q&&(z=si(K,Y*4))!==R;++Y)U.push(z);m(si(K,L-4),M-1,O,L,U)}}function y(C,M,O,L,U){var z=[],K=[];U||(U=[]);var Q=L-1,Y=0,Z=0;for(Y=M;Y>=0;){U[Y]=!0,z[z.length]=Y,K.push(C[Y]);var re=O[Math.floor(Y*4/L)];if(Z=Y*4&Q,L<4+Z)throw new Error("FAT boundary crossed: "+Y+" 4 "+L);if(!C[re])break;Y=si(C[re],Z)}return{nodes:z,data:Sb([K])}}function k(C,M,O,L){var U=C.length,z=[],K=[],Q=[],Y=[],Z=L-1,re=0,le=0,ke=0,ye=0;for(re=0;re<U;++re)if(Q=[],ke=re+M,ke>=U&&(ke-=U),!K[ke]){Y=[];var ve=[];for(le=ke;le>=0;){ve[le]=!0,K[le]=!0,Q[Q.length]=le,Y.push(C[le]);var Te=O[Math.floor(le*4/L)];if(ye=le*4&Z,L<4+ye)throw new Error("FAT boundary crossed: "+le+" 4 "+L);if(!C[Te]||(le=si(C[Te],ye),ve[le]))break}z[ke]={nodes:Q,data:Sb([Y])}}return z}function b(C,M,O,L,U,z,K,Q){for(var Y=0,Z=L.length?2:0,re=M[C].data,le=0,ke=0,ye;le<re.length;le+=128){var ve=re.slice(le,le+128);wr(ve,64),ke=ve.read_shift(2),ye=cd(ve,0,ke-Z),L.push(ye);var Te={name:ye,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},We=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);We!==0&&(Te.ct=w(ve,ve.l-8));var yt=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);yt!==0&&(Te.mt=w(ve,ve.l-8)),Te.start=ve.read_shift(4,"i"),Te.size=ve.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=R,Te.name=""),Te.type===5?(Y=Te.start,U>0&&Y!==R&&(M[Y].name="!StreamData")):Te.size>=4096?(Te.storage="fat",M[Te.start]===void 0&&(M[Te.start]=y(O,Te.start,M.fat_addrs,M.ssz)),M[Te.start].name=Te.name,Te.content=M[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:Y!==R&&Te.start!==R&&M[Y]&&(Te.content=g(Te,M[Y].data,(M[Q]||{}).data))),Te.content&&wr(Te.content,0),z[ye]=Te,K.push(Te)}}function w(C,M){return new Date((dr(C,M+4)/1e7*Math.pow(2,32)+dr(C,M)/1e7-11644473600)*1e3)}function N(C,M){return l(),c(o.readFileSync(C),M)}function _(C,M){var O=M&&M.type;switch(O||$e&&Buffer.isBuffer(C)&&(O="buffer"),O||"base64"){case"file":return N(C,M);case"base64":return c(hn(bn(C)),M);case"binary":return c(hn(C),M)}return c(C,M)}function F(C,M){var O=M||{},L=O.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=L+"/",C.FileIndex[0]={name:L,type:5}),O.CLSID&&(C.FileIndex[0].clsid=O.CLSID),T(C)}function T(C){var M="Sh33tJ5";if(!Ie.find(C,"/"+M)){var O=ne(4);O[0]=55,O[1]=O[3]=50,O[2]=54,C.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+M),S(C)}}function S(C,M){F(C);for(var O=!1,L=!1,U=C.FullPaths.length-1;U>=0;--U){var z=C.FileIndex[U];switch(z.type){case 0:L?O=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(z.R*z.L*z.C)&&(O=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var K=new Date(1987,1,19),Q=0,Y=Object.create?Object.create(null):{},Z=[];for(U=0;U<C.FullPaths.length;++U)Y[C.FullPaths[U]]=!0,C.FileIndex[U].type!==0&&Z.push([C.FullPaths[U],C.FileIndex[U]]);for(U=0;U<Z.length;++U){var re=r(Z[U][0]);L=Y[re],L||(Z.push([re,{name:n(re).replace("/",""),type:1,clsid:ue,ct:K,mt:K,content:null}]),Y[re]=!0)}for(Z.sort(function(ye,ve){return t(ye[0],ve[0])}),C.FullPaths=[],C.FileIndex=[],U=0;U<Z.length;++U)C.FullPaths[U]=Z[U][0],C.FileIndex[U]=Z[U][1];for(U=0;U<Z.length;++U){var le=C.FileIndex[U],ke=C.FullPaths[U];if(le.name=n(ke).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||ue,U===0)le.C=Z.length>1?1:-1,le.size=0,le.type=5;else if(ke.slice(-1)=="/"){for(Q=U+1;Q<Z.length&&r(C.FullPaths[Q])!=ke;++Q);for(le.C=Q>=Z.length?-1:Q,Q=U+1;Q<Z.length&&r(C.FullPaths[Q])!=r(ke);++Q);le.R=Q>=Z.length?-1:Q,le.type=1}else r(C.FullPaths[U+1]||"")==r(ke)&&(le.R=U+1),le.type=2}}}function x(C,M){var O=M||{};if(O.fileType=="mad")return bd(C,O);switch(S(C),O.fileType){case"zip":return gu(C,O)}var L=function(ye){for(var ve=0,Te=0,We=0;We<ye.FileIndex.length;++We){var yt=ye.FileIndex[We];if(yt.content){var vt=yt.content.length;vt>0&&(vt<4096?ve+=vt+63>>6:Te+=vt+511>>9)}}for(var _r=ye.FullPaths.length+3>>2,Qa=ve+7>>3,_a=ve+127>>7,Ca=Qa+Te+_r+_a,ta=Ca+127>>7,Hi=ta<=109?0:Math.ceil((ta-109)/127);Ca+ta+Hi+127>>7>ta;)Hi=++ta<=109?0:Math.ceil((ta-109)/127);var En=[1,Hi,ta,_a,_r,Te,ve,0];return ye.FileIndex[0].size=ve<<6,En[7]=(ye.FileIndex[0].start=En[0]+En[1]+En[2]+En[3]+En[4]+En[5])+(En[6]+7>>3),En}(C),U=ne(L[7]<<9),z=0,K=0;{for(z=0;z<8;++z)U.write_shift(1,de[z]);for(z=0;z<8;++z)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),z=0;z<3;++z)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,L[2]),U.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:R),U.write_shift(4,L[3]),U.write_shift(-4,L[1]?L[0]-1:R),U.write_shift(4,L[1]),z=0;z<109;++z)U.write_shift(-4,z<L[2]?L[1]+z:-1)}if(L[1])for(K=0;K<L[1];++K){for(;z<236+K*127;++z)U.write_shift(-4,z<L[2]?L[1]+z:-1);U.write_shift(-4,K===L[1]-1?R:K+1)}var Q=function(ye){for(K+=ye;z<K-1;++z)U.write_shift(-4,z+1);ye&&(++z,U.write_shift(-4,R))};for(K=z=0,K+=L[1];z<K;++z)U.write_shift(-4,xe.DIFSECT);for(K+=L[2];z<K;++z)U.write_shift(-4,xe.FATSECT);Q(L[3]),Q(L[4]);for(var Y=0,Z=0,re=C.FileIndex[0];Y<C.FileIndex.length;++Y)re=C.FileIndex[Y],re.content&&(Z=re.content.length,!(Z<4096)&&(re.start=K,Q(Z+511>>9)));for(Q(L[6]+7>>3);U.l&511;)U.write_shift(-4,xe.ENDOFCHAIN);for(K=z=0,Y=0;Y<C.FileIndex.length;++Y)re=C.FileIndex[Y],re.content&&(Z=re.content.length,!(!Z||Z>=4096)&&(re.start=K,Q(Z+63>>6)));for(;U.l&511;)U.write_shift(-4,xe.ENDOFCHAIN);for(z=0;z<L[4]<<2;++z){var le=C.FullPaths[z];if(!le||le.length===0){for(Y=0;Y<17;++Y)U.write_shift(4,0);for(Y=0;Y<3;++Y)U.write_shift(4,-1);for(Y=0;Y<12;++Y)U.write_shift(4,0);continue}re=C.FileIndex[z],z===0&&(re.start=re.size?re.start-1:R);var ke=z===0&&O.root||re.name;if(Z=2*(ke.length+1),U.write_shift(64,ke,"utf16le"),U.write_shift(2,Z),U.write_shift(1,re.type),U.write_shift(1,re.color),U.write_shift(-4,re.L),U.write_shift(-4,re.R),U.write_shift(-4,re.C),re.clsid)U.write_shift(16,re.clsid,"hex");else for(Y=0;Y<4;++Y)U.write_shift(4,0);U.write_shift(4,re.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,re.start),U.write_shift(4,re.size),U.write_shift(4,0)}for(z=1;z<C.FileIndex.length;++z)if(re=C.FileIndex[z],re.size>=4096)if(U.l=re.start+1<<9,$e&&Buffer.isBuffer(re.content))re.content.copy(U,U.l,0,re.size),U.l+=re.size+511&-512;else{for(Y=0;Y<re.size;++Y)U.write_shift(1,re.content[Y]);for(;Y&511;++Y)U.write_shift(1,0)}for(z=1;z<C.FileIndex.length;++z)if(re=C.FileIndex[z],re.size>0&&re.size<4096)if($e&&Buffer.isBuffer(re.content))re.content.copy(U,U.l,0,re.size),U.l+=re.size+63&-64;else{for(Y=0;Y<re.size;++Y)U.write_shift(1,re.content[Y]);for(;Y&63;++Y)U.write_shift(1,0)}if($e)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function I(C,M){var O=C.FullPaths.map(function(Y){return Y.toUpperCase()}),L=O.map(function(Y){var Z=Y.split("/");return Z[Z.length-(Y.slice(-1)=="/"?2:1)]}),U=!1;M.charCodeAt(0)===47?(U=!0,M=O[0].slice(0,-1)+M):U=M.indexOf("/")!==-1;var z=M.toUpperCase(),K=U===!0?O.indexOf(z):L.indexOf(z);if(K!==-1)return C.FileIndex[K];var Q=!z.match(Ul);for(z=z.replace(Ur,""),Q&&(z=z.replace(Ul,"!")),K=0;K<O.length;++K)if((Q?O[K].replace(Ul,"!"):O[K]).replace(Ur,"")==z||(Q?L[K].replace(Ul,"!"):L[K]).replace(Ur,"")==z)return C.FileIndex[K];return null}var A=64,R=-2,D="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:D,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(C,M,O){l();var L=x(C,O);o.writeFileSync(M,L)}function q(C){for(var M=new Array(C.length),O=0;O<C.length;++O)M[O]=String.fromCharCode(C[O]);return M.join("")}function te(C,M){var O=x(C,M);switch(M&&M.type||"buffer"){case"file":return l(),o.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:q(O);case"base64":return Mc(typeof O=="string"?O:q(O));case"buffer":if($e)return Buffer.isBuffer(O)?O:$a(O);case"array":return typeof O=="string"?hn(O):O}return O}var fe;function Ae(C){try{var M=C.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)fe=C;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function j(C,M){if(!fe)return ll(C,M);var O=fe.InflateRaw,L=new O,U=L._processChunk(C.slice(C.l),L._finishFlushFlag);return C.l+=L.bytesRead,U}function G(C){return fe?fe.deflateRawSync(C):Ve(C)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(C){var M=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(M>>16|M>>8|M)&255}for(var ie=typeof Uint8Array<"u",me=ie?new Uint8Array(256):[],pe=0;pe<256;++pe)me[pe]=he(pe);function je(C,M){var O=me[C&255];return M<=8?O>>>8-M:(O=O<<8|me[C>>8&255],M<=16?O>>>16-M:(O=O<<8|me[C>>16&255],O>>>24-M))}function V(C,M){var O=M&7,L=M>>>3;return(C[L]|(O<=6?0:C[L+1]<<8))>>>O&3}function it(C,M){var O=M&7,L=M>>>3;return(C[L]|(O<=5?0:C[L+1]<<8))>>>O&7}function Je(C,M){var O=M&7,L=M>>>3;return(C[L]|(O<=4?0:C[L+1]<<8))>>>O&15}function ot(C,M){var O=M&7,L=M>>>3;return(C[L]|(O<=3?0:C[L+1]<<8))>>>O&31}function ze(C,M){var O=M&7,L=M>>>3;return(C[L]|(O<=1?0:C[L+1]<<8))>>>O&127}function we(C,M,O){var L=M&7,U=M>>>3,z=(1<<O)-1,K=C[U]>>>L;return O<8-L||(K|=C[U+1]<<8-L,O<16-L)||(K|=C[U+2]<<16-L,O<24-L)||(K|=C[U+3]<<24-L),K&z}function Lt(C,M,O){var L=M&7,U=M>>>3;return L<=5?C[U]|=(O&7)<<L:(C[U]|=O<<L&255,C[U+1]=(O&7)>>8-L),M+3}function dt(C,M,O){var L=M&7,U=M>>>3;return O=(O&1)<<L,C[U]|=O,M+1}function st(C,M,O){var L=M&7,U=M>>>3;return O<<=L,C[U]|=O&255,O>>>=8,C[U+1]=O,M+8}function ea(C,M,O){var L=M&7,U=M>>>3;return O<<=L,C[U]|=O&255,O>>>=8,C[U+1]=O&255,C[U+2]=O>>>8,M+16}function Ka(C,M){var O=C.length,L=2*O>M?2*O:M+5,U=0;if(O>=M)return C;if($e){var z=sb(L);if(C.copy)C.copy(z);else for(;U<C.length;++U)z[U]=C[U];return z}else if(ie){var K=new Uint8Array(L);if(K.set)K.set(C);else for(;U<O;++U)K[U]=C[U];return K}return C.length=L,C}function lr(C){for(var M=new Array(C),O=0;O<C;++O)M[O]=0;return M}function Sa(C,M,O){var L=1,U=0,z=0,K=0,Q=0,Y=C.length,Z=ie?new Uint16Array(32):lr(32);for(z=0;z<32;++z)Z[z]=0;for(z=Y;z<O;++z)C[z]=0;Y=C.length;var re=ie?new Uint16Array(Y):lr(Y);for(z=0;z<Y;++z)Z[U=C[z]]++,L<U&&(L=U),re[z]=0;for(Z[0]=0,z=1;z<=L;++z)Z[z+16]=Q=Q+Z[z-1]<<1;for(z=0;z<Y;++z)Q=C[z],Q!=0&&(re[z]=Z[Q+16]++);var le=0;for(z=0;z<Y;++z)if(le=C[z],le!=0)for(Q=je(re[z],L)>>L-le,K=(1<<L+4-le)-1;K>=0;--K)M[Q|K<<le]=le&15|z<<4;return L}var Qr=ie?new Uint16Array(512):lr(512),Vn=ie?new Uint16Array(32):lr(32);if(!ie){for(var Tn=0;Tn<512;++Tn)Qr[Tn]=0;for(Tn=0;Tn<32;++Tn)Vn[Tn]=0}(function(){for(var C=[],M=0;M<32;M++)C.push(5);Sa(C,Vn,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);Sa(O,Qr,288)})();var on=function(){for(var C=ie?new Uint8Array(32768):[],M=0,O=0;M<ee.length-1;++M)for(;O<ee[M+1];++O)C[O]=M;for(;O<32768;++O)C[O]=29;var L=ie?new Uint8Array(259):[];for(M=0,O=0;M<H.length-1;++M)for(;O<H[M+1];++O)L[O]=M;function U(K,Q){for(var Y=0;Y<K.length;){var Z=Math.min(65535,K.length-Y),re=Y+Z==K.length;for(Q.write_shift(1,+re),Q.write_shift(2,Z),Q.write_shift(2,~Z&65535);Z-- >0;)Q[Q.l++]=K[Y++]}return Q.l}function z(K,Q){for(var Y=0,Z=0,re=ie?new Uint16Array(32768):[];Z<K.length;){var le=Math.min(65535,K.length-Z);if(le<10){for(Y=Lt(Q,Y,+(Z+le==K.length)),Y&7&&(Y+=8-(Y&7)),Q.l=Y/8|0,Q.write_shift(2,le),Q.write_shift(2,~le&65535);le-- >0;)Q[Q.l++]=K[Z++];Y=Q.l*8;continue}Y=Lt(Q,Y,+(Z+le==K.length)+2);for(var ke=0;le-- >0;){var ye=K[Z];ke=(ke<<5^ye)&32767;var ve=-1,Te=0;if((ve=re[ke])&&(ve|=Z&-32768,ve>Z&&(ve-=32768),ve<Z))for(;K[ve+Te]==K[Z+Te]&&Te<250;)++Te;if(Te>2){ye=L[Te],ye<=22?Y=st(Q,Y,me[ye+1]>>1)-1:(st(Q,Y,3),Y+=5,st(Q,Y,me[ye-23]>>5),Y+=3);var We=ye<8?0:ye-4>>2;We>0&&(ea(Q,Y,Te-H[ye]),Y+=We),ye=C[Z-ve],Y=st(Q,Y,me[ye]>>3),Y-=3;var yt=ye<4?0:ye-2>>1;yt>0&&(ea(Q,Y,Z-ve-ee[ye]),Y+=yt);for(var vt=0;vt<Te;++vt)re[ke]=Z&32767,ke=(ke<<5^K[Z])&32767,++Z;le-=Te-1}else ye<=143?ye=ye+48:Y=dt(Q,Y,1),Y=st(Q,Y,me[ye]),re[ke]=Z&32767,++Z}Y=st(Q,Y,0)-1}return Q.l=(Y+7)/8|0,Q.l}return function(K,Q){return K.length<8?U(K,Q):z(K,Q)}}();function Ve(C){var M=ne(50+Math.floor(C.length*1.1)),O=on(C,M);return M.slice(0,O)}var mt=ie?new Uint16Array(32768):lr(32768),Wr=ie?new Uint16Array(32768):lr(32768),Ft=ie?new Uint16Array(128):lr(128),ln=1,Wi=1;function ol(C,M){var O=ot(C,M)+257;M+=5;var L=ot(C,M)+1;M+=5;var U=Je(C,M)+4;M+=4;for(var z=0,K=ie?new Uint8Array(19):lr(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Z=ie?new Uint8Array(8):lr(8),re=ie?new Uint8Array(8):lr(8),le=K.length,ke=0;ke<U;++ke)K[W[ke]]=z=it(C,M),Y<z&&(Y=z),Z[z]++,M+=3;var ye=0;for(Z[0]=0,ke=1;ke<=Y;++ke)re[ke]=ye=ye+Z[ke-1]<<1;for(ke=0;ke<le;++ke)(ye=K[ke])!=0&&(Q[ke]=re[ye]++);var ve=0;for(ke=0;ke<le;++ke)if(ve=K[ke],ve!=0){ye=me[Q[ke]]>>8-ve;for(var Te=(1<<7-ve)-1;Te>=0;--Te)Ft[ye|Te<<ve]=ve&7|ke<<3}var We=[];for(Y=1;We.length<O+L;)switch(ye=Ft[ze(C,M)],M+=ye&7,ye>>>=3){case 16:for(z=3+V(C,M),M+=2,ye=We[We.length-1];z-- >0;)We.push(ye);break;case 17:for(z=3+it(C,M),M+=3;z-- >0;)We.push(0);break;case 18:for(z=11+ze(C,M),M+=7;z-- >0;)We.push(0);break;default:We.push(ye),Y<ye&&(Y=ye);break}var yt=We.slice(0,O),vt=We.slice(O);for(ke=O;ke<286;++ke)yt[ke]=0;for(ke=L;ke<30;++ke)vt[ke]=0;return ln=Sa(yt,mt,286),Wi=Sa(vt,Wr,30),M}function xa(C,M){if(C[0]==3&&!(C[1]&3))return[js(M),2];for(var O=0,L=0,U=sb(M||1<<18),z=0,K=U.length>>>0,Q=0,Y=0;!(L&1);){if(L=it(C,O),O+=3,L>>>1)L>>1==1?(Q=9,Y=5):(O=ol(C,O),Q=ln,Y=Wi);else{O&7&&(O+=8-(O&7));var Z=C[O>>>3]|C[(O>>>3)+1]<<8;if(O+=32,Z>0)for(!M&&K<z+Z&&(U=Ka(U,z+Z),K=U.length);Z-- >0;)U[z++]=C[O>>>3],O+=8;continue}for(;;){!M&&K<z+32767&&(U=Ka(U,z+32767),K=U.length);var re=we(C,O,Q),le=L>>>1==1?Qr[re]:mt[re];if(O+=le&15,le>>>=4,!(le>>>8&255))U[z++]=le;else{if(le==256)break;le-=257;var ke=le<8?0:le-4>>2;ke>5&&(ke=0);var ye=z+H[le];ke>0&&(ye+=we(C,O,ke),O+=ke),re=we(C,O,Y),le=L>>>1==1?Vn[re]:Wr[re],O+=le&15,le>>>=4;var ve=le<4?0:le-2>>1,Te=ee[le];for(ve>0&&(Te+=we(C,O,ve),O+=ve),!M&&K<ye&&(U=Ka(U,ye+100),K=U.length);z<ye;)U[z]=U[z-Te],++z}}}return M?[U,O+7>>>3]:[U.slice(0,z),O+7>>>3]}function ll(C,M){var O=C.slice(C.l||0),L=xa(O,M);return C.l+=L[1],L[0]}function Ys(C,M){if(C)typeof console<"u"&&console.error(M);else throw new Error(M)}function cl(C,M){var O=C;wr(O,0);var L=[],U=[],z={FileIndex:L,FullPaths:U};F(z,{root:M.root});for(var K=O.length-4;(O[K]!=80||O[K+1]!=75||O[K+2]!=5||O[K+3]!=6)&&K>=0;)--K;O.l=K+4,O.l+=4;var Q=O.read_shift(2);O.l+=6;var Y=O.read_shift(4);for(O.l=Y,K=0;K<Q;++K){O.l+=20;var Z=O.read_shift(4),re=O.read_shift(4),le=O.read_shift(2),ke=O.read_shift(2),ye=O.read_shift(2);O.l+=8;var ve=O.read_shift(4),Te=i(O.slice(O.l+le,O.l+le+ke));O.l+=le+ke+ye;var We=O.l;O.l=ve+4,Qs(O,Z,re,z,Te),O.l=We}return z}function Qs(C,M,O,L,U){C.l+=2;var z=C.read_shift(2),K=C.read_shift(2),Q=s(C);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var Y=C.read_shift(4),Z=C.read_shift(4),re=C.read_shift(4),le=C.read_shift(2),ke=C.read_shift(2),ye="",ve=0;ve<le;++ve)ye+=String.fromCharCode(C[C.l++]);if(ke){var Te=i(C.slice(C.l,C.l+ke));(Te[21589]||{}).mt&&(Q=Te[21589].mt),((U||{})[21589]||{}).mt&&(Q=U[21589].mt)}C.l+=ke;var We=C.slice(C.l,C.l+Z);switch(K){case 8:We=j(C,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var yt=!1;z&8&&(Y=C.read_shift(4),Y==134695760&&(Y=C.read_shift(4),yt=!0),Z=C.read_shift(4),re=C.read_shift(4)),Z!=M&&Ys(yt,"Bad compressed size: "+M+" != "+Z),re!=O&&Ys(yt,"Bad uncompressed size: "+O+" != "+re),Ya(L,ye,We,{unsafe:!0,mt:Q})}function gu(C,M){var O=M||{},L=[],U=[],z=ne(1),K=O.compression?8:0,Q=0,Y=0,Z=0,re=0,le=0,ke=C.FullPaths[0],ye=ke,ve=C.FileIndex[0],Te=[],We=0;for(Y=1;Y<C.FullPaths.length;++Y)if(ye=C.FullPaths[Y].slice(ke.length),ve=C.FileIndex[Y],!(!ve.size||!ve.content||ye=="Sh33tJ5")){var yt=re,vt=ne(ye.length);for(Z=0;Z<ye.length;++Z)vt.write_shift(1,ye.charCodeAt(Z)&127);vt=vt.slice(0,vt.l),Te[le]=oN.buf(ve.content,0);var _r=ve.content;K==8&&(_r=G(_r)),z=ne(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,Q),z.write_shift(2,K),ve.mt?a(z,ve.mt):z.write_shift(4,0),z.write_shift(-4,Te[le]),z.write_shift(4,_r.length),z.write_shift(4,ve.content.length),z.write_shift(2,vt.length),z.write_shift(2,0),re+=z.length,L.push(z),re+=vt.length,L.push(vt),re+=_r.length,L.push(_r),z=ne(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,Q),z.write_shift(2,K),z.write_shift(4,0),z.write_shift(-4,Te[le]),z.write_shift(4,_r.length),z.write_shift(4,ve.content.length),z.write_shift(2,vt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,yt),We+=z.l,U.push(z),We+=vt.length,U.push(vt),++le}return z=ne(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,le),z.write_shift(2,le),z.write_shift(4,We),z.write_shift(4,re),z.write_shift(2,0),pr([pr(L),pr(U),z])}var Zt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vu(C,M){if(C.ctype)return C.ctype;var O=C.name||"",L=O.match(/\.([^\.]+)$/);return L&&Zt[L[1]]||M&&(L=(O=M).match(/[\.\\]([^\.\\])+$/),L&&Zt[L[1]])?Zt[L[1]]:"application/octet-stream"}function Js(C){for(var M=Mc(C),O=[],L=0;L<M.length;L+=76)O.push(M.slice(L,L+76));return O.join(`\r
`)+`\r
`}function Zs(C){var M=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var re=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],L=M.split(`\r
`),U=0;U<L.length;++U){var z=L[U];if(z.length==0){O.push("");continue}for(var K=0;K<z.length;){var Q=76,Y=z.slice(K,K+Q);Y.charAt(Q-1)=="="?Q--:Y.charAt(Q-2)=="="?Q-=2:Y.charAt(Q-3)=="="&&(Q-=3),Y=z.slice(K,K+Q),K+=Q,K<z.length&&(Y+="="),O.push(Y)}}return O.join(`\r
`)}function gd(C){for(var M=[],O=0;O<C.length;++O){for(var L=C[O];O<=C.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+C[++O];M.push(L)}for(var U=0;U<M.length;++U)M[U]=M[U].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return hn(M.join(`\r
`))}function vd(C,M,O){for(var L="",U="",z="",K,Q=0;Q<10;++Q){var Y=M[Q];if(!Y||Y.match(/^\s*$/))break;var Z=Y.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":L=Z[2].trim();break;case"content-type":z=Z[2].trim();break;case"content-transfer-encoding":U=Z[2].trim();break}}switch(++Q,U.toLowerCase()){case"base64":K=hn(bn(M.slice(Q).join("")));break;case"quoted-printable":K=gd(M.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var re=Ya(C,L.slice(O.length),K,{unsafe:!0});z&&(re.ctype=z)}function Xa(C,M){if(q(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",L=($e&&Buffer.isBuffer(C)?C.toString("binary"):q(C)).split(`\r
`),U=0,z="";for(U=0;U<L.length;++U)if(z=L[U],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),O||(O=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),z.slice(0,O.length)!=O););var K=(L[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var Q="--"+(K[1]||""),Y=[],Z=[],re={FileIndex:Y,FullPaths:Z};F(re);var le,ke=0;for(U=0;U<L.length;++U){var ye=L[U];ye!==Q&&ye!==Q+"--"||(ke++&&vd(re,L.slice(le,U),O),le=U)}return re}function bd(C,M){var O=M||{},L=O.boundary||"SheetJS";L="------="+L;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],z=C.FullPaths[0],K=z,Q=C.FileIndex[0],Y=1;Y<C.FullPaths.length;++Y)if(K=C.FullPaths[Y].slice(z.length),Q=C.FileIndex[Y],!(!Q.size||!Q.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var Z=Q.content,re=$e&&Buffer.isBuffer(Z)?Z.toString("binary"):q(Z),le=0,ke=Math.min(1024,re.length),ye=0,ve=0;ve<=ke;++ve)(ye=re.charCodeAt(ve))>=32&&ye<128&&++le;var Te=le>=ke*4/5;U.push(L),U.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+K),U.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),U.push("Content-Type: "+vu(Q,K)),U.push(""),U.push(Te?Zs(re):Js(re))}return U.push(L+`--\r
`),U.join(`\r
`)}function yd(C){var M={};return F(M,C),M}function Ya(C,M,O,L){var U=L&&L.unsafe;U||F(C);var z=!U&&Ie.find(C,M);if(!z){var K=C.FullPaths[0];M.slice(0,K.length)==K?K=M:(K.slice(-1)!="/"&&(K+="/"),K=(K+M).replace("//","/")),z={name:n(M),type:2},C.FileIndex.push(z),C.FullPaths.push(K),U||Ie.utils.cfb_gc(C)}return z.content=O,z.size=O?O.length:0,L&&(L.CLSID&&(z.clsid=L.CLSID),L.mt&&(z.mt=L.mt),L.ct&&(z.ct=L.ct)),z}function bu(C,M){F(C);var O=Ie.find(C,M);if(O){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==O)return C.FileIndex.splice(L,1),C.FullPaths.splice(L,1),!0}return!1}function yu(C,M,O){F(C);var L=Ie.find(C,M);if(L){for(var U=0;U<C.FileIndex.length;++U)if(C.FileIndex[U]==L)return C.FileIndex[U].name=n(O),C.FullPaths[U]=O,!0}return!1}function ul(C){S(C,!0)}return e.find=I,e.read=_,e.parse=c,e.write=te,e.writeFile=Se,e.utils={cfb_new:yd,cfb_add:Ya,cfb_del:bu,cfb_mov:yu,cfb_gc:ul,ReadShift:ec,CheckField:q3,prep_blob:wr,bconcat:pr,use_zlib:Ae,_deflateRaw:Ve,_inflateRaw:ll,consts:xe},e}();let vs;function lN(e){vs=e}function cN(e){return typeof e=="string"?ou(e):Array.isArray(e)?P8(e):e}function cu(e,t,r){if(typeof vs<"u"&&vs.writeFileSync)return r?vs.writeFileSync(e,t,r):vs.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ou(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?fa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([cN(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=qs(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function uN(e){if(typeof vs<"u")return vs.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function db(e,t){for(var r=[],n=Bt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function id(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function od(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function fN(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var bh=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=bh.getTime()+(e.getTimezoneOffset()-bh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var I3=new Date,hN=bh.getTime()+(I3.getTimezoneOffset()-bh.getTimezoneOffset())*6e4,pb=I3.getTimezoneOffset();function ld(e){var t=new Date;return t.setTime(e*24*60*60*1e3+hN),t.getTimezoneOffset()!==pb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-pb)*6e4),t}function dN(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var mb=new Date("2017-02-19T19:06:09.000Z"),R3=isNaN(mb.getFullYear())?new Date("2/19/17"):mb,pN=R3.getFullYear()==2017;function Ct(e,t){var r=new Date(e);if(pN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(R3.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xi(e,t){if($e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return fa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fa(v3(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return fa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function gt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=gt(e[r]));return t}function jt(e,t){for(var r="";r.length<t;)r+=e;return r}function Qn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var mN=["january","february","march","april","may","june","july","august","september","october","november","december"];function $o(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&mN.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var gN=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,n){if(e||typeof r=="string")return t.split(r);for(var a=t.split(r),s=[a[0]],i=1;i<a.length;++i)s.push(n),s.push(a[i]);return s}}();function D3(e){return e?e.content&&e.type?xi(e.content,!0):e.data?go(e.data):e.asNodeBuffer&&$e?go(e.asNodeBuffer().toString("binary")):e.asBinary?go(e.asBinary()):e._data&&e._data.getContent?go(xi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function O3(e){if(!e)return null;if(e.data)return ph(e.data);if(e.asNodeBuffer&&$e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?ph(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function vN(e){return e&&e.name.slice(-4)===".bin"?O3(e):D3(e)}function An(e,t){for(var r=e.FullPaths||Bt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Nm(e,t){var r=An(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Xt(e,t,r){if(!r)return vN(Nm(e,t));if(!t)return null;try{return Xt(e,t)}catch{return null}}function dn(e,t,r){if(!r)return D3(Nm(e,t));if(!t)return null;try{return dn(e,t)}catch{return null}}function bN(e,t,r){return O3(Nm(e,t))}function gb(e){for(var t=e.FullPaths||Bt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Be(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return $e?n=$a(r):n=L8(r),Ie.utils.cfb_add(e,t,n)}Ie.utils.cfb_add(e,t,r)}else e.file(t,r)}function Im(){return Ie.utils.cfb_new()}function P3(e,t){switch(t.type){case"base64":return Ie.read(e,{type:"base64"});case"binary":return Ie.read(e,{type:"binary"});case"buffer":case"array":return Ie.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Gt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,vb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,wN=/<[^>]*>/g,Br=Gt.match(vb)?vb:wN,kN=/<\w*:/,TN=/<(\/?)\w+:/;function Le(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(yN),o=0,l="",c=0,f="",h="",d=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(a=h.charCodeAt(s+1))==34||a==39?1:0,l=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ta(e){return e.replace(TN,"<$1")}var L3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rm=id(L3),nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return L3[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Dm=/[&<>'"]/g,EN=/[\u0000-\u0008\u000b-\u001f]/g;function ft(e){var t=e+"";return t.replace(Dm,function(r){return Rm[r]}).replace(EN,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bb(e){return ft(e).replace(/ /g,"_x0020_")}var F3=/[\u0000-\u001f]/g;function Om(e){var t=e+"";return t.replace(Dm,function(r){return Rm[r]}).replace(/\n/g,"<br/>").replace(F3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function SN(e){var t=e+"";return t.replace(Dm,function(r){return Rm[r]}).replace(F3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var yb=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(r){return r.replace(e,t)}}();function xN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Et(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function fp(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function wb(e){var t=js(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function kb(e){return $a(e,"binary").toString("utf8")}var Zu="foo bar baz",pt=$e&&(kb(Zu)==fp(Zu)&&kb||wb(Zu)==fp(Zu)&&wb)||fp,fa=$e?function(e){return $a(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},jc=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),M3=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),_N=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),CN=/<\/?(?:vt:)?variant>/g,AN=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tb(e,t){var r=Le(e),n=e.match(_N(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(CN,"").match(AN);i&&a.push({v:pt(i[2]),t:i[1]})}),a}var U3=/(^\s|\s$|\n)/;function Tr(e,t){return"<"+e+(t.match(U3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function zc(e){return Bt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ge(e,t,r){return"<"+e+(r!=null?zc(r):"")+(t!=null?(t.match(U3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function z1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function NN(e,t){switch(typeof e){case"string":var r=ge("vt:lpwstr",ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ge((e|0)==e?"vt:i4":"vt:r8",ft(String(e)));case"boolean":return ge("vt:bool",e?"true":"false")}if(e instanceof Date)return ge("vt:filetime",z1(e));throw new Error("Unable to serialize "+e)}function Pm(e){if($e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return pt(qs(_m(e)));throw new Error("Bad input format: expected Buffer or string")}var Vc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Mi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function RN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Eb=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Sb=$e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:$a(t)})):Eb(e)}:Eb,xb=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Da(e,a)));return n.join("").replace(Ur,"")},cd=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ur,""):xb(e,t,r)}:xb,_b=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},j3=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):_b(e,t,r)}:_b,Cb=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ro(e,a)));return n.join("")},al=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Cb(e,t,r)}:Cb,z3=function(e,t){var r=dr(e,t);return r>0?al(e,t+4,t+4+r-1):""},Lm=z3,V3=function(e,t){var r=dr(e,t);return r>0?al(e,t+4,t+4+r-1):""},Fm=V3,B3=function(e,t){var r=2*dr(e,t);return r>0?al(e,t+4,t+4+r-1):""},Mm=B3,W3=function(e,t){var r=dr(e,t);return r>0?cd(e,t+4,t+4+r):""},Um=W3,H3=function(e,t){var r=dr(e,t);return r>0?al(e,t+4,t+4+r):""},jm=H3,$3=function(e,t){return IN(e,t)},yh=$3,zm=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};$e&&(Lm=function(e,t){if(!Buffer.isBuffer(e))return z3(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Fm=function(e,t){if(!Buffer.isBuffer(e))return V3(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Mm=function(e,t){if(!Buffer.isBuffer(e))return B3(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Um=function(e,t){if(!Buffer.isBuffer(e))return W3(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},jm=function(e,t){if(!Buffer.isBuffer(e))return H3(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},yh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):$3(e,t)},zm=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function G3(){cd=function(e,t,r){return tt.utils.decode(1200,e.slice(t,r)).replace(Ur,"")},al=function(e,t,r){return tt.utils.decode(65001,e.slice(t,r))},Lm=function(e,t){var r=dr(e,t);return r>0?tt.utils.decode(Ei,e.slice(t+4,t+4+r-1)):""},Fm=function(e,t){var r=dr(e,t);return r>0?tt.utils.decode(gn,e.slice(t+4,t+4+r-1)):""},Mm=function(e,t){var r=2*dr(e,t);return r>0?tt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Um=function(e,t){var r=dr(e,t);return r>0?tt.utils.decode(1200,e.slice(t+4,t+4+r)):""},jm=function(e,t){var r=dr(e,t);return r>0?tt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof tt<"u"&&G3();var ro=function(e,t){return e[t]},Da=function(e,t){return e[t+1]*256+e[t]},DN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},dr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},si=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ON=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ec(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,$e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Da(this,c)),c+=2;e*=2;break;case"utf8":r=al(this,this.l,this.l+e);break;case"utf16le":e*=2,r=cd(this,this.l,this.l+e);break;case"wstr":if(typeof tt<"u")r=tt.utils.decode(gn,this.slice(this.l,this.l+2*e));else return ec.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Lm(this,this.l),e=4+dr(this,this.l);break;case"lpstr-cp":r=Fm(this,this.l),e=4+dr(this,this.l);break;case"lpwstr":r=Mm(this,this.l),e=4+2*dr(this,this.l);break;case"lpp4":e=4+dr(this,this.l),r=Um(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+dr(this,this.l),r=jm(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ro(this,this.l+e++))!==0;)s.push(Ml(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Da(this,this.l+e))!==0;)s.push(Ml(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=ro(this,c),this.l=c+1,o=ec.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ml(Da(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof tt<"u"){r=tt.utils.decode(gn,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=ro(this,c),this.l=c+1,o=ec.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ml(ro(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=ro(this,this.l),this.l++,n;case 2:return n=(t==="i"?DN:Da)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?si:ON)(this,this.l),this.l+=4,n):(a=dr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=yh(this,this.l):a=yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=j3(this,this.l,e);break}}return this.l+=e,r}var PN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},LN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},FN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function MN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)FN(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof tt<"u"&&Ei==874)for(a=0;a!=t.length;++a){var s=tt.utils.encode(Ei,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,PN(this,t,this.l);break;case 8:if(n=8,r==="f"){RN(this,t,this.l);break}case 16:break;case-4:n=4,LN(this,t,this.l);break}return this.l+=n,this}function q3(e,t){var r=j3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=ec,e.chk=q3,e.write_shift=MN}function Vr(e,t){e.l+=t}function ne(e){var t=js(e);return wr(t,0),t}function Ga(e,t,r){if(e){var n,a,s;wr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=qc[o]||qc[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function sn(){var e=[],t=$e?256:2048,r=function(l){var c=ne(l);return wr(c,0),c},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(a(),n=r(Math.max(l+1,t)))},i=function(){return a(),pr(e)},o=function(l){a(),n=l,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function se(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=qc[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&zm(r)&&e.push(r)}}function tc(e,t,r){var n=gt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ab(e,t,r){var n=gt(e);return n.s=tc(n.s,t.s,r),n.e=tc(n.e,t.s,r),n}function rc(e,t){if(e.cRel&&e.c<0)for(e=gt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=gt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Oe(e);return!e.cRel&&e.cRel!=null&&(r=zN(r)),!e.rRel&&e.rRel!=null&&(r=UN(r)),r}function hp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+_t(e.s.c)+":"+(e.e.cRel?"":"$")+_t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):rc(e.s,t.biff)+":"+rc(e.e,t.biff)}function Vm(e){return parseInt(jN(e),10)-1}function zt(e){return""+(e+1)}function UN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jN(e){return e.replace(/\$(\d+)$/,"$1")}function Bm(e){for(var t=VN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function _t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function zN(e){return e.replace(/^([A-Z])/,"$$$1")}function VN(e){return e.replace(/^\$([A-Z])/,"$1")}function BN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Rt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Oe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Kr(e){var t=e.indexOf(":");return t==-1?{s:Rt(e),e:Rt(e)}:{s:Rt(e.slice(0,t)),e:Rt(e.slice(t+1))}}function Ue(e,t){return typeof t>"u"||typeof t=="number"?Ue(e.s,e.e):(typeof e!="string"&&(e=Oe(e)),typeof t!="string"&&(t=Oe(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Nb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=yn(e.z,r?or(t):t)}catch{}try{return e.w=yn((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function ka(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?qa[e.v]||e.v:t==null?Nb(e,e.v):Nb(e,t))}function Ks(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function K3(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Rt(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Qe(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var p={v:t[h][d]},g=i+h,m=o+d;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))p=t[h][d];else if(Array.isArray(p.v)&&(p.f=t[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Re[14],n.cellDates?(p.t="d",p.w=yn(p.z,or(p.v))):(p.t="n",p.v=or(p.v),p.w=yn(p.z,p.v))):p.t="s";if(a)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(p.z=s[g][m].z),s[g][m]=p;else{var y=Oe({c:m,r:g});s[y]&&s[y].z&&(p.z=s[y].z),s[y]=p}}}return c.s.c<1e7&&(s["!ref"]=Ue(c)),s}function sl(e,t){return K3(null,e,t)}function WN(e){return e.read_shift(4,"i")}function Jn(e,t){return t||(t=ne(4)),t.write_shift(4,e),t}function jr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function mr(e,t){var r=!1;return t==null&&(r=!0,t=ne(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function HN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $N(e,t){return t||(t=ne(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Wm(e,t){var r=e.l,n=e.read_shift(1),a=jr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(HN(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function GN(e,t){var r=!1;return t==null&&(r=!0,t=ne(15+4*e.t.length)),t.write_shift(1,0),mr(e.t,t),r?t.slice(0,t.l):t}var qN=Wm;function KN(e,t){var r=!1;return t==null&&(r=!0,t=ne(23+4*e.t.length)),t.write_shift(1,1),mr(e.t,t),t.write_shift(4,1),$N({},t),r?t.slice(0,t.l):t}function zn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ui(e,t){return t==null&&(t=ne(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ji(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function zi(e,t){return t==null&&(t=ne(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var XN=jr,X3=mr;function Hm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function wh(e,t){var r=!1;return t==null&&(r=!0,t=ne(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var YN=jr,V1=Hm,$m=wh;function Gm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?yh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):si(t,0)>>2;return r?a/100:a}function Y3(e,t){t==null&&(t=ne(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Q3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function QN(e,t){return t||(t=ne(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Vi=Q3,il=QN;function Mr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _i(e,t){return(t||ne(8)).write_shift(8,e,"f")}function JN(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Ao[a];c&&(t.rgb=Wc(c));break;case 2:t.rgb=Wc([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function kh(e,t){if(t||(t=ne(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function ZN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function eI(e,t){t||(t=ne(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function J3(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function tI(e){return J3(e,1)}function rI(e){return J3(e,2)}var qm=2,Jr=3,ef=11,Ib=12,Th=19,tf=64,nI=65,aI=71,sI=4108,iI=4126,fr=80,Z3=81,oI=[fr,Z3],B1={1:{n:"CodePage",t:qm},2:{n:"Category",t:fr},3:{n:"PresentationFormat",t:fr},4:{n:"ByteCount",t:Jr},5:{n:"LineCount",t:Jr},6:{n:"ParagraphCount",t:Jr},7:{n:"SlideCount",t:Jr},8:{n:"NoteCount",t:Jr},9:{n:"HiddenCount",t:Jr},10:{n:"MultimediaClipCount",t:Jr},11:{n:"ScaleCrop",t:ef},12:{n:"HeadingPairs",t:sI},13:{n:"TitlesOfParts",t:iI},14:{n:"Manager",t:fr},15:{n:"Company",t:fr},16:{n:"LinksUpToDate",t:ef},17:{n:"CharacterCount",t:Jr},19:{n:"SharedDoc",t:ef},22:{n:"HyperlinksChanged",t:ef},23:{n:"AppVersion",t:Jr,p:"version"},24:{n:"DigSig",t:nI},26:{n:"ContentType",t:fr},27:{n:"ContentStatus",t:fr},28:{n:"Language",t:fr},29:{n:"Version",t:fr},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},W1={1:{n:"CodePage",t:qm},2:{n:"Title",t:fr},3:{n:"Subject",t:fr},4:{n:"Author",t:fr},5:{n:"Keywords",t:fr},6:{n:"Comments",t:fr},7:{n:"Template",t:fr},8:{n:"LastAuthor",t:fr},9:{n:"RevNumber",t:fr},10:{n:"EditTime",t:tf},11:{n:"LastPrinted",t:tf},12:{n:"CreatedDate",t:tf},13:{n:"ModifiedDate",t:tf},14:{n:"PageCount",t:Jr},15:{n:"WordCount",t:Jr},16:{n:"CharCount",t:Jr},17:{n:"Thumbnail",t:aI},18:{n:"Application",t:fr},19:{n:"DocSecurity",t:Jr},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},Rb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var uI=cI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ao=gt(uI),qa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},eT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},H1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},rf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Km(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fI(e){var t=Km();if(!e||!e.match)return t;var r={};if((e.match(Br)||[]).forEach(function(n){var a=Le(n);switch(a[0].replace(kN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[H1[a.ContentType]]!==void 0&&t[H1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==nr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function tT(e,t){var r=fN(H1),n=[],a;n[n.length]=Gt,n[n.length]=ge("Types",null,{xmlns:nr.CT,"xmlns:xsd":nr.xsd,"xmlns:xsi":nr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ge("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=ge("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:rf[l][t.bookType]||rf[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){n[n.length]=ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:rf[l][t.bookType]||rf[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function nc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Br)||[]).forEach(function(a){var s=Le(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:jl(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function No(e){var t=[Gt,ge("Relationships",null,{xmlns:nr.RELS})];return Bt(e["!id"]).forEach(function(r){t[t.length]=ge("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ut(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var hI="application/vnd.oasis.opendocument.spreadsheet";function dI(e,t){for(var r=Pm(e),n,a;n=Vc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Le(n[0],!1),a.path=="/"&&a.type!==hI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function pI(e){var t=[Gt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Db(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function mI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function gI(e){var t=[Gt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Db(e[r][0],e[r][1])),t.push(mI("",e[r][0]));return t.push(Db("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function rT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Fc.version+"</meta:generator></office:meta></office:document-meta>"}var Mn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vI=function(){for(var e=new Array(Mn.length),t=0;t<Mn.length;++t){var r=Mn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function nT(e){var t={};e=pt(e);for(var r=0;r<Mn.length;++r){var n=Mn[r],a=e.match(vI[r]);a!=null&&a.length>0&&(t[n[1]]=nt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ct(t[n[1]]))}return t}function dp(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=ft(t),n[n.length]=r?ge(e,t,r):Tr(e,t))}function aT(e,t){var r=t||{},n=[Gt,ge("cp:coreProperties",null,{"xmlns:cp":nr.CORE_PROPS,"xmlns:dc":nr.dc,"xmlns:dcterms":nr.dcterms,"xmlns:dcmitype":nr.dcmitype,"xmlns:xsi":nr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&dp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:z1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&dp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:z1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Mn.length;++s){var i=Mn[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&dp(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var pi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],sT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function iT(e,t,r,n){var a=[];if(typeof e=="string")a=Tb(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Tb(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function bI(e,t,r){var n={};return t||(t={}),e=pt(e),pi.forEach(function(a){var s=(e.match(jc(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=nt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&iT(n.HeadingPairs,n.TitlesOfParts,t,r),t}function oT(e){var t=[],r=ge;return e||(e={}),e.Application="SheetJS",t[t.length]=Gt,t[t.length]=ge("Properties",null,{xmlns:nr.EXT_PROPS,"xmlns:vt":nr.vt}),pi.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=ft(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yI=/<[^>]+>[^<]*/g;function wI(e,t){var r={},n="",a=e.match(yI);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Le(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=nt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=nt(f);break;case"bool":r[n]=Et(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Ct(f);break;case"cy":case"error":r[n]=nt(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"&&t.WTF)throw new Error(i)}}return r}function lT(e){var t=[Gt,ge("Properties",null,{xmlns:nr.CUST_PROPS,"xmlns:vt":nr.vt})];if(!e)return t.join("");var r=1;return Bt(e).forEach(function(n){++r,t[t.length]=ge("property",NN(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var $1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},pp;function kI(e,t,r){pp||(pp=id($1)),t=pp[t]||t,e[t]=r}function TI(e,t){var r=[];return Bt($1).map(function(n){for(var a=0;a<Mn.length;++a)if(Mn[a][1]==n)return Mn[a];for(a=0;a<pi.length;++a)if(pi[a][1]==n)return pi[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Tr($1[n[1]]||n[1],a))}}),ge("DocumentProperties",r.join(""),{xmlns:fn.o})}function EI(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Bt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Mn.length;++i)if(s==Mn[i][1])return;for(i=0;i<pi.length;++i)if(s==pi[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(ge(bb(s),o,{"dt:dt":l}))}}),t&&Bt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(ge(bb(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+fn.o+'">'+a.join("")+"</"+n+">"}function Xm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function SI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=ne(8);return i.write_shift(4,n),i.write_shift(4,a),i}function cT(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function uT(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function fT(e,t,r){return t===31?uT(e):cT(e,t,r)}function G1(e,t,r){return fT(e,t,r===!1?0:4)}function xI(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return fT(e,t,0)}function _I(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ur,""),e.l-a&2&&(e.l+=2)}return r}function CI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ur,"");return r}function AI(e){var t=e.l,r=Eh(e,Z3);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Eh(e,Jr);return[r,n]}function NI(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(AI(e));return r}function Ob(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Ur,"").replace(Ul,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function hT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function II(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Eh(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==Ib&&n!==t&&oI.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Ib?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return cT(e,n,4).replace(Ur,"");case 31:return uT(e);case 64:return Xm(e);case 65:return hT(e);case 71:return II(e);case 80:return G1(e,n,!s.raw).replace(Ur,"");case 81:return xI(e,n).replace(Ur,"");case 4108:return NI(e);case 4126:case 4127:return n==4127?_I(e):CI(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Pb(e,t){var r=ne(4),n=ne(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ne(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=SI(t);break;case 31:case 80:for(n=ne(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return pr([r,n])}function Lb(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var f=e.read_shift(4),h=e.read_shift(4);s[i]=[f,h+r]}s.sort(function(b,w){return b[1]-w[1]});var d={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[s[i][0]];if(d[g.n]=Eh(e,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ln(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(s[i][0]===1){if(o=d.CodePage=Eh(e,qm),Ln(o),l!==-1){var m=e.l;e.l=s[l][1],c=Ob(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Ob(e,o)}else{var y=c[s[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=hT(e);break;case 30:e.l+=4,k=G1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=G1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Wt(e,4);break;case 64:e.l+=4,k=Ct(Xm(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[y]=k}}return e.l=r+n,d}var dT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RI(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Fb(e,t,r){var n=ne(8),a=[],s=[],i=8,o=0,l=ne(8),c=ne(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){c=ne(8),c.write_shift(4,0),a.unshift(c);var f=[ne(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=ne(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=pr(f),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(dT.indexOf(e[o][0])>-1||sT.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],p=0;if(t){p=+t[e[o][0]];var g=r[p];if(g.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=Pb(g.t,d)}else{var y=RI(d);y==-1&&(y=31,d=String(d)),l=Pb(y,d)}s.push(l),c=ne(8),c.write_shift(4,t?p:2+o),a.push(c),i+=8+l.length}var k=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,k),k+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),pr([n].concat(a).concat(s))}function Mb(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Ie.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=Lb(n,t),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=s,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Lb(n,null)}catch{}for(p in g)d[p]=g[p];return d.FMTID=[s,i],d}function Ub(e,t,r,n,a,s){var i=ne(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ie.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=Fb(e,r,n);if(o.push(l),a){var c=Fb(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return pr(o)}function is(e,t){return e.read_shift(t),null}function DI(e,t){t||(t=ne(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function OI(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Wt(e,t){return e.read_shift(t)===1}function Gr(e,t){return t||(t=ne(2)),t.write_shift(2,+!!e),t}function Yt(e){return e.read_shift(2,"u")}function Nn(e,t){return t||(t=ne(2)),t.write_shift(2,e),t}function pT(e,t){return OI(e,t,Yt)}function PI(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function mT(e,t,r){return r||(r=ne(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function uu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=gn;if(r&&r.biff>=8&&(gn=1200),!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return gn=s,o}function LI(e){var t=gn;gn=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,s=n&8,i=1+(n&1),o=0,l,c={};s&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=r===0?"":e.read_shift(r,f);return s&&(e.l+=4*o),a&&(e.l+=l),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),gn=t,c}function FI(e){var t=e.t||"",r=ne(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ne(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return pr(a)}function Ci(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function fu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ci(e,n,r)}function Bi(e,t,r){if(r.biff>5)return fu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function gT(e,t,r){return r||(r=ne(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function MI(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function UI(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ur,"");return n&&(e.l+=24),a}function jI(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Ur,"");return r+i}function zI(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UI(e);case"0303000000000000c000000000000046":return jI(e);default:throw new Error("Unsupported Moniker "+r)}}function nf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ur,""):"";return r}function jb(e,t){t||(t=ne(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function VI(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,h;a&16&&(s=nf(e,r-e.l)),a&128&&(i=nf(e,r-e.l)),(a&257)===257&&(o=nf(e,r-e.l)),(a&257)===1&&(l=zI(e,r-e.l)),a&8&&(c=nf(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(h=Xm(e)),e.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return f&&(p.guid=f),h&&(p.time=h),s&&(p.Tooltip=s),p}function BI(e){var t=ne(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),jb(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&jb(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function vT(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function bT(e,t){var r=vT(e);return r[3]=0,r}function Ea(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ai(e,t,r,n){return n||(n=ne(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function WI(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function HI(e,t,r){return t===0?"":Bi(e,t,r)}function $I(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function yT(e){var t=e.read_shift(2),r=Gm(e);return[t,r]}function GI(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=uu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function ud(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function wT(e,t){return t||(t=ne(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function kT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var qI=kT;function TT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function KI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function XI(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ir(e){e.l+=2,e.l+=e.read_shift(2)}var YI={0:Ir,4:Ir,5:Ir,6:Ir,7:XI,8:Ir,9:Ir,10:Ir,11:Ir,12:Ir,13:KI,14:Ir,15:Ir,16:Ir,17:Ir,18:Ir,19:Ir,20:Ir,21:TT};function QI(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(YI[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function af(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ym(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ne(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function JI(e,t){return t===0||e.read_shift(2),1200}function ZI(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Bi(e,0,r);return e.read_shift(t+n-e.l),a}function e9(e,t){var r=!t||t.biff==8,n=ne(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function t9(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r9(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=uu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function n9(e,t){var r=!t||t.biff>=8?2:1,n=ne(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function a9(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(LI(e));return s.Count=n,s.Unique=a,s}function s9(e,t){var r=ne(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=FI(e[a]);var s=pr([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function i9(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function o9(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function l9(e){var t=WI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function c9(e){return e.read_shift(2),e.read_shift(4)}function zb(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function u9(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function f9(){var e=ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function h9(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function d9(e){var t=ne(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function p9(){}function m9(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=uu(e,0,r),n}function g9(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=ne(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function v9(e){var t=Ea(e);return t.isst=e.read_shift(4),t}function b9(e,t,r,n){var a=ne(10);return Ai(e,t,n,a),a.write_shift(4,r),a}function y9(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ea(e);r.biff==2&&e.l++;var s=fu(e,n-e.l,r);return a.val=s,a}function w9(e,t,r,n,a){var s=!a||a.biff==8,i=ne(8+ +s+(1+s)*r.length);return Ai(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function k9(e,t,r){var n=e.read_shift(2),a=Bi(e,0,r);return[n,a]}function T9(e,t,r,n){var a=r&&r.biff==5;n||(n=ne(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var E9=Bi;function Vb(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function S9(e,t){var r=t.biff==8||!t.biff?4:2,n=ne(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function x9(e){var t=e.read_shift(2),r=e.read_shift(2),n=yT(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function _9(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(yT(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function C9(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function A9(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=lI[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function N9(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=A9(e,t,n.fStyle,r),n}function Bb(e,t,r,n){var a=r&&r.biff==5;n||(n=ne(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function I9(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function R9(e){var t=ne(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Wb(e,t,r){var n=Ea(e);(r.biff==2||t==9)&&++e.l;var a=PI(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function D9(e,t,r,n,a,s){var i=ne(8);return Ai(e,t,n,i),mT(r,s,i),i}function O9(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ea(e),a=Mr(e);return n.val=a,n}function P9(e,t,r,n){var a=ne(14);return Ai(e,t,n,a),_i(r,a),a}var Hb=HI;function L9(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Ci(e,s),o=[];n>e.l;)o.push(fu(e));return[s,a,i,o]}function $b(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=GI(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var F9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Gb(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Ci(e,i,r);a&32&&(c=F9[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var h=n==e.l||o===0||!(f>0)?[]:QO(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function ET(e,t,r){if(r.biff<8)return M9(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push($I(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function M9(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=uu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function U9(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Ci(e,n,r),i=Ci(e,a,r);return[s,i]}function j9(e,t,r){var n=kT(e);e.l++;var a=e.read_shift(1);return t-=8,[JO(e,t,r),a,n]}function qb(e,t,r){var n=qI(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,XO(e,t,r)]}function z9(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function V9(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Bi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function B9(e,t,r){return V9(e,t,r)}function W9(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ud(e));return r}function H9(e){var t=ne(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)wT(e[r],t);return t}function $9(e,t,r){if(r&&r.biff<8)return q9(e,t,r);var n=TT(e),a=QI(e,t-22,n[1]);return{cmo:n,ft:a}}var G9={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function q9(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((G9[n]||Vr)(e,t,r)),{cmo:[a,n,s],ft:i}}function K9(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=MI(e,6,r);var o=e.read_shift(2);e.read_shift(2),Yt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],h=Ci(e,e.lens[c+1]-e.lens[c]-1);if(a+=h,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function X9(e,t){var r=ud(e);e.l+=16;var n=VI(e,t-24);return[r,n]}function Y9(e){var t=ne(24),r=Rt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return pr([t,BI(e[1])])}function Q9(e,t){e.read_shift(2);var r=ud(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ur,""),[r,n]}function J9(e){var t=e[1].Tooltip,r=ne(10+2*(t.length+1));r.write_shift(2,2048);var n=Rt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Z9(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Rb[r]||r,r=e.read_shift(2),t[1]=Rb[r]||r,t}function eR(e){return e||(e=ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function tR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(bT(e));return r}function rR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(bT(e));return r}function nR(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ST(e,t,r){if(!r.cellStyles)return Vr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function aR(e,t){var r=ne(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function sR(e,t){var r={};return t<32||(e.l+=16,r.header=Mr(e),r.footer=Mr(e),e.l+=2),r}function iR(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function oR(e){for(var t=ne(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var lR=Ea,cR=pT,uR=fu;function fR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function hR(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ea(e);++e.l;var a=Bi(e,t-7,r);return n.t="str",n.val=a,n}function dR(e){var t=Ea(e);++e.l;var r=Mr(e);return t.t="n",t.val=r,t}function pR(e,t,r){var n=ne(15);return mu(n,e,t),n.write_shift(8,r,"f"),n}function mR(e){var t=Ea(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gR(e,t,r){var n=ne(9);return mu(n,e,t),n.write_shift(2,r),n}function vR(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function bR(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function yR(e,t,r){var n=e.l+t,a=Ea(e),s=e.read_shift(2),i=Ci(e,s,r);return e.l=n,a.t="str",a.val=i,a}var wR=[2,3,48,49,131,139,140,245],q1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=id({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=js(1);switch(l.type){case"base64":f=hn(bn(o));break;case"binary":f=hn(o);break;case"buffer":case"array":f=o;break}wr(f,0);var h=f.read_shift(1),d=!!(h&136),p=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,y=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(y=f.read_shift(2));var k=f.read_shift(2),b=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(b=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var w=[],N={},_=Math.min(f.length,h==2?521:y-10-(p?264:0)),F=g?32:11;f.l<_&&f[f.l]!=13;)switch(N={},N.name=tt.utils.decode(b,f.slice(f.l,f.l+F)).replace(/[\u0000\r\n].*$/g,""),f.l+=F,N.type=String.fromCharCode(f.read_shift(1)),h!=2&&!g&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),h==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&w.push(N),h!=2&&(f.l+=g?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var T=0,S=0;for(c[0]=[],S=0;S!=w.length;++S)c[0][S]=w[S].name;for(;m-- >0;){if(f[f.l]===42){f.l+=k;continue}for(++f.l,c[++T]=[],S=0,S=0;S!=w.length;++S){var x=f.slice(f.l,f.l+w[S].len);f.l+=w[S].len,wr(x,0);var I=tt.utils.decode(b,x);switch(w[S].type){case"C":I.trim().length&&(c[T][S]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[T][S]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[T][S]=I;break;case"F":c[T][S]=parseFloat(I.trim());break;case"+":case"I":c[T][S]=g?x.read_shift(-4,"i")^2147483648:x.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[T][S]=!0;break;case"N":case"F":c[T][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[T][S]="##MEMO##"+(g?parseInt(I.trim(),10):x.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[T][S]=+I||0);break;case"@":c[T][S]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":c[T][S]=new Date((x.read_shift(4)-2440588)*864e5+x.read_shift(4));break;case"Y":c[T][S]=x.read_shift(4,"i")/1e4+x.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][S]=-x.read_shift(-8,"f");break;case"B":if(p&&w[S].len==8){c[T][S]=x.read_shift(8,"f");break}case"G":case"P":x.l+=w[S].len;break;case"0":if(w[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[S].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=sl(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function a(o,l){try{return Ks(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Ln(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=sn(),h=_h(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),g=o["!cols"]||[],m=0,y=0,k=0,b=1;for(m=0;m<d.length;++m){if(((g[m]||{}).DBF||{}).name){d[m]=g[m].DBF.name,++k;continue}if(d[m]!=null){if(++k,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(y=0;y<1024;++y)if(d.indexOf(d[m]+"_"+y)==-1){d[m]+="_"+y;break}}}}var w=Qe(o["!ref"]),N=[],_=[],F=[];for(m=0;m<=w.e.c-w.s.c;++m){var T="",S="",x=0,I=[];for(y=0;y<p.length;++y)p[y][m]!=null&&I.push(p[y][m]);if(I.length==0||d[m]==null){N[m]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=I[y]instanceof Date?"D":"C";break;default:S="C"}x=Math.max(x,String(I[y]).length),T=T&&T!=S?"C":S}x>250&&(x=250),S=((g[m]||{}).DBF||{}).type,S=="C"&&g[m].DBF.len>x&&(x=g[m].DBF.len),T=="B"&&S=="N"&&(T="N",F[m]=g[m].DBF.dec,x=g[m].DBF.len),_[m]=T=="C"||S=="N"?x:s[T]||0,b+=_[m],N[m]=T}var A=f.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*k),A.write_shift(2,b),m=0;m<4;++m)A.write_shift(4,0);for(A.write_shift(4,0|(+t[Ei]||3)<<8),m=0,y=0;m<d.length;++m)if(d[m]!=null){var R=f.next(32),D=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,D,"sbcs"),R.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),R.write_shift(4,y),R.write_shift(1,_[m]||s[N[m]]||0),R.write_shift(1,F[m]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),y+=_[m]||s[N[m]]||0}var de=f.next(264);for(de.write_shift(4,13),m=0;m<65;++m)de.write_shift(4,0);for(m=0;m<p.length;++m){var ue=f.next(b);for(ue.write_shift(1,0),y=0;y<d.length;++y)if(d[y]!=null)switch(N[y]){case"L":ue.write_shift(1,p[m][y]==null?63:p[m][y]?84:70);break;case"B":ue.write_shift(8,p[m][y]||0,"f");break;case"N":var xe="0";for(typeof p[m][y]=="number"&&(xe=p[m][y].toFixed(F[y]||0)),k=0;k<_[y]-xe.length;++k)ue.write_shift(1,32);ue.write_shift(1,xe,"sbcs");break;case"D":p[m][y]?(ue.write_shift(4,("0000"+p[m][y].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(p[m][y].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+p[m][y].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var Se=String(p[m][y]!=null?p[m][y]:"").slice(0,_[y]);for(ue.write_shift(1,Se,"sbcs"),k=0;k<_[y]-Se.length;++k)ue.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),xT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var g=e[p];return typeof g=="number"?j1(g):g},n=function(d,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?d:j1(m)};e["|"]=254;function a(d,p){switch(p.type){case"base64":return s(bn(d),p);case"binary":return s(d,p);case"buffer":return s($e&&Buffer.isBuffer(d)?d.toString("binary"):qs(d),p);case"array":return s(xi(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var g=d.split(/[\n\r]+/),m=-1,y=-1,k=0,b=0,w=[],N=[],_=null,F={},T=[],S=[],x=[],I=0,A;for(+p.codepage>=0&&Ln(+p.codepage);k!==g.length;++k){I=0;var R=g[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),D=R.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),de=D[0],ue;if(R.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&N.push(R.slice(3).replace(/;;/g,";"));break;case"C":var xe=!1,Se=!1,q=!1,te=!1,fe=-1,Ae=-1;for(b=1;b<D.length;++b)switch(D[b].charAt(0)){case"A":break;case"X":y=parseInt(D[b].slice(1))-1,Se=!0;break;case"Y":for(m=parseInt(D[b].slice(1))-1,Se||(y=0),A=w.length;A<=m;++A)w[A]=[];break;case"K":ue=D[b].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(Qn(ue))?isNaN($o(ue).getDate())||(ue=Ct(ue)):(ue=Qn(ue),_!==null&&Fi(_)&&(ue=ld(ue))),typeof tt<"u"&&typeof ue=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(ue=tt.utils.decode(p.codepage,ue)),xe=!0;break;case"E":te=!0;var j=Io(D[b].slice(1),{r:m,c:y});w[m][y]=[w[m][y],j];break;case"S":q=!0,w[m][y]=[w[m][y],"S5S"];break;case"G":break;case"R":fe=parseInt(D[b].slice(1))-1;break;case"C":Ae=parseInt(D[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}if(xe&&(w[m][y]&&w[m][y].length==2?w[m][y][0]=ue:w[m][y]=ue,_=null),q){if(te)throw new Error("SYLK shared formula cannot have own formula");var G=fe>-1&&w[fe][Ae];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");w[m][y][1]=WT(G[1],{r:m-fe,c:y-Ae})}break;case"F":var W=0;for(b=1;b<D.length;++b)switch(D[b].charAt(0)){case"X":y=parseInt(D[b].slice(1))-1,++W;break;case"Y":for(m=parseInt(D[b].slice(1))-1,A=w.length;A<=m;++A)w[A]=[];break;case"M":I=parseInt(D[b].slice(1))/20;break;case"F":break;case"G":break;case"P":_=N[parseInt(D[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(x=D[b].slice(1).split(" "),A=parseInt(x[0],10);A<=parseInt(x[1],10);++A)I=parseInt(x[2],10),S[A-1]=I===0?{hidden:!0}:{wch:I},zs(S[A-1]);break;case"C":y=parseInt(D[b].slice(1))-1,S[y]||(S[y]={});break;case"R":m=parseInt(D[b].slice(1))-1,T[m]||(T[m]={}),I>0?(T[m].hpt=I,T[m].hpx=Ko(I)):I===0&&(T[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}W<1&&(_=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}}return T.length>0&&(F["!rows"]=T),S.length>0&&(F["!cols"]=S),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,F]}function i(d,p){var g=a(d,p),m=g[0],y=g[1],k=sl(m,p);return Bt(y).forEach(function(b){k[b]=y[b]}),k}function o(d,p){return Ks(i(d,p),p)}function l(d,p,g,m){var y="C;Y"+(g+1)+";X"+(m+1)+";K";switch(d.t){case"n":y+=d.v||0,d.f&&!d.F&&(y+=";E"+rg(d.f,{r:g,c:m}));break;case"b":y+=d.v?"TRUE":"FALSE";break;case"e":y+=d.w||d.v;break;case"d":y+='"'+(d.w||d.v)+'"';break;case"s":y+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(d,p){p.forEach(function(g,m){var y="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Hc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=$c(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&d.push(y)})}function f(d,p){p.forEach(function(g,m){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*Gc(g.hpx)+";"),y.length>2&&d.push(y+"R"+(m+1))})}function h(d,p){var g=["ID;PWXL;N;E"],m=[],y=Qe(d["!ref"]),k,b=Array.isArray(d),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&c(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var N=y.s.r;N<=y.e.r;++N)for(var _=y.s.c;_<=y.e.c;++_){var F=Oe({r:N,c:_});k=b?(d[N]||[])[_]:d[F],!(!k||k.v==null&&(!k.f||k.F))&&m.push(l(k,d,N,_))}return g.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),_T=function(){function e(s,i){switch(i.type){case"base64":return t(bn(s),i);case"binary":return t(s,i);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):qs(s),i);case"array":return t(xi(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),p=d[0],g=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(Qn(g))?isNaN($o(g).getDate())?h[l][c]=g:h[l][c]=Ct(g):h[l][c]=Qn(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(s,i){return sl(e(s,i),i)}function n(s,i){return Ks(r(s,i),i)}var a=function(){var s=function(o,l,c,f,h){o.push(l),o.push(c+","+f),o.push('"'+h.replace(/"/g,'""')+'"')},i=function(o,l,c,f){o.push(l+","+c),o.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(o){var l=[],c=Qe(o["!ref"]),f,h=Array.isArray(o);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,c.e.r-c.s.r+1,""),s(l,"TUPLES",0,c.e.c-c.s.c+1,""),s(l,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){i(l,-1,0,"BOT");for(var p=c.s.c;p<=c.e.c;++p){var g=Oe({r:d,c:p});if(f=h?(o[d]||[])[p]:o[g],!f){i(l,1,0,"");continue}switch(f.t){case"n":var m=f.w;!m&&f.v!=null&&(m=f.v),m==null?f.f&&!f.F?i(l,1,0,"="+f.f):i(l,1,0,""):i(l,0,m,"V");break;case"b":i(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=yn(f.z||Re[14],or(Ct(f.v)))),i(l,0,f.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var y=`\r
`,k=l.join(y);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),CT=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),g=-1,m=-1,y=0,k=[];y!==p.length;++y){var b=p[y].trim().split(":");if(b[0]==="cell"){var w=Rt(b[1]);if(k.length<=w.r)for(g=k.length;g<=w.r;++g)k[g]||(k[g]=[]);switch(g=w.r,m=w.c,b[2]){case"t":k[g][m]=e(b[3]);break;case"v":k[g][m]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":k[g][m]=!!+b[4];break;default:k[g][m]=+b[4];break}b[2]=="vtf"&&(k[g][m]=[k[g][m],N])}}}return d&&d.sheetRows&&(k=k.slice(0,d.sheetRows)),k}function n(h,d){return sl(r(h,d),d)}function a(h,d){return Ks(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],g,m="",y=Kr(h["!ref"]),k=Array.isArray(h),b=y.s.r;b<=y.e.r;++b)for(var w=y.s.c;w<=y.e.c;++w)if(m=Oe({r:b,c:w}),g=k?(h[b]||[])[w]:h[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var N=or(Ct(g.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=g.w||yn(g.z||Re[14],N);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,i,o,i,c(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Go=function(){function e(f,h,d,p,g){g.raw?h[d][p]=f:f===""||(f==="TRUE"?h[d][p]=!0:f==="FALSE"?h[d][p]=!1:isNaN(Qn(f))?isNaN($o(f).getDate())?h[d][p]=f:h[d][p]=Ct(f):h[d][p]=Qn(f))}function t(f,h){var d=h||{},p=[];if(!f||f.length===0)return p;for(var g=f.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var y=10,k=0,b=0;b<=m;++b)k=g[b].indexOf(" "),k==-1?k=g[b].length:k++,y=Math.max(y,k);for(b=0;b<=m;++b){p[b]=[];var w=0;for(e(g[b].slice(0,y).trim(),p,b,w,d),w=1;w<=(g[b].length-y)/10+1;++w)e(g[b].slice(y+(w-1)*10,y+w*10).trim(),p,b,w,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var h={},d=!1,p=0,g=0;p<f.length;++p)(g=f.charCodeAt(p))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p]);if(!g.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p])}return g.sort(function(m,y){return m[0]-y[0]||n[m[1]]-n[y[1]]}),r[g.pop()[1]]||44}function s(f,h){var d=h||{},p="",g=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=a(f.slice(0,1024)):d&&d.FS?p=d.FS:p=a(f.slice(0,1024));var y=0,k=0,b=0,w=0,N=0,_=p.charCodeAt(0),F=!1,T=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var x=d.dateNF!=null?sN(d.dateNF):null;function I(){var A=f.slice(w,N),R={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)R.t="z";else if(d.raw)R.t="s",R.v=A;else if(A.trim().length===0)R.t="s",R.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(R.t="s",R.v=A.slice(2,-1).replace(/""/g,'"')):LD(A)?(R.t="n",R.f=A.slice(1)):(R.t="s",R.v=A);else if(A=="TRUE")R.t="b",R.v=!0;else if(A=="FALSE")R.t="b",R.v=!1;else if(!isNaN(b=Qn(A)))R.t="n",d.cellText!==!1&&(R.w=A),R.v=b;else if(!isNaN($o(A).getDate())||x&&A.match(x)){R.z=d.dateNF||Re[14];var D=0;x&&A.match(x)&&(A=iN(A,d.dateNF,A.match(x)||[]),D=1),d.cellDates?(R.t="d",R.v=Ct(A,D)):(R.t="n",R.v=or(Ct(A,D))),d.cellText!==!1&&(R.w=yn(R.z,R.v instanceof Date?or(R.v):R.v)),d.cellNF||delete R.z}else R.t="s",R.v=A;if(R.t=="z"||(d.dense?(g[y]||(g[y]=[]),g[y][k]=R):g[Oe({c:k,r:y})]=R),w=N+1,S=f.charCodeAt(w),m.e.c<k&&(m.e.c=k),m.e.r<y&&(m.e.r=y),T==_)++k;else if(k=0,++y,d.sheetRows&&d.sheetRows<=y)return!0}e:for(;N<f.length;++N)switch(T=f.charCodeAt(N)){case 34:S===34&&(F=!F);break;case _:case 10:case 13:if(!F&&I())break e;break}return N-w>0&&I(),g["!ref"]=Ue(m),g}function i(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):sl(t(f,h),h)}function o(f,h){var d="",p=h.type=="string"?[0,0,0,0]:fg(f,h);switch(h.type){case"base64":d=bn(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof tt<"u"?d=tt.utils.decode(h.codepage,f):d=$e&&Buffer.isBuffer(f)?f.toString("binary"):qs(f);break;case"array":d=xi(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=pt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=pt(d):h.type=="binary"&&typeof tt<"u"&&h.codepage&&(d=tt.utils.decode(h.codepage,tt.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?CT.to_sheet(h.type=="string"?d:pt(d),h):i(d,h)}function l(f,h){return Ks(o(f,h),h)}function c(f){for(var h=[],d=Qe(f["!ref"]),p,g=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var y=[],k=d.s.c;k<=d.e.c;++k){var b=Oe({r:m,c:k});if(p=g?(f[m]||[])[k]:f[b],!p||p.v==null){y.push("          ");continue}for(var w=(p.w||(ka(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(k===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function kR(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=xT.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Go.to_workbook(e,t)}}var qo=function(){function e(j,G,W){if(j){wr(j,j.l||0);for(var H=W.Enum||fe;j.l<j.length;){var ee=j.read_shift(2),he=H[ee]||H[65535],ie=j.read_shift(2),me=j.l+ie,pe=he.f&&he.f(j,ie,W);if(j.l=me,G(pe,he,ee))return}}}function t(j,G){switch(G.type){case"base64":return r(hn(bn(j)),G);case"binary":return r(hn(j),G);case"buffer":case"array":return r(j,G)}throw"Unsupported type "+G.type}function r(j,G){if(!j)return j;var W=G||{},H=W.dense?[]:{},ee="Sheet1",he="",ie=0,me={},pe=[],je=[],V={s:{r:0,c:0},e:{r:0,c:0}},it=W.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)W.Enum=fe,e(j,function(we,Lt,dt){switch(dt){case 0:W.vers=we,we>=4096&&(W.qpro=!0);break;case 6:V=we;break;case 204:we&&(he=we);break;case 222:he=we;break;case 15:case 51:W.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:dt==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=W.dateNF||Re[14],W.cellDates&&(we[1].t="d",we[1].v=ld(we[1].v))),W.qpro&&we[3]>ie&&(H["!ref"]=Ue(V),me[ee]=H,pe.push(ee),H=W.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},ie=we[3],ee=he||"Sheet"+(ie+1),he="");var st=W.dense?(H[we[0].r]||[])[we[0].c]:H[Oe(we[0])];if(st){st.t=we[1].t,st.v=we[1].v,we[1].z!=null&&(st.z=we[1].z),we[1].f!=null&&(st.f=we[1].f);break}W.dense?(H[we[0].r]||(H[we[0].r]=[]),H[we[0].r][we[0].c]=we[1]):H[Oe(we[0])]=we[1];break}},W);else if(j[2]==26||j[2]==14)W.Enum=Ae,j[2]==14&&(W.qpro=!0,j.l=0),e(j,function(we,Lt,dt){switch(dt){case 204:ee=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>ie&&(H["!ref"]=Ue(V),me[ee]=H,pe.push(ee),H=W.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},ie=we[3],ee="Sheet"+(ie+1)),it>0&&we[0].r>=it)break;W.dense?(H[we[0].r]||(H[we[0].r]=[]),H[we[0].r][we[0].c]=we[1]):H[Oe(we[0])]=we[1],V.e.c<we[0].c&&(V.e.c=we[0].c),V.e.r<we[0].r&&(V.e.r=we[0].r);break;case 27:we[14e3]&&(je[we[14e3][0]]=we[14e3][1]);break;case 1537:je[we[0]]=we[1],we[0]==ie&&(ee=we[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(H["!ref"]=Ue(V),me[he||ee]=H,pe.push(he||ee),!je.length)return{SheetNames:pe,Sheets:me};for(var Je={},ot=[],ze=0;ze<je.length;++ze)me[pe[ze]]?(ot.push(je[ze]||pe[ze]),Je[je[ze]]=me[je[ze]]||me[pe[ze]]):(ot.push(je[ze]),Je[je[ze]]={"!ref":"A1"});return{SheetNames:ot,Sheets:Je}}function n(j,G){var W=G||{};if(+W.codepage>=0&&Ln(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var H=sn(),ee=Qe(j["!ref"]),he=Array.isArray(j),ie=[];be(H,0,s(1030)),be(H,6,l(ee));for(var me=Math.min(ee.e.r,8191),pe=ee.s.r;pe<=me;++pe)for(var je=zt(pe),V=ee.s.c;V<=ee.e.c;++V){pe===ee.s.r&&(ie[V]=_t(V));var it=ie[V]+je,Je=he?(j[pe]||[])[V]:j[it];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?be(H,13,p(pe,V,Je.v)):be(H,14,m(pe,V,Je.v));else{var ot=ka(Je);be(H,15,h(pe,V,ot.slice(0,239)))}}return be(H,1),H.end()}function a(j,G){var W=G||{};if(+W.codepage>=0&&Ln(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var H=sn();be(H,0,i(j));for(var ee=0,he=0;ee<j.SheetNames.length;++ee)(j.Sheets[j.SheetNames[ee]]||{})["!ref"]&&be(H,27,te(j.SheetNames[ee],he++));var ie=0;for(ee=0;ee<j.SheetNames.length;++ee){var me=j.Sheets[j.SheetNames[ee]];if(!(!me||!me["!ref"])){for(var pe=Qe(me["!ref"]),je=Array.isArray(me),V=[],it=Math.min(pe.e.r,8191),Je=pe.s.r;Je<=it;++Je)for(var ot=zt(Je),ze=pe.s.c;ze<=pe.e.c;++ze){Je===pe.s.r&&(V[ze]=_t(ze));var we=V[ze]+ot,Lt=je?(me[Je]||[])[ze]:me[we];if(!(!Lt||Lt.t=="z"))if(Lt.t=="n")be(H,23,I(Je,ze,ie,Lt.v));else{var dt=ka(Lt);be(H,22,T(Je,ze,ie,dt.slice(0,239)))}}++ie}}return be(H,1),H.end()}function s(j){var G=ne(2);return G.write_shift(2,j),G}function i(j){var G=ne(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var W=0,H=0,ee=0,he=0;he<j.SheetNames.length;++he){var ie=j.SheetNames[he],me=j.Sheets[ie];if(!(!me||!me["!ref"])){++ee;var pe=Kr(me["!ref"]);W<pe.e.r&&(W=pe.e.r),H<pe.e.c&&(H=pe.e.c)}}return W>8191&&(W=8191),G.write_shift(2,W),G.write_shift(1,ee),G.write_shift(1,H),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(j,G,W){var H={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&W.qpro?(H.s.c=j.read_shift(1),j.l++,H.s.r=j.read_shift(2),H.e.c=j.read_shift(1),j.l++,H.e.r=j.read_shift(2),H):(H.s.c=j.read_shift(2),H.s.r=j.read_shift(2),G==12&&W.qpro&&(j.l+=2),H.e.c=j.read_shift(2),H.e.r=j.read_shift(2),G==12&&W.qpro&&(j.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function l(j){var G=ne(8);return G.write_shift(2,j.s.c),G.write_shift(2,j.s.r),G.write_shift(2,j.e.c),G.write_shift(2,j.e.r),G}function c(j,G,W){var H=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(H[0].c=j.read_shift(1),H[3]=j.read_shift(1),H[0].r=j.read_shift(2),j.l+=2):(H[2]=j.read_shift(1),H[0].c=j.read_shift(2),H[0].r=j.read_shift(2)),H}function f(j,G,W){var H=j.l+G,ee=c(j,G,W);if(ee[1].t="s",W.vers==20768){j.l++;var he=j.read_shift(1);return ee[1].v=j.read_shift(he,"utf8"),ee}return W.qpro&&j.l++,ee[1].v=j.read_shift(H-j.l,"cstr"),ee}function h(j,G,W){var H=ne(7+W.length);H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,j),H.write_shift(1,39);for(var ee=0;ee<H.length;++ee){var he=W.charCodeAt(ee);H.write_shift(1,he>=128?95:he)}return H.write_shift(1,0),H}function d(j,G,W){var H=c(j,G,W);return H[1].v=j.read_shift(2,"i"),H}function p(j,G,W){var H=ne(7);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,j),H.write_shift(2,W,"i"),H}function g(j,G,W){var H=c(j,G,W);return H[1].v=j.read_shift(8,"f"),H}function m(j,G,W){var H=ne(13);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,j),H.write_shift(8,W,"f"),H}function y(j,G,W){var H=j.l+G,ee=c(j,G,W);if(ee[1].v=j.read_shift(8,"f"),W.qpro)j.l=H;else{var he=j.read_shift(2);N(j.slice(j.l,j.l+he),ee),j.l+=he}return ee}function k(j,G,W){var H=G&32768;return G&=-32769,G=(H?j:0)+(G>=8192?G-16384:G),(H?"":"$")+(W?_t(G):zt(G))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(j,G){wr(j,0);for(var W=[],H=0,ee="",he="",ie="",me="";j.l<j.length;){var pe=j[j.l++];switch(pe){case 0:W.push(j.read_shift(8,"f"));break;case 1:he=k(G[0].c,j.read_shift(2),!0),ee=k(G[0].r,j.read_shift(2),!1),W.push(he+ee);break;case 2:{var je=k(G[0].c,j.read_shift(2),!0),V=k(G[0].r,j.read_shift(2),!1);he=k(G[0].c,j.read_shift(2),!0),ee=k(G[0].r,j.read_shift(2),!1),W.push(je+V+":"+he+ee)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(j.read_shift(2));break;case 6:{for(var it="";pe=j[j.l++];)it+=String.fromCharCode(pe);W.push('"'+it.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:me=W.pop(),ie=W.pop(),W.push(["AND","OR"][pe-20]+"("+ie+","+me+")");break;default:if(pe<32&&w[pe])me=W.pop(),ie=W.pop(),W.push(ie+w[pe]+me);else if(b[pe]){if(H=b[pe][1],H==69&&(H=j[j.l++]),H>W.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+W.join("|")+"|");return}var Je=W.slice(-H);W.length-=H,W.push(b[pe][0]+"("+Je.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}W.length==1?G[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function _(j){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=j.read_shift(2),G[3]=j[j.l++],G[0].c=j[j.l++],G}function F(j,G){var W=_(j);return W[1].t="s",W[1].v=j.read_shift(G-4,"cstr"),W}function T(j,G,W,H){var ee=ne(6+H.length);ee.write_shift(2,j),ee.write_shift(1,W),ee.write_shift(1,G),ee.write_shift(1,39);for(var he=0;he<H.length;++he){var ie=H.charCodeAt(he);ee.write_shift(1,ie>=128?95:ie)}return ee.write_shift(1,0),ee}function S(j,G){var W=_(j);W[1].v=j.read_shift(2);var H=W[1].v>>1;if(W[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return W[1].v=H,W}function x(j,G){var W=_(j),H=j.read_shift(4),ee=j.read_shift(4),he=j.read_shift(2);if(he==65535)return H===0&&ee===3221225472?(W[1].t="e",W[1].v=15):H===0&&ee===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var ie=he&32768;return he=(he&32767)-16446,W[1].v=(1-ie*2)*(ee*Math.pow(2,he+32)+H*Math.pow(2,he)),W}function I(j,G,W,H){var ee=ne(14);if(ee.write_shift(2,j),ee.write_shift(1,W),ee.write_shift(1,G),H==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var he=0,ie=0,me=0,pe=0;return H<0&&(he=1,H=-H),ie=Math.log2(H)|0,H/=Math.pow(2,ie-31),pe=H>>>0,pe&2147483648||(H/=2,++ie,pe=H>>>0),H-=pe,pe|=2147483648,pe>>>=0,H*=Math.pow(2,32),me=H>>>0,ee.write_shift(4,me),ee.write_shift(4,pe),ie+=16383+(he?32768:0),ee.write_shift(2,ie),ee}function A(j,G){var W=x(j);return j.l+=G-14,W}function R(j,G){var W=_(j),H=j.read_shift(4);return W[1].v=H>>6,W}function D(j,G){var W=_(j),H=j.read_shift(8,"f");return W[1].v=H,W}function de(j,G){var W=D(j);return j.l+=G-10,W}function ue(j,G){return j[j.l+G-1]==0?j.read_shift(G,"cstr"):""}function xe(j,G){var W=j[j.l++];W>G-1&&(W=G-1);for(var H="";H.length<W;)H+=String.fromCharCode(j[j.l++]);return H}function Se(j,G,W){if(!(!W.qpro||G<21)){var H=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ee=j.read_shift(G-21,"cstr");return[H,ee]}}function q(j,G){for(var W={},H=j.l+G;j.l<H;){var ee=j.read_shift(2);if(ee==14e3){for(W[ee]=[0,""],W[ee][0]=j.read_shift(2);j[j.l];)W[ee][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return W}function te(j,G){var W=ne(5+j.length);W.write_shift(2,14e3),W.write_shift(2,G);for(var H=0;H<j.length;++H){var ee=j.charCodeAt(H);W[W.l++]=ee>127?95:ee}return W[W.l++]=0,W}var fe={0:{n:"BOF",f:Yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:xe},65535:{n:""}},Ae={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:x},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function TR(e){var t={},r=e.match(Br),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Le(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=xm[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var ER=function(){var e=jc("t"),t=jc("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:nt(i[1])},l=s.match(t);return l&&(o.s=TR(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(i){return i.v})}}(),SR=function(){var e=/(\r\n|\n)/g;function t(n,a,s){var i=[];n.u&&i.push("text-decoration: underline;"),n.uval&&i.push("text-underline-style:"+n.uval+";"),n.sz&&i.push("font-size:"+n.sz+"pt;"),n.outline&&i.push("text-effect: outline;"),n.shadow&&i.push("text-shadow: auto;"),a.push('<span style="'+i.join("")+'">'),n.b&&(a.push("<b>"),s.push("</b>")),n.i&&(a.push("<i>"),s.push("</i>")),n.strike&&(a.push("<s>"),s.push("</s>"));var o=n.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(a.push("<"+o+">"),s.push("</"+o+">")),s.push("</span>"),n}function r(n){var a=[[],n.v,[]];return n.v?(n.s&&t(n.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(n){return n.map(r).join("")}}(),xR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_R=/<(?:\w+:)?r>/,CR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Qm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=nt(pt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pt(e),r&&(n.h=Om(n.t))):e.match(_R)&&(n.r=pt(e),n.t=nt(pt((e.replace(CR,"").match(xR)||[]).join("").replace(Br,""))),r&&(n.h=SR(ER(n.r)))),n):{t:""}}var AR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,NR=/<(?:\w+:)?(?:si|sstItem)>/g,IR=/<\/(?:\w+:)?(?:si|sstItem)>/;function RR(e,t){var r=[],n="";if(!e)return r;var a=e.match(AR);if(a){n=a[2].replace(NR,"").split(IR);for(var s=0;s!=n.length;++s){var i=Qm(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Le(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var DR=/^\s|\s$|[\t\n\r]/;function AT(e,t){if(!t.bookSST)return"";var r=[Gt];r[r.length]=ge("sst",null,{xmlns:Mi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(DR)&&(s+=' xml:space="preserve"'),s+=">"+ft(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function OR(e){return[e.read_shift(4),e.read_shift(4)]}function PR(e,t){var r=[],n=!1;return Ga(e,function(a,s,i){switch(i){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),r}function LR(e,t){return t||(t=ne(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var FR=GN;function MR(e){var t=sn();se(t,159,LR(e));for(var r=0;r<e.length;++r)se(t,19,FR(e[r]));return se(t,160),t.end()}function NT(e){if(typeof tt<"u")return tt.utils.encode(Ei,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Fa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function UR(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Fa(e,4),t.U=Fa(e,4),t.W=Fa(e,4),t}function jR(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function zR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(jR(e));return t}function VR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function BR(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Fa(e,4),t.U=Fa(e,4),t.W=Fa(e,4),t}function WR(e){var t=BR(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function IT(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function RT(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function HR(e){var t=Fa(e);switch(t.Minor){case 2:return[t.Minor,$R(e)];case 3:return[t.Minor,GR()];case 4:return[t.Minor,qR(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function $R(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=IT(e,r),a=RT(e,e.length-e.l);return{t:"Std",h:n,v:a}}function GR(){throw new Error("File is password-protected: ECMA-376 Extensible")}function qR(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Br,function(a){var s=Le(a);switch(Ta(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(i){n[i]=s[i]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function KR(e,t){var r={},n=r.EncryptionVersionInfo=Fa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=IT(e,a),t-=a,r.EncryptionVerifier=RT(e,t),r}function XR(e){var t={},r=t.EncryptionVersionInfo=Fa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Jm(e){var t=0,r,n=NT(e),a=n.length+1,s,i,o,l,c;for(r=js(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var DT=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=NT(i),l=s(o),c=o.length,f=js(16),h=0;h!=16;++h)f[h]=0;var d,p,g;for((c&1)===1&&(d=l>>8,f[c]=a(e[0],d),--c,d=l&255,p=o[o.length-1],f[c]=a(p,d));c>0;)--c,d=l>>8,f[c]=a(o[c],d),--c,d=l&255,f[c]=a(o[c],d);for(c=15,g=15-o.length;g>0;)d=l>>8,f[c]=a(e[g],d),--c,--g,d=l&255,f[c]=a(o[c],d),--c,--g;return f}}(),YR=function(e,t,r,n,a){a||(a=t),n||(n=DT(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},QR=function(e){var t=0,r=DT(e);return function(n){var a=YR("",n,t,r);return t=a[1],a[0]}};function JR(e,t,r,n){var a={key:Yt(e),verificationBytes:Yt(e)};return r.password&&(a.verifier=Jm(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=QR(r.password)),a}function ZR(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=XR(e):n.Data=KR(e,t),n}function e7(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?ZR(e,t-2,n):JR(e,r.biff>=8?t:t-2,r,n),n}var OT=function(){function e(a,s){switch(s.type){case"base64":return t(bn(a),s);case"binary":return t(a,s);case"buffer":return t($e&&Buffer.isBuffer(a)?a.toString("binary"):qs(a),s);case"array":return t(xi(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,g,m=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var y=f.slice(p,d.lastIndex-g[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var k={v:y,t:"s"};Array.isArray(o)?o[h][m]=k:o[Oe({r:h,c:m})]=k}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ue(c),o}function r(a,s){return Ks(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Qe(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var h=Oe({r:c,c:f});o=l?(a[c]||[])[f]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ka(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function t7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Wc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function r7(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function n7(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Sh(e,t){if(t===0)return e;var r=r7(t7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Wc(n7(r))}var PT=6,a7=15,s7=1,Fr=PT;function Hc(e){return Math.floor((e+Math.round(128/Fr)/256)*Fr)}function $c(e){return Math.floor((e-5)/Fr*100+.5)/100}function xh(e){return Math.round((e*Fr+5)/Fr*256)/256}function mp(e){return xh($c(Hc(e)))}function Zm(e){var t=Math.abs(e-mp(e)),r=Fr;if(t>.005)for(Fr=s7;Fr<a7;++Fr)Math.abs(e-mp(e))<=t&&(t=Math.abs(e-mp(e)),r=Fr);Fr=r}function zs(e){e.width?(e.wpx=Hc(e.width),e.wch=$c(e.wpx),e.MDW=Fr):e.wpx?(e.wch=$c(e.wpx),e.width=xh(e.wch),e.MDW=Fr):typeof e.wch=="number"&&(e.width=xh(e.wch),e.wpx=Hc(e.width),e.MDW=Fr),e.customWidth&&delete e.customWidth}var i7=96,LT=i7;function Gc(e){return e*96/LT}function Ko(e){return e*LT/96}var o7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function l7(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Le(i);switch(Ta(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Et(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Et(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function c7(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Le(i);switch(Ta(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function u7(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Le(i);switch(Ta(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=pt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Et(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Et(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Et(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Et(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Et(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Et(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Et(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=xm[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Et(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Ao[a.color.index];a.color.index==81&&(l=Ao[1]),l||(l=Ao[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Sh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function f7(e,t,r){t.NumberFmt=[];for(var n=Bt(Re),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Re[n[a]];var s=e[0].match(Br);if(s)for(a=0;a<s.length;++a){var i=Le(s[a]);switch(Ta(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=nt(pt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ba(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function h7(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ge("numFmt",null,{numFmtId:n,formatCode:ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var sf=["numFmtId","fillId","fontId","borderId","xfId"],of=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function d7(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Br)||[]).forEach(function(s){var i=Le(s),o=0;switch(Ta(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<sf.length;++o)n[sf[o]]&&(n[sf[o]]=parseInt(n[sf[o]],10));for(o=0;o<of.length;++o)n[of[o]]&&(n[of[o]]=Et(n[of[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Et(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function p7(e){var t=[];return t[t.length]=ge("cellXfs",null),e.forEach(function(r){t[t.length]=ge("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var m7=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l={};if(!s)return l;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var c;return(c=s.match(e))&&f7(c,l,o),(c=s.match(n))&&u7(c,l,i,o),(c=s.match(r))&&c7(c,l,i,o),(c=s.match(a))&&l7(c,l,i,o),(c=s.match(t))&&d7(c,l,o),l}}();function FT(e,t){var r=[Gt,ge("styleSheet",null,{xmlns:Mi[0],"xmlns:vt":nr.vt})],n;return e.SSF&&(n=h7(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=p7(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function g7(e,t){var r=e.read_shift(2),n=jr(e);return[r,n]}function v7(e,t,r){r||(r=ne(6+4*t.length)),r.write_shift(2,e),mr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function b7(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=ZN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=JN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jr(e),n}function y7(e,t){t||(t=ne(25+4*32)),t.write_shift(2,e.sz*20),eI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),kh(e.color,t);var n=0;return n=2,t.write_shift(1,n),mr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var w7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gp,k7=Vr;function Kb(e,t){t||(t=ne(4*3+8*7+16*1)),gp||(gp=id(w7));var r=gp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(kh({auto:1},t),kh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function T7(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function MT(e,t,r){r||(r=ne(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Al(e,t){return t||(t=ne(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var E7=Vr;function S7(e,t){return t||(t=ne(51)),t.write_shift(1,0),Al(null,t),Al(null,t),Al(null,t),Al(null,t),Al(null,t),t.length>t.l?t.slice(0,t.l):t}function x7(e,t){return t||(t=ne(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),wh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function _7(e,t,r){var n=ne(2052);return n.write_shift(4,e),wh(t,n),wh(r,n),n.length>n.l?n.slice(0,n.l):n}function C7(e,t,r){var n={};n.NumberFmt=[];for(var a in Re)n.NumberFmt[a]=Re[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ga(e,function(o,l,c){switch(c){case 44:n.NumberFmt[o[0]]=o[1],ba(o[1],o[0]);break;case 43:n.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=Sh(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(c),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(c);else if(l.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function A7(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(se(e,615,Jn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&se(e,44,v7(a,t[a]))}),se(e,616))}}function N7(e){var t=1;se(e,611,Jn(t)),se(e,43,y7({sz:12,color:{theme:1},name:"Calibri",family:2})),se(e,612)}function I7(e){var t=2;se(e,603,Jn(t)),se(e,45,Kb({patternType:"none"})),se(e,45,Kb({patternType:"gray125"})),se(e,604)}function R7(e){var t=1;se(e,613,Jn(t)),se(e,46,S7()),se(e,614)}function D7(e){var t=1;se(e,626,Jn(t)),se(e,47,MT({numFmtId:0},65535)),se(e,627)}function O7(e,t){se(e,617,Jn(t.length)),t.forEach(function(r){se(e,47,MT(r,0))}),se(e,618)}function P7(e){var t=1;se(e,619,Jn(t)),se(e,48,x7({xfId:0,name:"Normal"})),se(e,620)}function L7(e){var t=0;se(e,505,Jn(t)),se(e,506)}function F7(e){var t=0;se(e,508,_7(t,"TableStyleMedium9","PivotStyleMedium4")),se(e,509)}function M7(e,t){var r=sn();return se(r,278),A7(r,e.SSF),N7(r),I7(r),R7(r),D7(r),O7(r,t.cellXfs),P7(r),L7(r),F7(r),se(r,279),r.end()}var U7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function j7(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Br)||[]).forEach(function(a){var s=Le(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[U7.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function z7(){}function V7(){}var B7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,W7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,H7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $7(e,t,r){t.themeElements={};var n;[["clrScheme",B7,j7],["fontScheme",W7,z7],["fmtScheme",H7,V7]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var G7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function UT(e,t){(!e||e.length===0)&&(e=eg());var r,n={};if(!(r=e.match(G7)))throw new Error("themeElements not found in theme");return $7(r[0],n,t),n.raw=e,n}function eg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Gt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function q7(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=P3(s,{type:"array"})}catch{return}var o=dn(i,"theme/theme/theme1.xml",!0);if(o)return UT(o,r)}}function K7(e){return e.read_shift(4)}function X7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Y7(e,4);break;case 2:t.xclrValue=vT(e);break;case 3:t.xclrValue=K7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Y7(e,t){return Vr(e,t)}function Q7(e,t){return Vr(e,t)}function J7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=X7(e);break;case 6:n[1]=Q7(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Z7(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(J7(e,r-e.l));return{ixfe:n,ext:s}}function eD(e,t){t.forEach(function(r){switch(r[0]){}})}function tD(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jr(e)}}function rD(e){var t=ne(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),mr(e.name,t),t.slice(0,t.l)}function nD(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function aD(e){var t=ne(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function sD(e,t){var r=ne(8+2*t.length);return r.write_shift(4,e),mr(t,r),r.slice(0,r.l)}function iD(e){return e.l+=4,e.read_shift(4)!=0}function oD(e,t){var r=ne(8);return r.write_shift(4,e),r.write_shift(4,1),r}function lD(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Ga(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T&&(!i||a.WTF&&s[s.length-1]!=35))throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function cD(){var e=sn();return se(e,332),se(e,334,Jn(1)),se(e,335,rD({name:"XLDAPR",version:12e4,flags:3496657072})),se(e,336),se(e,339,sD(1,"XLDAPR")),se(e,52),se(e,35,Jn(514)),se(e,4096,Jn(0)),se(e,4097,Nn(1)),se(e,36),se(e,53),se(e,340),se(e,337,oD(1)),se(e,51,aD([[1,0]])),se(e,338),se(e,333),e.end()}function uD(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Br,function(o){var l=Le(o);switch(Ta(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function jT(){var e=[Gt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function fD(e){var t=[];if(!e)return t;var r=1;return(e.match(Br)||[]).forEach(function(n){var a=Le(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function hD(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Oe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function dD(e,t,r){var n=[];return Ga(e,function(a,s,i){switch(i){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+i.toString(16))}}),n}function pD(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Ga(e,function(i,o,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!o.T&&(!s||a.WTF))throw new Error("Unexpected record 0x"+l.toString(16))}},a)}function mD(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var vo=1024;function zT(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ge("xml",null,{"xmlns:v":fn.v,"xmlns:o":fn.o,"xmlns:x":fn.x,"xmlns:mv":fn.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];vo<e*1e3;)vo+=1e3;return t.forEach(function(s){var i=Rt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ge("v:fill",l,o),f={on:"t",obscured:"t"};++vo,a=a.concat(["<v:shape"+zc({id:"_x0000_s"+vo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ge("v:shadow",null,f),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Tr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Tr("x:AutoFill","False"),Tr("x:Row",String(i.r)),Tr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Xb(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Rt(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Qe(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ue(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function gD(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Le(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Rt(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Qm(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function VT(e){var t=[Gt,ge("comments",null,{xmlns:Mi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=ft(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(ft(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Tr("t",ft(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(Tr("t",ft(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function vD(e,t){var r=[],n=!1,a={},s=0;return e.replace(Br,function(i,o){var l=Le(i);switch(Ta(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function bD(e,t,r){var n=[Gt,ge("ThreadedComments",null,{xmlns:nr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(ge("threadedComment",Tr("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function yD(e,t){var r=[],n=!1;return e.replace(Br,function(a){var s=Le(a);switch(Ta(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function wD(e){var t=[Gt,ge("personList",null,{xmlns:nr.TCMNT,"xmlns:x":Mi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function kD(e){var t={};t.iauthor=e.read_shift(4);var r=Vi(e);return t.rfx=r.s,t.ref=Oe(r.s),e.l+=16,t}function TD(e,t){return t==null&&(t=ne(36)),t.write_shift(4,e[1].iauthor),il(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ED=jr;function SD(e){return mr(e.slice(0,54))}function xD(e,t){var r=[],n=[],a={},s=!1;return Ga(e,function(i,o,l){switch(l){case 632:n.push(i);break;case 635:a=i;break;case 637:a.t=i.t,a.h=i.h,a.r=i.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!o.T&&(!s||t.WTF))throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function _D(e){var t=sn(),r=[];return se(t,628),se(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),se(t,632,SD(a.a)))})}),se(t,631),se(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Rt(n[0]),e:Rt(n[0])};se(t,635,TD([s,a])),a.t&&a.t.length>0&&se(t,637,KN(a)),se(t,636),delete a.iauthor})}),se(t,634),se(t,629),t.end()}var CD="application/vnd.ms-office.vbaProject";function AD(e){var t=Ie.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ie.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ie.write(t)}function ND(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ie.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var BT=["xlsb","xlsm","xlam","biff8","xla"];function ID(){return{"!type":"dialog"}}function RD(){return{"!type":"dialog"}}function DD(){return{"!type":"macro"}}function OD(){return{"!type":"macro"}}var Io=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+_t(f)+(l?"":"$")+zt(c)}return function(n,a){return t=a,n.replace(e,r)}}(),tg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rg=function(){return function(e,t){return e.replace(tg,function(r,n,a,s,i,o){var l=Bm(s)-(a?0:t.c),c=Vm(o)-(i?0:t.r),f=c==0?"":i?c+1:"["+c+"]",h=l==0?"":a?l+1:"["+l+"]";return n+"R"+f+"C"+h})}}();function WT(e,t){return e.replace(tg,function(r,n,a,s,i,o){return n+(a=="$"?a+s:_t(Bm(s)+t.c))+(i=="$"?i+o:zt(Vm(o)+t.r))})}function PD(e,t,r){var n=Kr(t),a=n.s,s=Rt(r),i={r:s.r-a.r,c:s.c-a.c};return WT(e,i)}function LD(e){return e.length!=1}function Yb(e){return e.replace(/_xlfn\./g,"")}function qt(e){e.l+=1}function Vs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function HT(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $T(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Vs(e),o=Vs(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function $T(e){var t=Vs(e),r=Vs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function FD(e,t,r){if(r.biff<8)return $T(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Vs(e),i=Vs(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function GT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return MD(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Vs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function MD(e){var t=Vs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function UD(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jD(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return zD(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function zD(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function VD(e,t,r){var n=(e[e.l++]&96)>>5,a=HT(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function BD(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=HT(e,s,r);return[n,a,i]}function WD(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function HD(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function $D(e,t,r){var n=(e[e.l++]&96)>>5,a=FD(e,t-1,r);return[n,a]}function GD(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Qb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function qD(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function KD(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function XD(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function YD(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function QD(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function qT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function JD(e){return e.read_shift(2),qT(e)}function ZD(e){return e.read_shift(2),qT(e)}function eO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=GT(e,0,r);return[n,a]}function tO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=jD(e,0,r);return[n,a]}function rO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=GT(e,0,r);return[n,a,s]}function nO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[iP[a],YT[a],n]}function aO(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:sO(e);return[a,(s[0]===0?YT:sP)[s[1]]]}function sO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function iO(e,t,r){e.l+=r&&r.biff==2?3:4}function oO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function lO(e){return e.l++,qa[e.read_shift(1)]}function cO(e){return e.l++,e.read_shift(2)}function uO(e){return e.l++,e.read_shift(1)!==0}function fO(e){return e.l++,Mr(e)}function hO(e,t,r){return e.l++,uu(e,t-1,r)}function dO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=qa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Mr(e);break;case 2:r[1]=Bi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function pO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Vi:ud)(e));return a}function mO(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=dO(e,r.biff);return i}function gO(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function vO(e,t,r){if(r.biff==5)return bO(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function bO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function yO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function wO(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function TO(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var EO=Vr,SO=Vr,xO=Vr;function hu(e,t,r){return e.l+=2,[UD(e)]}function ng(e){return e.l+=6,[]}var _O=hu,CO=ng,AO=ng,NO=hu;function KT(e){return e.l+=2,[Yt(e),e.read_shift(2)&1]}var IO=hu,RO=KT,DO=ng,OO=hu,PO=hu,LO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function FO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=LO[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function MO(e){return e.l+=2,[e.read_shift(4)]}function UO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function jO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function zO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function BO(e){return e.l+=4,[0,0]}var Jb={1:{n:"PtgExp",f:oO},2:{n:"PtgTbl",f:xO},3:{n:"PtgAdd",f:qt},4:{n:"PtgSub",f:qt},5:{n:"PtgMul",f:qt},6:{n:"PtgDiv",f:qt},7:{n:"PtgPower",f:qt},8:{n:"PtgConcat",f:qt},9:{n:"PtgLt",f:qt},10:{n:"PtgLe",f:qt},11:{n:"PtgEq",f:qt},12:{n:"PtgGe",f:qt},13:{n:"PtgGt",f:qt},14:{n:"PtgNe",f:qt},15:{n:"PtgIsect",f:qt},16:{n:"PtgUnion",f:qt},17:{n:"PtgRange",f:qt},18:{n:"PtgUplus",f:qt},19:{n:"PtgUminus",f:qt},20:{n:"PtgPercent",f:qt},21:{n:"PtgParen",f:qt},22:{n:"PtgMissArg",f:qt},23:{n:"PtgStr",f:hO},26:{n:"PtgSheet",f:UO},27:{n:"PtgEndSheet",f:jO},28:{n:"PtgErr",f:lO},29:{n:"PtgBool",f:uO},30:{n:"PtgInt",f:cO},31:{n:"PtgNum",f:fO},32:{n:"PtgArray",f:GD},33:{n:"PtgFunc",f:nO},34:{n:"PtgFuncVar",f:aO},35:{n:"PtgName",f:gO},36:{n:"PtgRef",f:eO},37:{n:"PtgArea",f:VD},38:{n:"PtgMemArea",f:yO},39:{n:"PtgMemErr",f:EO},40:{n:"PtgMemNoMem",f:SO},41:{n:"PtgMemFunc",f:wO},42:{n:"PtgRefErr",f:kO},43:{n:"PtgAreaErr",f:WD},44:{n:"PtgRefN",f:tO},45:{n:"PtgAreaN",f:$D},46:{n:"PtgMemAreaN",f:zO},47:{n:"PtgMemNoMemN",f:VO},57:{n:"PtgNameX",f:vO},58:{n:"PtgRef3d",f:rO},59:{n:"PtgArea3d",f:BD},60:{n:"PtgRefErr3d",f:TO},61:{n:"PtgAreaErr3d",f:HD},255:{}},WO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HO={1:{n:"PtgElfLel",f:KT},2:{n:"PtgElfRw",f:OO},3:{n:"PtgElfCol",f:_O},6:{n:"PtgElfRwV",f:PO},7:{n:"PtgElfColV",f:NO},10:{n:"PtgElfRadical",f:IO},11:{n:"PtgElfRadicalS",f:DO},13:{n:"PtgElfColS",f:CO},15:{n:"PtgElfColSV",f:AO},16:{n:"PtgElfRadicalLel",f:RO},25:{n:"PtgList",f:FO},29:{n:"PtgSxName",f:MO},255:{}},$O={0:{n:"PtgAttrNoop",f:BO},1:{n:"PtgAttrSemi",f:QD},2:{n:"PtgAttrIf",f:XD},4:{n:"PtgAttrChoose",f:qD},8:{n:"PtgAttrGoto",f:KD},16:{n:"PtgAttrSum",f:iO},32:{n:"PtgAttrBaxcel",f:Qb},33:{n:"PtgAttrBaxcel",f:Qb},64:{n:"PtgAttrSpace",f:JD},65:{n:"PtgAttrSpaceSemi",f:ZD},128:{n:"PtgAttrIfError",f:YD},255:{}};function du(e,t,r,n){if(n.biff<8)return Vr(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=mO(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=pO(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Vr(e,t)),s}function pu(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Jb[s]||Jb[WO[s]],(s===24||s===25)&&(a=(s===24?HO:$O)[e[e.l+1]]),!a||!a.f?Vr(e,t):i.push([a.n,a.f(e,t,r)]);return i}function GO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var qO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function XT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Zb(e,t,r){var n=XT(e,t,r);return n=="#REF"?n:KO(n,r)}function Or(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,p,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,y="",k=0,b=e[0].length;k<b;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:y=jt(" ",e[0][m][1][1]);break;case 1:y=jt("\r",e[0][m][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+y,m=-1}o.push(c+qO[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=tc(w[1][1],i,a),o.push(rc(f,s));break;case"PtgRefN":f=r?tc(w[1][1],r,a):w[1][1],o.push(rc(f,s));break;case"PtgRef3d":h=w[1][1],f=tc(w[1][2],i,a),g=Zb(n,h,a),o.push(g+"!"+rc(f,s));break;case"PtgFunc":case"PtgFuncVar":var N=w[1][0],_=w[1][1];N||(N=0),N&=127;var F=N==0?[]:o.slice(-N);o.length-=N,_==="User"&&(_=F.shift()),o.push(_+"("+F.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=Ab(w[1][1],r?{s:r}:i,a),o.push(hp(p,a));break;case"PtgArea":p=Ab(w[1][1],i,a),o.push(hp(p,a));break;case"PtgArea3d":h=w[1][1],p=w[1][2],g=Zb(n,h,a),o.push(g+"!"+hp(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var T=(n.names||[])[d-1]||(n[0]||[])[d],S=T?T.Name:"SH33TJSNAME"+String(d);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var x=w[1][1];d=w[1][2];var I;if(a.biff<=5)x<0&&(x=-x),n[x]&&(I=n[x][d]);else{var A="";if(((n[x]||[])[0]||[])[0]==14849||(((n[x]||[])[0]||[])[0]==1025?n[x][d]&&n[x][d].itab>0&&(A=n.SheetNames[n[x][d].itab-1]+"!"):A=n.SheetNames[d-1]+"!"),n[x]&&n[x][d])A+=n[x][d].Name;else if(n[0]&&n[0][d])A+=n[0][d].Name;else{var R=(XT(n,x,a)||"").split(";;");R[d-1]?A=R[d-1]:A+="SH33TJSERRX"}o.push(A);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var D="(",de=")";if(m>=0){switch(y="",e[0][m][1][0]){case 2:D=jt(" ",e[0][m][1][1])+D;break;case 3:D=jt("\r",e[0][m][1][1])+D;break;case 4:de=jt(" ",e[0][m][1][1])+de;break;case 5:de=jt("\r",e[0][m][1][1])+de;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(D+o.pop()+de);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Oe(f)]){var xe=n.sharedf[Oe(f)];o.push(Or(xe,i,ue,n,a))}else{var Se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Or(c[1],i,ue,n,a)),Se=!0;break}Se||o.push(w[1])}break;case"PtgArray":o.push("{"+GO(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&q.indexOf(e[0][k][0])==-1){w=e[0][m];var te=!0;switch(w[1][0]){case 4:te=!1;case 0:y=jt(" ",w[1][1]);break;case 5:te=!1;case 1:y=jt("\r",w[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((te?y:"")+o.pop()+(te?"":y)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function XO(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Vr(e,t-2)];var o=pu(e,i,r);return t!==i+a&&(s=du(e,t-i-a,o,r)),e.l=n,[o,s]}function YO(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Vr(e,t-2)];var o=pu(e,i,r);return t!==i+a&&(s=du(e,t-i-a,o,r)),e.l=n,[o,s]}function QO(e,t,r,n){var a=e.l+t,s=pu(e,n,r),i;return a!==e.l&&(i=du(e,a-e.l,s,r)),[s,i]}function JO(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=pu(e,s,r);return s==65535?[[],Vr(e,t-2)]:(t!==s+2&&(a=du(e,n-s-2,i,r)),[i,a])}function ZO(e){var t;if(Da(e,e.l+6)!==65535)return[Mr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function eP(e){if(e==null){var t=ne(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return _i(e);return _i(0)}function vp(e,t,r){var n=e.l+t,a=Ea(e);r.biff==2&&++e.l;var s=ZO(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=YO(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function tP(e,t,r,n,a){var s=Ai(t,r,a),i=eP(e.v),o=ne(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ne(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var h=pr([s,i,o,c]);return h}function fd(e,t,r){var n=e.read_shift(4),a=pu(e,n,r),s=e.read_shift(4),i=s>0?du(e,s,a,r):null;return[a,i]}var rP=fd,hd=fd,nP=fd,aP=fd,sP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},YT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ey(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function oP(e){var t="of:="+e.replace(tg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function bp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function lP(e){return e.replace(/\./,"!")}var ac={},Ro={},sc=typeof Map<"u";function ag(e,t,r){var n=0,a=e.length;if(r){if(sc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=sc?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(sc?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function dd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Fr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=$c(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=xh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function mi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Xs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){ba(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function QT(e,t,r,n,a,s){try{n.cellNF&&(e.z=Re[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ct(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Re[t]==null&&ba(aN[t]||"General",t),e.t==="e")e.w=e.w||qa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Uc(e.v);else if(e.t==="d"){var i=or(e.v);(i|0)===i?e.w=i.toString(10):e.w=Uc(i)}else{if(e.v===void 0)return"";e.w=Si(e.v,Ro)}else e.t==="d"?e.w=yn(t,or(e.v),Ro):e.w=yn(t,e.v,Ro)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Sh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Sh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function cP(e,t,r){if(e&&e["!ref"]){var n=Qe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function uP(e,t){var r=Qe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ue(r))}var fP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dP=/<(?:\w:)?hyperlink [^>]*>/mg,pP=/"(\w*:\w*)"/,mP=/<(?:\w:)?col\b[^>]*[\/]?>/g,gP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vP=/<(?:\w:)?pageMargins[^>]*\/>/g,JT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wP(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=e.match(hP);h?(c=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):c=f=e;var d=c.match(JT);d?sg(d[0],o,a,r):(d=c.match(bP))&&TP(d[0],d[1]||"",o,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(pP);g&&uP(o,g[1])}var m=c.match(yP);m&&m[1]&&LP(m[1],a);var y=[];if(t.cellStyles){var k=c.match(mP);k&&IP(y,k)}h&&UP(h[1],o,t,l,s,i);var b=f.match(gP);b&&(o["!autofilter"]=DP(b[0]));var w=[],N=f.match(fP);if(N)for(p=0;p!=N.length;++p)w[p]=Qe(N[p].slice(N[p].indexOf('"')+1));var _=f.match(dP);_&&CP(o,_,n);var F=f.match(vP);if(F&&(o["!margins"]=AP(Le(F[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ue(l)),t.sheetRows>0&&o["!ref"]){var T=Qe(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ue(T))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function kP(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ue(e[r])+'"/>';return t+"</mergeCells>"}function sg(e,t,r,n){var a=Le(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=nt(pt(a.codeName)))}function TP(e,t,r,n,a){sg(e.slice(0,e.indexOf(">")),r,n,a)}function EP(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=fa(ft(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ge("outlinePr",null,c)}!s&&!o||(a[a.length]=ge("sheetPr",o,i))}var SP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],xP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _P(e){var t={sheet:1};return SP.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),xP.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Jm(e.password).toString(16).toUpperCase()),ge("sheetProtection",null,t)}function CP(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Le(pt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+nt(s.location))):(s.Target="#"+nt(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Qe(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Oe({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function AP(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function NP(e){return mi(e),ge("pageMargins",null,e)}function IP(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Le(t[n],!0);a.hidden&&(a.hidden=Et(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Zm(a.width)),zs(a);s<=i;)e[s++]=gt(a)}}function RP(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ge("col",null,dd(a,n)));return r[r.length]="</cols>",r.join("")}function DP(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function OP(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ue(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Kr(a);i.s.r==i.e.r&&(i.e.r=Kr(t["!ref"]).e.r,a=Ue(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ge("autoFilter",null,{ref:a})}var PP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function LP(e,t){t.Views||(t.Views=[{}]),(e.match(PP)||[]).forEach(function(r,n){var a=Le(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Et(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function FP(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,a),{})}function MP(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=qa[e.v];break;case"d":n&&n.cellDates?a=Ct(e.v,-1).toISOString():(e=gt(e),e.t="n",a=""+(e.v=or(Ct(e.v)))),typeof e.z>"u"&&(e.z=Re[14]);break;default:a=e.v;break}var o=Tr("v",ft(a)),l={r:t},c=Xs(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Tr("v",""+ag(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ge("f",ft(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ge("c",o,l)}var UP=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=jc("v"),i=jc("f");return function(o,l,c,f,h,d){for(var p=0,g="",m=[],y=[],k=0,b=0,w=0,N="",_,F,T=0,S=0,x,I,A=0,R=0,D=Array.isArray(d.CellXf),de,ue=[],xe=[],Se=Array.isArray(l),q=[],te={},fe=!1,Ae=!!c.sheetStubs,j=o.split(t),G=0,W=j.length;G!=W;++G){g=j[G].trim();var H=g.length;if(H!==0){var ee=0;e:for(p=0;p<H;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(c&&c.cellStyles){if(F=Le(g.slice(ee,p),!0),T=F.r!=null?parseInt(F.r,10):T+1,S=-1,c.sheetRows&&c.sheetRows<T)continue;te={},fe=!1,F.ht&&(fe=!0,te.hpt=parseFloat(F.ht),te.hpx=Ko(te.hpt)),F.hidden=="1"&&(fe=!0,te.hidden=!0),F.outlineLevel!=null&&(fe=!0,te.level=+F.outlineLevel),fe&&(q[T-1]=te)}break;case"<":ee=p;break}if(ee>=p)break;if(F=Le(g.slice(ee,p),!0),T=F.r!=null?parseInt(F.r,10):T+1,S=-1,!(c.sheetRows&&c.sheetRows<T)){f.s.r>T-1&&(f.s.r=T-1),f.e.r<T-1&&(f.e.r=T-1),c&&c.cellStyles&&(te={},fe=!1,F.ht&&(fe=!0,te.hpt=parseFloat(F.ht),te.hpx=Ko(te.hpt)),F.hidden=="1"&&(fe=!0,te.hidden=!0),F.outlineLevel!=null&&(fe=!0,te.level=+F.outlineLevel),fe&&(q[T-1]=te)),m=g.slice(p).split(e);for(var he=0;he!=m.length&&m[he].trim().charAt(0)=="<";++he);for(m=m.slice(he),p=0;p!=m.length;++p)if(g=m[p].trim(),g.length!==0){if(y=g.match(r),k=p,b=0,w=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,y!=null&&y.length===2){for(k=0,N=y[1],b=0;b!=N.length&&!((w=N.charCodeAt(b)-64)<1||w>26);++b)k=26*k+w;--k,S=k}else++S;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,F=Le(g.slice(0,b),!0),F.r||(F.r=Oe({r:T-1,c:S})),N=g.slice(b),_={t:""},(y=N.match(s))!=null&&y[1]!==""&&(_.v=nt(y[1])),c.cellFormula){if((y=N.match(i))!=null&&y[1]!==""){if(_.f=nt(pt(y[1])).replace(/\r\n/g,`
`),c.xlfn||(_.f=Yb(_.f)),y[0].indexOf('t="array"')>-1)_.F=(N.match(a)||[])[1],_.F.indexOf(":")>-1&&ue.push([Qe(_.F),_.F]);else if(y[0].indexOf('t="shared"')>-1){I=Le(y[0]);var ie=nt(pt(y[1]));c.xlfn||(ie=Yb(ie)),xe[parseInt(I.si,10)]=[I,ie,F.r]}}else(y=N.match(/<f[^>]*\/>/))&&(I=Le(y[0]),xe[I.si]&&(_.f=PD(xe[I.si][1],xe[I.si][2],F.r)));var me=Rt(F.r);for(b=0;b<ue.length;++b)me.r>=ue[b][0].s.r&&me.r<=ue[b][0].e.r&&me.c>=ue[b][0].s.c&&me.c<=ue[b][0].e.c&&(_.F=ue[b][1])}if(F.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(Ae)_.t="z";else continue;else _.t=F.t||"n";switch(f.s.c>S&&(f.s.c=S),f.e.c<S&&(f.e.c=S),_.t){case"n":if(_.v==""||_.v==null){if(!Ae)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!Ae)continue;_.t="z"}else x=ac[parseInt(_.v,10)],_.v=x.t,_.r=x.r,c.cellHTML&&(_.h=x.h);break;case"str":_.t="s",_.v=_.v!=null?pt(_.v):"",c.cellHTML&&(_.h=Om(_.v));break;case"inlineStr":y=N.match(n),_.t="s",y!=null&&(x=Qm(y[1]))?(_.v=x.t,c.cellHTML&&(_.h=x.h)):_.v="";break;case"b":_.v=Et(_.v);break;case"d":c.cellDates?_.v=Ct(_.v,1):(_.v=or(Ct(_.v,1)),_.t="n");break;case"e":(!c||c.cellText!==!1)&&(_.w=_.v),_.v=eT[_.v];break}if(A=R=0,de=null,D&&F.s!==void 0&&(de=d.CellXf[F.s],de!=null&&(de.numFmtId!=null&&(A=de.numFmtId),c.cellStyles&&de.fillId!=null&&(R=de.fillId))),QT(_,A,R,c,h,d),c.cellDates&&D&&_.t=="n"&&Fi(Re[A])&&(_.t="d",_.v=ld(_.v)),F.cm&&c.xlmeta){var pe=(c.xlmeta.Cell||[])[+F.cm-1];pe&&pe.type=="XLDAPR"&&(_.D=!0)}if(Se){var je=Rt(F.r);l[je.r]||(l[je.r]=[]),l[je.r][je.c]=_}else l[F.r]=_}}}}q.length>0&&(l["!rows"]=q)}}();function jP(e,t,r,n){var a=[],s=[],i=Qe(e["!ref"]),o="",l,c="",f=[],h=0,d=0,p=e["!rows"],g=Array.isArray(e),m={r:c},y,k=-1;for(d=i.s.c;d<=i.e.c;++d)f[d]=_t(d);for(h=i.s.r;h<=i.e.r;++h){for(s=[],c=zt(h),d=i.s.c;d<=i.e.c;++d){l=f[d]+c;var b=g?(e[h]||[])[d]:e[l];b!==void 0&&(o=MP(b,l,e,t))!=null&&s.push(o)}(s.length>0||p&&p[h])&&(m={r:c},p&&p[h]&&(y=p[h],y.hidden&&(m.hidden=1),k=-1,y.hpx?k=Gc(y.hpx):y.hpt&&(k=y.hpt),k>-1&&(m.ht=k,m.customHeight=1),y.level&&(m.outlineLevel=y.level)),a[a.length]=ge("row",s.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},y=p[h],y.hidden&&(m.hidden=1),k=-1,y.hpx?k=Gc(y.hpx):y.hpt&&(k=y.hpt),k>-1&&(m.ht=k,m.customHeight=1),y.level&&(m.outlineLevel=y.level),a[a.length]=ge("row","",m));return a.join("")}function ZT(e,t,r,n){var a=[Gt,ge("worksheet",null,{xmlns:Mi[0],"xmlns:r":nr.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=Qe(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=Ue(f)}n||(n={}),l["!comments"]=[];var h=[];EP(l,r,e,t,a),a[a.length]=ge("dimension",null,{ref:c}),a[a.length]=FP(l,t,e,r),t.sheetFormat&&(a[a.length]=ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=RP(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=jP(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=_P(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=OP(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=kP(l["!merges"]));var d=-1,p,g=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=ut(n,-1,ft(m[1].Target).replace(/#.*$/,""),Ge.HLINK),p["r:id"]="rId"+g),(d=m[1].Target.indexOf("#"))>-1&&(p.location=ft(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=ft(m[1].Tooltip)),a[a.length]=ge("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=NP(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Tr("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=ut(n,-1,"../drawings/drawing"+(e+1)+".xml",Ge.DRAW),a[a.length]=ge("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=ut(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ge.VML),a[a.length]=ge("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function zP(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function VP(e,t,r){var n=ne(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Gc(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,d=-1,p=f<<10;p<f+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Oe(c)];g&&(h<0&&(h=p),d=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function BP(e,t,r,n){var a=VP(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&se(e,0,a)}var WP=Vi,HP=il;function $P(){}function GP(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=XN(e),r}function qP(e,t,r){r==null&&(r=ne(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return kh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),X3(e,r),r.slice(0,r.l)}function KP(e){var t=zn(e);return[t]}function XP(e,t,r){return r==null&&(r=ne(8)),Ui(t,r)}function YP(e){var t=ji(e);return[t]}function QP(e,t,r){return r==null&&(r=ne(4)),zi(t,r)}function JP(e){var t=zn(e),r=e.read_shift(1);return[t,r,"b"]}function ZP(e,t,r){return r==null&&(r=ne(9)),Ui(t,r),r.write_shift(1,e.v?1:0),r}function eL(e){var t=ji(e),r=e.read_shift(1);return[t,r,"b"]}function tL(e,t,r){return r==null&&(r=ne(5)),zi(t,r),r.write_shift(1,e.v?1:0),r}function rL(e){var t=zn(e),r=e.read_shift(1);return[t,r,"e"]}function nL(e,t,r){return r==null&&(r=ne(9)),Ui(t,r),r.write_shift(1,e.v),r}function aL(e){var t=ji(e),r=e.read_shift(1);return[t,r,"e"]}function sL(e,t,r){return r==null&&(r=ne(8)),zi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function iL(e){var t=zn(e),r=e.read_shift(4);return[t,r,"s"]}function oL(e,t,r){return r==null&&(r=ne(12)),Ui(t,r),r.write_shift(4,t.v),r}function lL(e){var t=ji(e),r=e.read_shift(4);return[t,r,"s"]}function cL(e,t,r){return r==null&&(r=ne(8)),zi(t,r),r.write_shift(4,t.v),r}function uL(e){var t=zn(e),r=Mr(e);return[t,r,"n"]}function fL(e,t,r){return r==null&&(r=ne(16)),Ui(t,r),_i(e.v,r),r}function eE(e){var t=ji(e),r=Mr(e);return[t,r,"n"]}function hL(e,t,r){return r==null&&(r=ne(12)),zi(t,r),_i(e.v,r),r}function dL(e){var t=zn(e),r=Gm(e);return[t,r,"n"]}function pL(e,t,r){return r==null&&(r=ne(12)),Ui(t,r),Y3(e.v,r),r}function mL(e){var t=ji(e),r=Gm(e);return[t,r,"n"]}function gL(e,t,r){return r==null&&(r=ne(8)),zi(t,r),Y3(e.v,r),r}function vL(e){var t=zn(e),r=Wm(e);return[t,r,"is"]}function bL(e){var t=zn(e),r=jr(e);return[t,r,"str"]}function yL(e,t,r){return r==null&&(r=ne(12+4*e.v.length)),Ui(t,r),mr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function wL(e){var t=ji(e),r=jr(e);return[t,r,"str"]}function kL(e,t,r){return r==null&&(r=ne(8+4*e.v.length)),zi(t,r),mr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function TL(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=hd(e,n-e.l,r);i[3]=Or(o,null,a,r.supbooks,r)}else e.l=n;return i}function EL(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=hd(e,n-e.l,r);i[3]=Or(o,null,a,r.supbooks,r)}else e.l=n;return i}function SL(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=Mr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=hd(e,n-e.l,r);i[3]=Or(o,null,a,r.supbooks,r)}else e.l=n;return i}function xL(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=jr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=hd(e,n-e.l,r);i[3]=Or(o,null,a,r.supbooks,r)}else e.l=n;return i}var _L=Vi,CL=il;function AL(e,t){return t==null&&(t=ne(4)),t.write_shift(4,e),t}function NL(e,t){var r=e.l+t,n=Vi(e),a=Hm(e),s=jr(e),i=jr(e),o=jr(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function IL(e,t){var r=ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));il({s:Rt(e[0]),e:Rt(e[0])},r),$m("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return mr(a||"",r),mr(e[1].Tooltip||"",r),mr("",r),r.slice(0,r.l)}function RL(){}function DL(e,t,r){var n=e.l+t,a=Q3(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=rP(e,n-e.l,r);i[1]=o}else e.l=n;return i}function OL(e,t,r){var n=e.l+t,a=Vi(e),s=[a];if(r.cellFormula){var i=aP(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function PL(e,t,r){r==null&&(r=ne(18));var n=dd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var tE=["left","right","top","bottom","header","footer"];function LL(e){var t={};return tE.forEach(function(r){t[r]=Mr(e)}),t}function FL(e,t){return t==null&&(t=ne(6*8)),mi(e),tE.forEach(function(r){_i(e[r],t)}),t}function ML(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UL(e,t,r){r==null&&(r=ne(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function jL(e){var t=ne(24);return t.write_shift(4,4),t.write_shift(4,1),il(e,t),t}function zL(e,t){return t==null&&(t=ne(16*4+2)),t.write_shift(2,e.password?Jm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function VL(){}function BL(){}function WL(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,g,m,y,k,b,w,N,_,F=[];o.biff=12,o["!row"]=0;var T=0,S=!1,x=[],I={},A=o.supbooks||a.supbooks||[[]];if(A.sharedf=I,A.arrayf=x,A.SheetNames=a.SheetNames||a.Sheets.map(function(q){return q.name}),!o.supbooks&&(o.supbooks=A,a.Names))for(var R=0;R<a.Names.length;++R)A[0][R+1]=a.Names[R];var D=[],de=[],ue=!1;qc[16]={n:"BrtShortReal",f:eE};var xe;if(Ga(e,function(q,te,fe){if(!d)switch(fe){case 148:c=q;break;case 0:p=q,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),N=zt(y=p.r),o["!row"]=p.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=Ko(q.hpt)),de[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:q[2]},q[2]){case"n":g.v=q[1];break;case"s":w=ac[q[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!q[1];break;case"e":g.v=q[1],o.cellText!==!1&&(g.w=qa[g.v]);break;case"str":g.t="s",g.v=q[1];break;case"is":g.t="s",g.v=q[1].t;break}if((m=i.CellXf[q[0].iStyleRef])&&QT(g,m.numFmtId,null,o,s,i),k=q[0].c==-1?k+1:q[0].c,o.dense?(l[y]||(l[y]=[]),l[y][k]=g):l[_t(k)+N]=g,o.cellFormula){for(S=!1,T=0;T<x.length;++T){var Ae=x[T];p.r>=Ae[0].s.r&&p.r<=Ae[0].e.r&&k>=Ae[0].s.c&&k<=Ae[0].e.c&&(g.F=Ue(Ae[0]),S=!0)}!S&&q.length>3&&(g.f=q[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>k&&(f.s.c=k),f.e.r<p.r&&(f.e.r=p.r),f.e.c<k&&(f.e.c=k),o.cellDates&&m&&g.t=="n"&&Fi(Re[m.numFmtId])){var j=ms(g.v);j&&(g.t="d",g.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}xe&&(xe.type=="XLDAPR"&&(g.D=!0),xe=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},k=q[0].c==-1?k+1:q[0].c,o.dense?(l[y]||(l[y]=[]),l[y][k]=g):l[_t(k)+N]=g,f.s.r>p.r&&(f.s.r=p.r),f.s.c>k&&(f.s.c=k),f.e.r<p.r&&(f.e.r=p.r),f.e.c<k&&(f.e.c=k),xe&&(xe.type=="XLDAPR"&&(g.D=!0),xe=void 0);break;case 176:F.push(q);break;case 49:xe=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var G=n["!id"][q.relId];for(G?(q.Target=G.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=G):q.relId==""&&(q.Target="#"+q.loc),y=q.rfx.s.r;y<=q.rfx.e.r;++y)for(k=q.rfx.s.c;k<=q.rfx.e.c;++k)o.dense?(l[y]||(l[y]=[]),l[y][k]||(l[y][k]={t:"z",v:void 0}),l[y][k].l=q):(b=Oe({c:k,r:y}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=q);break;case 426:if(!o.cellFormula)break;x.push(q),_=o.dense?l[y][k]:l[_t(k)+N],_.f=Or(q[1],f,{r:p.r,c:k},A,o),_.F=Ue(q[0]);break;case 427:if(!o.cellFormula)break;I[Oe(q[0].s)]=q[1],_=o.dense?l[y][k]:l[_t(k)+N],_.f=Or(q[1],f,{r:p.r,c:k},A,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)D[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},ue||(ue=!0,Zm(q.w/256)),zs(D[q.e+1]);break;case 161:l["!autofilter"]={ref:Ue(q)};break;case 476:l["!margins"]=q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),q.name&&(a.Sheets[r].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!te.T&&(!h||o.WTF))throw new Error("Unexpected record 0x"+fe.toString(16))}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ue(c||f)),o.sheetRows&&l["!ref"]){var Se=Qe(l["!ref"]);o.sheetRows<=+Se.e.r&&(Se.e.r=o.sheetRows-1,Se.e.r>f.e.r&&(Se.e.r=f.e.r),Se.e.r<Se.s.r&&(Se.s.r=Se.e.r),Se.e.c>f.e.c&&(Se.e.c=f.e.c),Se.e.c<Se.s.c&&(Se.s.c=Se.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ue(Se))}return F.length>0&&(l["!merges"]=F),D.length>0&&(l["!cols"]=D),de.length>0&&(l["!rows"]=de),l}function HL(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=gt(t),t.z=t.z||Re[14],t.v=or(Ct(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Xs(a.cellXfs,t,a),t.l&&s["!links"].push([Oe(l),t.l]),t.c&&s["!comments"].push([Oe(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=ag(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?se(e,18,cL(t,l)):se(e,7,oL(t,l))):(l.t="str",i?se(e,17,kL(t,l)):se(e,6,yL(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?se(e,13,gL(t,l)):se(e,2,pL(t,l)):i?se(e,16,hL(t,l)):se(e,5,fL(t,l)),!0;case"b":return l.t="b",i?se(e,15,tL(t,l)):se(e,4,ZP(t,l)),!0;case"e":return l.t="e",i?se(e,14,sL(t,l)):se(e,3,nL(t,l)),!0}return i?se(e,12,QP(t,l)):se(e,1,XP(t,l)),!0}function $L(e,t,r,n){var a=Qe(t["!ref"]||"A1"),s,i="",o=[];se(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=c;++f){i=zt(f),BP(e,t,a,f);var h=!1;if(f<=a.e.r)for(var d=a.s.c;d<=a.e.c;++d){f===a.s.r&&(o[d]=_t(d)),s=o[d]+i;var p=l?(t[f]||[])[d]:t[s];if(!p){h=!1;continue}h=HL(e,p,f,d,n,t,h)}}se(e,146)}function GL(e,t){!t||!t["!merges"]||(se(e,177,AL(t["!merges"].length)),t["!merges"].forEach(function(r){se(e,176,CL(r))}),se(e,178))}function qL(e,t){!t||!t["!cols"]||(se(e,390),t["!cols"].forEach(function(r,n){r&&se(e,60,PL(n,r))}),se(e,391))}function KL(e,t){!t||!t["!ref"]||(se(e,648),se(e,649,jL(Qe(t["!ref"]))),se(e,650))}function XL(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=ut(r,-1,n[1].Target.replace(/#.*$/,""),Ge.HLINK);se(e,494,IL(n,a))}}),delete t["!links"]}function YL(e,t,r,n){if(t["!comments"].length>0){var a=ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML);se(e,551,$m("rId"+a)),t["!legacy"]=a}}function QL(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Ue(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Kr(s);o.s.r==o.e.r&&(o.e.r=Kr(t["!ref"]).e.r,s=Ue(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),se(e,161,il(Qe(s))),se(e,162)}}function JL(e,t,r){se(e,133),se(e,137,UL(t,r)),se(e,138),se(e,134)}function ZL(e,t){t["!protect"]&&se(e,535,zL(t["!protect"]))}function eF(e,t,r,n){var a=sn(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=Qe(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],se(a,129),(r.vbaraw||i["!outline"])&&se(a,147,qP(o,i["!outline"])),se(a,148,HP(l)),JL(a,i,r.Workbook),qL(a,i),$L(a,i,e,t),ZL(a,i),QL(a,i,r,e),GL(a,i),XL(a,i,n),i["!margins"]&&se(a,476,FL(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&KL(a,i),YL(a,i,e,n),se(a,130),a.end()}function tF(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function rF(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=tF(h);f.s.r=f.s.c=0,f.e.c=o,c=_t(o),d[0].forEach(function(p,g){i[c+zt(g)]={t:"n",v:p,z:d[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Ue(f)),i}function nF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(JT);return o&&sg(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function aF(e,t){e.l+=10;var r=jr(e);return{name:r}}function sF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ga(e,function(o,l,c){switch(c){case 550:s["!rel"]=o;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),o.name&&(a.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)&&!(l.T<0)&&(!i||t.WTF))throw new Error("Unexpected record 0x"+c.toString(16))}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ig=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],iF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oF=[],lF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ty(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Et(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function ry(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Et(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function rE(e){ry(e.WBProps,ig),ry(e.CalcPr,lF),ty(e.WBView,iF),ty(e.Sheets,oF),Ro.date1904=Et(e.WBProps.date1904)}function cF(e){return!e.Workbook||!e.Workbook.WBProps?"false":Et(e.Workbook.WBProps.date1904)?"true":"false"}var uF="][*?/\\".split("");function nE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function fF(e,t,r){e.forEach(function(n,a){nE(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function aE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];fF(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)cP(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var hF=/<\w+:workbook/;function dF(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Br,function(o,l){var c=Le(o);switch(Ta(c[0])){case"<?xml":break;case"<workbook":o.match(hF)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[a];break;case"</workbook>":break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ig.forEach(function(f){if(c[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Et(c[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(c[f[0]],10);break;default:r.WBProps[f[0]]=c[f[0]]}}),c.codeName&&(r.WBProps.CodeName=pt(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=nt(pt(c.name)),delete c[0],r.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=pt(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Et(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=nt(pt(e.slice(i,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],r.CalcPr=c;break;case"<calcPr/>":delete c[0],r.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),Mi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return rE(r),r}function sE(e){var t=[Gt];t[t.length]=ge("workbook",null,{xmlns:Mi[0],"xmlns:r":nr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ig.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ge("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:ft(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ge("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ge("definedName",ft(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function pF(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=V1(e),r.name=jr(e),r}function mF(e,t){return t||(t=ne(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),$m(e.strRelID,t),mr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function gF(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?jr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vF(e,t){t||(t=ne(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),X3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function bF(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function yF(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=YN(e),i=nP(e,0,r),o=Hm(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function wF(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],qc[16]={n:"BrtFRTArchID$",f:bF},Ga(e,function(o,l,c){switch(c){case 156:i.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=Or(o.Ptg,null,null,i,t),delete t.SID,delete o.Ptg,s.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([c,o]):i[0]=[c,o],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(o),i.XTI=i.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(c),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(c),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!l.T&&(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35))throw new Error("Unexpected record 0x"+c.toString(16))}},t),rE(r),r.Names=s,r.supbooks=i,r}function kF(e,t){se(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};se(e,156,mF(a))}se(e,144)}function TF(e,t){t||(t=ne(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return mr("SheetJS",t),mr(Fc.version,t),mr(Fc.version,t),mr("7262",t),t.length>t.l?t.slice(0,t.l):t}function EF(e,t){t||(t=ne(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function SF(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(se(e,135),se(e,158,EF(a)),se(e,136))}}function xF(e,t){var r=sn();return se(r,131),se(r,128,TF()),se(r,153,vF(e.Workbook&&e.Workbook.WBProps||null)),SF(r,e),kF(r,e),se(r,132),r.end()}function _F(e,t,r){return t.slice(-4)===".bin"?wF(e,r):dF(e,r)}function CF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?WL(e,n,r,a,s,i,o):wP(e,n,r,a,s,i,o)}function AF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?sF(e,n,r,a,s):nF(e,n,r,a,s)}function NF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?DD():OD()}function IF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?ID():RD()}function RF(e,t,r,n){return t.slice(-4)===".bin"?C7(e,r,n):m7(e,r,n)}function DF(e,t,r){return UT(e,r)}function OF(e,t,r){return t.slice(-4)===".bin"?PR(e,r):RR(e,r)}function PF(e,t,r){return t.slice(-4)===".bin"?xD(e,r):gD(e,r)}function LF(e,t,r){return t.slice(-4)===".bin"?dD(e):fD(e)}function FF(e,t,r,n){return r.slice(-4)===".bin"?pD(e,t,r,n):void 0}function MF(e,t,r){return t.slice(-4)===".bin"?lD(e,t,r):uD(e,t,r)}function UF(e,t,r){return(t.slice(-4)===".bin"?xF:sE)(e)}function jF(e,t,r,n,a){return(t.slice(-4)===".bin"?eF:ZT)(e,r,n,a)}function zF(e,t,r){return(t.slice(-4)===".bin"?M7:FT)(e,r)}function VF(e,t,r){return(t.slice(-4)===".bin"?MR:AT)(e,r)}function BF(e,t,r){return(t.slice(-4)===".bin"?_D:VT)(e)}function WF(e){return(e.slice(-4)===".bin"?cD:jT)()}var iE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,oE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(iE),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(oE),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function HF(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(iE),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(oE),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var ic;function $F(e,t){var r=ic[e]||nt(e);return r==="General"?Si(t):yn(r,t)}function GF(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Et(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ct(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[nt(t)]=a}function qF(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||qa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Uc(e.v):e.w=Si(e.v):e.w=$F(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=ic[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fi(n)){var a=ms(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function KF(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=o7[n.Pattern]||n.Pattern)}e[t.ID]=t}function XF(e,t,r,n,a,s,i,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var p=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&p.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Et(e);break;case"String":n.t="s",n.r=yb(nt(e)),n.v=e.indexOf("<")>-1?nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ct(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=nt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=eT[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=yb(t||e));break}if(qF(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=nt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Io(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Io("RC:RC",a):n.ArrayRange&&(n.F=Io(n.ArrayRange,a),l.push([Qe(n.F),n.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(y){!d.patternType&&y.patternType&&(d.patternType=y.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function YF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function yp(e,t){var r=t||{};nl();var n=go(Pm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof tt<"u"?n=tt.utils.decode(65001,ph(n)):n=pt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=gt(r);return i.type="string",Go.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Lt){a.indexOf("<"+Lt)>=0&&(s=!0)}),s)return DM(n,r);ic={"General Number":"General","General Date":Re[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Re[15],"Short Date":Re[14],"Long Time":Re[19],"Medium Time":Re[18],"Short Time":Re[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Re[2],Standard:Re[4],Percent:Re[10],Scientific:Re[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},p="",g={},m={},y=Wn('<Data ss:Type="String">'),k=0,b=0,w=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},F={},T="",S=0,x=[],I={},A={},R=0,D=[],de=[],ue={},xe=[],Se,q=!1,te=[],fe=[],Ae={},j=0,G=0,W={Sheets:[],WBProps:{date1904:!1}},H={};Vc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=Vc.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?XF(n.slice(k,o.index),T,y,l[l.length-1][0]=="comment"?ue:g,{c:b,r:w},_,xe[b],m,te,r):(T="",y=Wn(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(de.length>0&&(g.c=de),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][b]=g):d[_t(b)+zt(w)]=g),g.HRef&&(g.l={Target:nt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(j=b+(parseInt(g.MergeAcross,10)|0),G=w+(parseInt(g.MergeDown,10)|0),x.push({s:{c:b,r:w},e:{c:j,r:G}})),!r.sheetStubs)g.MergeAcross?b=j+1:++b;else if(g.MergeAcross||g.MergeDown){for(var he=b;he<=j;++he)for(var ie=w;ie<=G;++ie)(he>b||ie>w)&&(r.dense?(d[ie]||(d[ie]=[]),d[ie][he]={t:"z"}):d[_t(he)+zt(ie)]={t:"z"});b=j+1}else++b;else g=HF(o[0]),g.Index&&(b=+g.Index-1),b<N.s.c&&(N.s.c=b),b>N.e.c&&(N.e.c=b),o[0].slice(-2)==="/>"&&++b,de=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<N.s.r&&(N.s.r=w),w>N.e.r&&(N.e.r=w),o[0].slice(-2)==="/>"&&(m=Wn(o[0]),m.Index&&(w=+m.Index-1)),b=0,++w):(m=Wn(o[0]),m.Index&&(w=+m.Index-1),Ae={},(m.AutoFitHeight=="0"||m.Height)&&(Ae.hpx=parseInt(m.Height,10),Ae.hpt=Gc(Ae.hpx),fe[w]=Ae),m.Hidden=="1"&&(Ae.hidden=!0,fe[w]=Ae));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(d["!ref"]=Ue(N),r.sheetRows&&r.sheetRows<=N.e.r&&(d["!fullref"]=d["!ref"],N.e.r=r.sheetRows-1,d["!ref"]=Ue(N))),x.length&&(d["!merges"]=x),xe.length>0&&(d["!cols"]=xe),fe.length>0&&(d["!rows"]=fe),f[p]=d}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([o[3],!1]),c=Wn(o[0]),p=nt(c.Name),d=r.dense?[]:{},x=[],te=[],fe=[],H={name:p,Hidden:0},W.Sheets.push(H);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),xe=[],q=!1}break;case"style":o[1]==="/"?KF(_,F,r):F=Wn(o[0]);break;case"numberformat":F.nf=nt(Wn(o[0]).Format||"General"),ic[F.nf]&&(F.nf=ic[F.nf]);for(var me=0;me!=392&&Re[me]!=F.nf;++me);if(me==392){for(me=57;me!=392;++me)if(Re[me]==null){ba(F.nf,me);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Se=Wn(o[0]),Se.Hidden&&(Se.hidden=!0,delete Se.Hidden),Se.Width&&(Se.wpx=parseInt(Se.Width,10)),!q&&Se.wpx>10){q=!0,Fr=PT;for(var pe=0;pe<xe.length;++pe)xe[pe]&&zs(xe[pe])}q&&zs(Se),xe[Se.Index-1||xe.length]=Se;for(var je=0;je<+Se.Span;++je)xe[xe.length]=gt(Se);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var V=Le(o[0]),it={Name:V.Name,Ref:Io(V.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(it.Sheet=W.Sheets.length-1),W.Names.push(it);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=Wn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?kI(I,ee,n.slice(R,o.index)):R=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));YF(ue),de.push(ue)}else l.push([o[3],!1]),c=Wn(o[0]),ue={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Je=Wn(o[0]);d["!autofilter"]={ref:Io(Je.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return MM(n,r);var ot=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ot=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ot=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ot=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ot=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(R,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else R=o.index+o[0].length;break;case"header":d["!margins"]||mi(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].header=+Le(o[0]).Margin);break;case"footer":d["!margins"]||mi(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].footer=+Le(o[0]).Margin);break;case"pagemargins":var ze=Le(o[0]);d["!margins"]||mi(d["!margins"]={},"xlml"),isNaN(+ze.Top)||(d["!margins"].top=+ze.Top),isNaN(+ze.Left)||(d["!margins"].left=+ze.Left),isNaN(+ze.Right)||(d["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(d["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ot=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ot=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ot=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ot=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ot=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ot=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ot=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ot=!1}break;case"smarttags":break;default:ot=!1;break}if(ot||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?GF(A,ee,D,n.slice(R,o.index)):(D=o,R=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var we={};return!r.bookSheets&&!r.bookProps&&(we.Sheets=f),we.SheetNames=h,we.Workbook=W,we.SSF=gt(Re),we.Props=I,we.Custprops=A,we}function K1(e,t){switch(cg(t=t||{}),t.type||"base64"){case"base64":return yp(bn(e),t);case"binary":case"buffer":case"file":return yp(e,t);case"array":return yp(qs(e),t)}}function QF(e,t){var r=[];return e.Props&&r.push(TI(e.Props,t)),e.Custprops&&r.push(EI(e.Props,e.Custprops)),r.join("")}function JF(){return""}function ZF(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(ge("NumberFormat",null,{"ss:Format":ft(Re[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(ge("Style",s.join(""),i))}),ge("Styles",r.join(""))}function lE(e){return ge("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+rg(e.Ref,{r:0,c:0})})}function eM(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(lE(a)))}return ge("Names",r.join(""))}function tM(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(lE(o)))}return s.join("")}function rM(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ge("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Tr("ProtectContents","True")),e["!protect"].objects&&a.push(Tr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Tr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Tr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Tr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":ge("WorksheetOptions",a.join(""),{xmlns:fn.x})}function nM(e){return e.map(function(t){var r=xN(t.t||""),n=ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",n,{"ss:Author":t.a})}).join("")}function aM(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ft(rg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Rt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ft(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ft(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=i.c||c[f].s.r!=i.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=qa[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Re[14]);break;case"s":h="String",d=SN(e.v||"");break}var p=Xs(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var g=e.v!=null?d:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=nM(e.c)),ge("Cell",m,o)}function sM(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ko(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function iM(e,t,r,n){if(!e["!ref"])return"";var a=Qe(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,k){zs(y);var b=!!y.width,w=dd(k,y),N={"ss:Index":k+1};b&&(N["ss:Width"]=Hc(w.width)),y.hidden&&(N["ss:Hidden"]="1"),o.push(ge("Column",null,N))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var f=[sM(c,(e["!rows"]||[])[c])],h=a.s.c;h<=a.e.c;++h){var d=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>h)&&!(s[i].s.r>c)&&!(s[i].e.c<h)&&!(s[i].e.r<c)){(s[i].s.c!=h||s[i].s.r!=c)&&(d=!0);break}if(!d){var p={r:c,c:h},g=Oe(p),m=l?(e[c]||[])[h]:e[g];f.push(aM(m,g,e,t,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function oM(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?tM(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?iM(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(rM(s,t,e,r)),n.join("")}function lM(e,t){t||(t={}),e.SSF||(e.SSF=gt(Re)),e.SSF&&(nl(),lu(e.SSF),t.revssf=od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Xs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(QF(e,t)),r.push(JF()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ge("Worksheet",oM(n,t,e),{"ss:Name":ft(e.SheetNames[n])}));return r[2]=ZF(e,t),r[3]=eM(e),Gt+ge("Workbook",r.join(""),{xmlns:fn.ss,"xmlns:o":fn.o,"xmlns:x":fn.x,"xmlns:ss":fn.ss,"xmlns:dt":fn.dt,"xmlns:html":fn.html})}function cM(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=tI(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=rI(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var uM=[60,1084,2066,2165,2175];function fM(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Da(r,r.l),c=X1[l],f=0;c!=null&&uM.indexOf(l)>-1;)s=Da(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=X1[l=Da(r,r.l)];var h=pr(i);wr(h,0);var d=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(d),d+=i[p].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function sa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Re[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||qa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Uc(e.v):e.w=Si(e.v):e.w=yn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Fi(Re[n]||String(n))){var a=ms(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function lf(e,t,r){return{v:e,ixfe:t,t:r}}function hM(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},h,d="",p,g,m,y,k={},b=[],w,N,_=[],F=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},x=function(Ve){return Ve<8?Ao[Ve]:Ve<64&&F[Ve-8]||Ao[Ve]},I=function(Ve,mt,Wr){var Ft=mt.XF.data;if(!(!Ft||!Ft.patternType||!Wr||!Wr.cellStyles)){mt.s={},mt.s.patternType=Ft.patternType;var ln;(ln=Wc(x(Ft.icvFore)))&&(mt.s.fgColor={rgb:ln}),(ln=Wc(x(Ft.icvBack)))&&(mt.s.bgColor={rgb:ln})}},A=function(Ve,mt,Wr){if(!(Ae>1)&&!(Wr.sheetRows&&Ve.r>=Wr.sheetRows)){if(Wr.cellStyles&&mt.XF&&mt.XF.data&&I(Ve,mt,Wr),delete mt.ixfe,delete mt.XF,h=Ve,d=Oe(Ve),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<i.s.r&&(i.s.r=Ve.r),Ve.c<i.s.c&&(i.s.c=Ve.c),Ve.r+1>i.e.r&&(i.e.r=Ve.r+1),Ve.c+1>i.e.c&&(i.e.c=Ve.c+1),Wr.cellFormula&&mt.f){for(var Ft=0;Ft<b.length;++Ft)if(!(b[Ft][0].s.c>Ve.c||b[Ft][0].s.r>Ve.r)&&!(b[Ft][0].e.c<Ve.c||b[Ft][0].e.r<Ve.r)){mt.F=Ue(b[Ft][0]),(b[Ft][0].s.c!=Ve.c||b[Ft][0].s.r!=Ve.r)&&delete mt.f,mt.f&&(mt.f=""+Or(b[Ft][1],i,Ve,te,R));break}}Wr.dense?(a[Ve.r]||(a[Ve.r]=[]),a[Ve.r][Ve.c]=mt):a[d]=mt}},R={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var D,de=[],ue=[],xe=[],Se=[],q=!1,te=[];te.SheetNames=R.snames,te.sharedf=R.sharedf,te.arrayf=R.arrayf,te.names=[],te.XTI=[];var fe=0,Ae=0,j=0,G=[],W=[],H;R.codepage=1200,Ln(1200);for(var ee=!1;e.l<e.length-1;){var he=e.l,ie=e.read_shift(2);if(ie===0&&fe===10)break;var me=e.l===e.length?0:e.read_shift(2),pe=X1[ie];if(pe&&pe.f){if(t.bookSheets&&fe===133&&ie!==133)break;if(fe=ie,pe.r===2||pe.r==12){var je=e.read_shift(2);if(me-=2,!R.enc&&je!==ie&&((je&255)<<8|je>>8)!==ie)throw new Error("rt mismatch: "+je+"!="+ie);pe.r==12&&(e.l+=10,me-=10)}var V={};if(ie===10?V=pe.f(e,me,R):V=fM(ie,pe,e,me,R),Ae==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(ie){case 34:r.opts.Date1904=T.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=V;break;case 66:var it=Number(V);switch(it){case 21010:it=1200;break;case 32768:it=1e4;break;case 32769:it=1252;break}Ln(R.codepage=it),ee=!0;break;case 317:R.rrtabid=V;break;case 25:R.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:R.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:_.push(V);break;case 430:te.push([V]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(V);break;case 24:case 536:H={Name:V.Name,Ref:Or(V.rgce,i,null,te,R)},V.itab>0&&(H.Sheet=V.itab-1),te.names.push(H),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(W[V.itab-1]={ref:Ue(V.rgce[0][0][1][2])});break;case 22:R.ExternCount=V;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(V),te.XTI=te.XTI.concat(V);break;case 2196:if(R.biff<8)break;H!=null&&(H.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&R.WTF&&console.error("Password verifier: "+V);break;case 133:s[V.pos]=V,R.snames.push(V.name);break;case 10:{if(--Ae)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ue(i),t.sheetRows&&t.sheetRows<=i.e.r){var Je=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ue(i),i.e.r=Je}i.e.r++,i.e.c++}de.length>0&&(a["!merges"]=de),ue.length>0&&(a["!objects"]=ue),xe.length>0&&(a["!cols"]=xe),Se.length>0&&(a["!rows"]=Se),T.Sheets.push(S)}c===""?f=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),R.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(R.biff=5,ee=!0,Ln(R.codepage=28591)),R.biff==8&&V.BIFFVer==0&&V.dt==16&&(R.biff=2),Ae++)break;if(a=t.dense?[]:{},R.biff<8&&!ee&&(ee=!0,Ln(R.codepage=t.codepage||1252)),R.biff<5||V.BIFFVer==0&&V.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ot={pos:e.l-me,name:c};s[ot.pos]=ot,R.snames.push(c)}else c=(s[he]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),de=[],ue=[],R.arrayf=b=[],xe=[],Se=[],q=!1,S={Hidden:(s[he]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[V.r]||[])[V.c]:a[Oe({c:V.c,r:V.r})])&&++V.c,w={ixfe:V.ixfe,XF:_[V.ixfe]||{},v:V.val,t:"n"},j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:V.c,r:V.r},w,t);break;case 5:case 517:w={ixfe:V.ixfe,XF:_[V.ixfe],v:V.val,t:V.t},j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:V.c,r:V.r},w,t);break;case 638:w={ixfe:V.ixfe,XF:_[V.ixfe],v:V.rknum,t:"n"},j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:V.c,r:V.r},w,t);break;case 189:for(var ze=V.c;ze<=V.C;++ze){var we=V.rkrec[ze-V.c][0];w={ixfe:we,XF:_[we],v:V.rkrec[ze-V.c][1],t:"n"},j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:ze,r:V.r},w,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(w=lf(V.val,V.cell.ixfe,V.tt),w.XF=_[w.ixfe],t.cellFormula){var Lt=V.formula;if(Lt&&Lt[0]&&Lt[0][0]&&Lt[0][0][0]=="PtgExp"){var dt=Lt[0][0][1][0],st=Lt[0][0][1][1],ea=Oe({r:dt,c:st});k[ea]?w.f=""+Or(V.formula,i,V.cell,te,R):w.F=((t.dense?(a[dt]||[])[st]:a[ea])||{}).F}else w.f=""+Or(V.formula,i,V.cell,te,R)}j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A(V.cell,w,t),o=V}break;case 7:case 519:if(o)o.val=V,w=lf(V,o.cell.ixfe,"s"),w.XF=_[w.ixfe],t.cellFormula&&(w.f=""+Or(o.formula,i,o.cell,te,R)),j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(V);var Ka=Oe(V[0].s);if(p=t.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[Ka],t.cellFormula&&p){if(!o||!Ka||!p)break;p.f=""+Or(V[1],i,V[0],te,R),p.F=Ue(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;k[Oe(o.cell)]=V[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Oe(o.cell)],(p||{}).f=""+Or(V[0],i,h,te,R)}}break;case 253:w=lf(l[V.isst].t,V.ixfe,"s"),l[V.isst].h&&(w.h=l[V.isst].h),w.XF=_[w.ixfe],j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:V.c,r:V.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:V.ixfe,XF:_[V.ixfe],t:"z"},j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:V.c,r:V.r},w,t));break;case 190:if(t.sheetStubs)for(var lr=V.c;lr<=V.C;++lr){var Sa=V.ixfe[lr-V.c];w={ixfe:Sa,XF:_[Sa],t:"z"},j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:lr,r:V.r},w,t)}break;case 214:case 516:case 4:w=lf(V.val,V.ixfe,"s"),w.XF=_[w.ixfe],j>0&&(w.z=G[w.ixfe>>8&63]),sa(w,t,r.opts.Date1904),A({c:V.c,r:V.r},w,t);break;case 0:case 512:Ae===1&&(i=V);break;case 252:l=V;break;case 1054:if(R.biff==4){G[j++]=V[1];for(var Qr=0;Qr<j+163&&Re[Qr]!=V[1];++Qr);Qr>=163&&ba(V[1],j+163)}else ba(V[1],V[0]);break;case 30:{G[j++]=V;for(var Vn=0;Vn<j+163&&Re[Vn]!=V;++Vn);Vn>=163&&ba(V,j+163)}break;case 229:de=de.concat(V);break;case 93:ue[V.cmo[0]]=R.lastobj=V;break;case 438:R.lastobj.TxO=V;break;case 127:R.lastobj.ImData=V;break;case 440:for(y=V[0].s.r;y<=V[0].e.r;++y)for(m=V[0].s.c;m<=V[0].e.c;++m)p=t.dense?(a[y]||[])[m]:a[Oe({c:m,r:y})],p&&(p.l=V[1]);break;case 2048:for(y=V[0].s.r;y<=V[0].e.r;++y)for(m=V[0].s.c;m<=V[0].e.c;++m)p=t.dense?(a[y]||[])[m]:a[Oe({c:m,r:y})],p&&p.l&&(p.l.Tooltip=V[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;p=t.dense?(a[V[0].r]||[])[V[0].c]:a[Oe(V[0])];var Tn=ue[V[2]];p||(t.dense?(a[V[0].r]||(a[V[0].r]=[]),p=a[V[0].r][V[0].c]={t:"z"}):p=a[Oe(V[0])]={t:"z"},i.e.r=Math.max(i.e.r,V[0].r),i.s.r=Math.min(i.s.r,V[0].r),i.e.c=Math.max(i.e.c,V[0].c),i.s.c=Math.min(i.s.c,V[0].c)),p.c||(p.c=[]),g={a:V[1],t:Tn.TxO.t},p.c.push(g)}break;case 2173:eD(_[V.ixfe],V.ext);break;case 125:{if(!R.cellStyles)break;for(;V.e>=V.s;)xe[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},q||(q=!0,Zm(V.w/256)),zs(xe[V.e+1])}break;case 520:{var on={};V.level!=null&&(Se[V.r]=on,on.level=V.level),V.hidden&&(Se[V.r]=on,on.hidden=!0),V.hpt&&(Se[V.r]=on,on.hpt=V.hpt,on.hpx=Ko(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||mi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=V;break;case 161:a["!margins"]||mi(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(T.Views[0].RTL=!0);break;case 146:F=V;break;case 2198:D=V;break;case 140:N=V;break;case 442:c?S.CodeName=V||S.name:T.WBProps.CodeName=V||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=me}return r.SheetNames=Bt(s).sort(function(Ve,mt){return Number(Ve)-Number(mt)}).map(function(Ve){return s[Ve].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&W.forEach(function(Ve,mt){r.Sheets[r.SheetNames[mt]]["!autofilter"]=Ve}),r.Strings=l,r.SSF=gt(Re),R.enc&&(r.Encryption=R.enc),D&&(r.Themes=D),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),te.names.length>0&&(T.Names=te.names),r.Workbook=T,r}var oc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function dM(e,t,r){var n=Ie.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Mb(n,B1,oc.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Ie.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Mb(i,W1,oc.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(iT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function pM(e,t){var r=[],n=[],a=[],s=0,i,o=db(B1,"n"),l=db(W1,"n");if(e.Props)for(i=Bt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Bt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<a.length;++s)dT.indexOf(a[s][0])>-1||sT.indexOf(a[s][0])>-1||a[s][1]!=null&&c.push(a[s]);n.length&&Ie.utils.cfb_add(t,"/SummaryInformation",Ub(n,oc.SI,l,W1)),(r.length||c.length)&&Ie.utils.cfb_add(t,"/DocumentSummaryInformation",Ub(r,oc.DSI,o,B1,c.length?c:null,oc.UDI))}function og(e,t){t||(t={}),cg(t),sd(),t.codepage&&ad(t.codepage);var r,n;if(e.FullPaths){if(Ie.find(e,"/encryption"))throw new Error("File is password-protected");r=Ie.find(e,"!CompObj"),n=Ie.find(e,"/Workbook")||Ie.find(e,"/Book")}else{switch(t.type){case"base64":e=hn(bn(e));break;case"binary":e=hn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var a,s;if(r&&cM(r),t.bookProps&&!t.bookSheets)a={};else{var i=$e?"buffer":"array";if(n&&n.content)a=hM(n.content,t);else if((s=Ie.find(e,"PerfectOffice_MAIN"))&&s.content)a=qo.to_workbook(s.content,(t.type=i,t));else if((s=Ie.find(e,"NativeContent_MAIN"))&&s.content)a=qo.to_workbook(s.content,(t.type=i,t));else throw(s=Ie.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ie.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=AD(e))}var o={};return e.FullPaths&&dM(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function mM(e,t){var r=t||{},n=Ie.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ie.utils.cfb_add(n,a,cE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&pM(e,n),r.biff==8&&e.vbaraw&&ND(n,Ie.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var qc={0:{f:zP},1:{f:KP},2:{f:dL},3:{f:rL},4:{f:JP},5:{f:uL},6:{f:bL},7:{f:iL},8:{f:xL},9:{f:SL},10:{f:TL},11:{f:EL},12:{f:YP},13:{f:mL},14:{f:aL},15:{f:eL},16:{f:eE},17:{f:wL},18:{f:lL},19:{f:Wm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yF},40:{},42:{},43:{f:b7},44:{f:g7},45:{f:k7},46:{f:E7},47:{f:T7},48:{},49:{f:WN},50:{},51:{f:nD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ST},62:{f:vL},63:{f:hD},64:{f:VL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ML},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GP},148:{f:WP,p:16},151:{f:RL},152:{},153:{f:gF},154:{},155:{},156:{f:pF},157:{},158:{},159:{T:1,f:OR},160:{T:-1},161:{T:1,f:Vi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_L},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tD},336:{T:-1},337:{f:iD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:V1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ET},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DL},427:{f:OL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:LL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$P},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:V1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ED},633:{T:1},634:{T:-1},635:{T:1,f:kD},636:{T:-1},637:{f:qN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:aF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:BL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},X1={6:{f:vp},10:{f:is},12:{f:Yt},13:{f:Yt},14:{f:Wt},15:{f:Wt},16:{f:Mr},17:{f:Wt},18:{f:Wt},19:{f:Yt},20:{f:Hb},21:{f:Hb},23:{f:ET},24:{f:Gb},25:{f:Wt},26:{},27:{},28:{f:B9},29:{},34:{f:Wt},35:{f:$b},38:{f:Mr},39:{f:Mr},40:{f:Mr},41:{f:Mr},42:{f:Wt},43:{f:Wt},47:{f:e7},49:{f:m9},51:{f:Yt},60:{},61:{f:u9},64:{f:Wt},65:{f:p9},66:{f:Yt},77:{},80:{},81:{},82:{},85:{f:Yt},89:{},90:{},91:{},92:{f:ZI},93:{f:$9},94:{},95:{f:Wt},96:{},97:{},99:{f:Wt},125:{f:ST},128:{f:I9},129:{f:t9},130:{f:Yt},131:{f:Wt},132:{f:Wt},133:{f:r9},134:{},140:{f:Z9},141:{f:Yt},144:{},146:{f:rR},151:{},152:{},153:{},154:{},155:{},156:{f:Yt},157:{},158:{},160:{f:cR},161:{f:sR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_9},190:{f:C9},193:{f:is},197:{},198:{},199:{},200:{},201:{},202:{f:Wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yt},220:{},221:{f:Wt},222:{},224:{f:N9},225:{f:JI},226:{f:is},227:{},229:{f:W9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:a9},253:{f:v9},255:{f:i9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wt},353:{f:is},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:L9},431:{f:Wt},432:{},433:{},434:{},437:{},438:{f:K9},439:{f:Wt},440:{f:X9},441:{},442:{f:fu},443:{},444:{f:Yt},445:{},446:{},448:{f:is},449:{f:c9,r:2},450:{f:is},512:{f:Vb},513:{f:lR},515:{f:O9},516:{f:y9},517:{f:Wb},519:{f:uR},520:{f:o9},523:{},545:{f:qb},549:{f:zb},566:{},574:{f:h9},638:{f:x9},659:{},1048:{},1054:{f:k9},1084:{},1212:{f:j9},2048:{f:Q9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:af},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:is},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nR,r:12},2173:{f:Z7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:U9,r:12},2197:{},2198:{f:q7,r:12},2199:{},2200:{},2201:{},2202:{f:z9,r:12},2203:{f:is},2204:{},2205:{},2206:{},2207:{},2211:{f:l9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:iR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Vb},1:{},2:{f:mR},3:{f:dR},4:{f:hR},5:{f:Wb},7:{f:vR},8:{},9:{f:af},11:{},22:{f:Yt},30:{f:E9},31:{},32:{},33:{f:qb},36:{},37:{f:zb},50:{f:bR},62:{},52:{},67:{},68:{f:Yt},69:{},86:{},126:{},127:{f:fR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yR},223:{},234:{},354:{},421:{},518:{f:vp},521:{f:af},536:{f:Gb},547:{f:$b},561:{},579:{},1030:{f:vp},1033:{f:af},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function be(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&zm(r)&&e.push(r)}}function gM(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return be(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function mu(e,t,r){return e||(e=ne(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function vM(e,t,r,n){var a=ne(9);return mu(a,e,t),mT(r,n||"b",a),a}function bM(e,t,r){var n=ne(8+2*r.length);return mu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function yM(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?or(Ct(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?be(e,2,gR(r,n,a)):be(e,3,pR(r,n,a));return;case"b":case"e":be(e,5,vM(r,n,t.v,t.t));return;case"s":case"str":be(e,4,bM(r,n,(t.v||"").slice(0,255)));return}be(e,1,mu(null,r,n))}function wM(e,t,r,n){var a=Array.isArray(t),s=Qe(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ue(s)}for(var c=s.s.r;c<=s.e.r;++c){o=zt(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=_t(f)),i=l[f]+o;var h=a?(t[c]||[])[f]:t[i];h&&yM(e,h,c,f)}}}function kM(e,t){for(var r=t||{},n=sn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return be(n,r.biff==4?1033:r.biff==3?521:9,Ym(e,16,r)),wM(n,e.Sheets[e.SheetNames[a]],a,r),be(n,10),n.end()}function TM(e,t,r){be(e,49,g9({sz:12,name:"Arial"},r))}function EM(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&be(e,1054,T9(a,t[a],r))})}function SM(e,t){var r=ne(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),be(e,2151,r),r=ne(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),wT(Qe(t["!ref"]||"A1"),r),r.write_shift(4,4),be(e,2152,r)}function xM(e,t){for(var r=0;r<16;++r)be(e,224,Bb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){be(e,224,Bb(n,0,t))})}function _M(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];be(e,440,Y9(n)),n[1].Tooltip&&be(e,2048,J9(n))}delete t["!links"]}function CM(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&be(e,125,aR(dd(a,n),a))})}}function AM(e,t,r,n,a){var s=16+Xs(a.cellXfs,t,a);if(t.v==null&&!t.bf){be(e,513,Ai(r,n,s));return}if(t.bf)be(e,6,tP(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?or(Ct(t.v)):t.v;be(e,515,P9(r,n,i,s));break;case"b":case"e":be(e,517,D9(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=ag(a.Strings,t.v,a.revStrings);be(e,253,b9(r,n,o,s))}else be(e,516,w9(r,n,(t.v||"").slice(0,255),s,a));break;default:be(e,513,Ai(r,n,s))}}function NM(e,t,r){var n=sn(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,f,h="",d=[],p=Qe(s["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}be(n,2057,Ym(r,16,t)),be(n,13,Nn(1)),be(n,12,Nn(100)),be(n,15,Gr(!0)),be(n,17,Gr(!1)),be(n,16,_i(.001)),be(n,95,Gr(!0)),be(n,42,Gr(!1)),be(n,43,Gr(!1)),be(n,130,Nn(1)),be(n,128,R9()),be(n,131,Gr(!1)),be(n,132,Gr(!1)),c&&CM(n,s["!cols"]),be(n,512,S9(p,t)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=zt(m);for(var y=p.s.c;y<=p.e.c;++y){m===p.s.r&&(d[y]=_t(y)),f=d[y]+h;var k=l?(s[m]||[])[y]:s[f];k&&(AM(n,k,m,y,t),c&&k.l&&s["!links"].push([f,k.l]))}}var b=o.CodeName||o.name||a;return c&&be(n,574,d9((i.Views||[])[0])),c&&(s["!merges"]||[]).length&&be(n,229,H9(s["!merges"])),c&&_M(n,s),be(n,442,gT(b)),c&&SM(n,s),be(n,10),n.end()}function IM(e,t,r){var n=sn(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(be(n,2057,Ym(e,5,r)),r.bookType=="xla"&&be(n,135),be(n,225,o?Nn(1200):null),be(n,193,DI(2)),l&&be(n,191),l&&be(n,192),be(n,226),be(n,92,e9("SheetJS",r)),be(n,66,Nn(o?1200:1252)),o&&be(n,353,Nn(0)),o&&be(n,448),be(n,317,oR(e.SheetNames.length)),o&&e.vbaraw&&be(n,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";be(n,442,gT(c))}be(n,156,Nn(17)),be(n,25,Gr(!1)),be(n,18,Gr(!1)),be(n,19,Nn(0)),o&&be(n,431,Gr(!1)),o&&be(n,444,Nn(0)),be(n,61,f9()),be(n,64,Gr(!1)),be(n,141,Nn(0)),be(n,34,Gr(cF(e)=="true")),be(n,14,Gr(!0)),o&&be(n,439,Gr(!1)),be(n,218,Nn(0)),TM(n,e,r),EM(n,e.SSF,r),xM(n,r),o&&be(n,352,Gr(!1));var f=n.end(),h=sn();o&&be(h,140,eR()),o&&r.Strings&&gM(h,252,s9(r.Strings)),be(h,10);var d=h.end(),p=sn(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var y=f.length+g+d.length;for(m=0;m<e.SheetNames.length;++m){var k=s[m]||{};be(p,133,n9({pos:y,hs:k.Hidden||0,dt:0,name:e.SheetNames[m]},r)),y+=t[m].length}var b=p.end();if(g!=b.length)throw new Error("BS8 "+g+" != "+b.length);var w=[];return f.length&&w.push(f),b.length&&w.push(b),d.length&&w.push(d),pr(w)}function RM(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=gt(Re)),e&&e.SSF&&(nl(),lu(e.SSF),r.revssf=od(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ug(r),r.cellXfs=[],Xs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=NM(a,r,e);return n.unshift(IM(e,n,r)),pr(n)}function cE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Kr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return RM(e,t);case 4:case 3:case 2:return kM(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function ny(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=gN(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var m=l[i].trim(),y=m.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var k=m.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var b=k[o].trim();if(b.match(/<t[dh]/i)){for(var w=b,N=0;w.charAt(0)=="<"&&(N=w.indexOf(">"))>-1;)w=w.slice(N+1);for(var _=0;_<g.length;++_){var F=g[_];F.s.c==f&&F.s.r<c&&c<=F.e.r&&(f=F.e.c+1,_=-1)}var T=Le(b.slice(0,b.indexOf(">")));d=T.colspan?+T.colspan:1,((h=+T.rowspan)>1||d>1)&&g.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var S=T.t||T["data-t"]||"";if(!w.length){f+=d;continue}if(w=M3(w),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!w.length){f+=d;continue}var x={t:"s",v:w};r.raw||!w.trim().length||S=="s"||(w==="TRUE"?x={t:"b",v:!0}:w==="FALSE"?x={t:"b",v:!1}:isNaN(Qn(w))?isNaN($o(w).getDate())||(x={t:"d",v:Ct(w)},r.cellDates||(x={t:"n",v:or(x.v)}),x.z=r.dateNF||Re[14]):x={t:"n",v:Qn(w)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=x):n[Oe({r:c,c:f})]=x,f+=d}}}}return n["!ref"]=Ue(p),g.length&&(n["!merges"]=g),n}function uE(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=Oe({r,c:i}),h=n.dense?(e[r]||[])[i]:e[f],d=h&&h.v!=null&&(h.h||Om(h.w||(ka(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+f,s.push(ge("td",d,p))}}var g="<tr>";return g+s.join("")+"</tr>"}var fE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hE="</body></html>";function DM(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ks(ny(r[0],t),t);var n=mg();return r.forEach(function(a,s){gg(n,ny(a,t),"Sheet"+(s+1))}),n}function dE(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pE(e,t){var r=t||{},n=r.header!=null?r.header:fE,a=r.footer!=null?r.footer:hE,s=[n],i=Kr(e["!ref"]);r.dense=Array.isArray(e),s.push(dE(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(uE(e,i,o,r));return s.push("</table>"+a),s.join("")}function mE(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Rt(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=Kr(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var h=[],d=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,y=0,k=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<l;++g){var N=o[g];if(ay(N)){if(n.display)continue;p[m]={hidden:!0}}var _=N.children;for(y=k=0;y<_.length;++y){var F=_[y];if(!(n.display&&ay(F))){var T=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):M3(F.innerHTML),S=F.getAttribute("data-z")||F.getAttribute("z");for(d=0;d<h.length;++d){var x=h[d];x.s.c==k+s&&x.s.r<m+a&&m+a<=x.e.r&&(k=x.e.c+1-s,d=-1)}w=+F.getAttribute("colspan")||1,((b=+F.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:m+a,c:k+s},e:{r:m+a+(b||1)-1,c:k+s+(w||1)-1}});var I={t:"s",v:T},A=F.getAttribute("data-t")||F.getAttribute("t")||"";T!=null&&(T.length==0?I.t=A||"z":n.raw||T.trim().length==0||A=="s"||(T==="TRUE"?I={t:"b",v:!0}:T==="FALSE"?I={t:"b",v:!1}:isNaN(Qn(T))?isNaN($o(T).getDate())||(I={t:"d",v:Ct(T)},n.cellDates||(I={t:"n",v:or(I.v)}),I.z=n.dateNF||Re[14]):I={t:"n",v:Qn(T)})),I.z===void 0&&S!=null&&(I.z=S);var R="",D=F.getElementsByTagName("A");if(D&&D.length)for(var de=0;de<D.length&&!(D[de].hasAttribute("href")&&(R=D[de].getAttribute("href"),R.charAt(0)!="#"));++de);R&&R.charAt(0)!="#"&&(I.l={Target:R}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][k+s]=I):e[Oe({c:k+s,r:m+a})]=I,c.e.c<k+s&&(c.e.c=k+s),k+=w}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Ue(c),m>=l&&(e["!fullref"]=Ue((c.e.r=o.length-g+m-1+a,c))),e}function gE(e,t){var r=t||{},n=r.dense?[]:{};return mE(n,e,t)}function OM(e,t){return Ks(gE(e,t),t)}function ay(e){var t="",r=PM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function PM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function LM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=nt(t.replace(/<[^>]*>/g,""));return[r]}var sy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vE(e,t){var r=t||{},n=Pm(e),a=[],s,i,o={name:""},l="",c=0,f,h,d={},p=[],g=r.dense?[]:{},m,y,k={value:""},b="",w=0,N=[],_=-1,F=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,x={},I=[],A={},R=0,D=0,de=[],ue=1,xe=1,Se=[],q={Names:[]},te={},fe=["",""],Ae=[],j={},G="",W=0,H=!1,ee=!1,he=0;for(Vc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Vc.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?g["!ref"]=Ue(T):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=Ue(T)),I.length&&(g["!merges"]=I),de.length&&(g["!rows"]=de),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),d[f.name]=g,ee=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Le(m[0],!1),_=F=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,g=r.dense?[]:{},I=[],de=[],ee=!0);break;case"table-row-group":m[1]==="/"?--S:++S;break;case"table-row":case"":if(m[1]==="/"){_+=ue,ue=1;break}if(h=Le(m[0],!1),h.?_=h.-1:_==-1&&(_=0),ue=+h["number-rows-repeated"]||1,ue<10)for(he=0;he<ue;++he)S>0&&(de[_+he]={level:S});F=-1;break;case"covered-table-cell":m[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(g[_]||(g[_]=[]),g[_][F]={t:"z"}):g[Oe({r:_,c:F})]={t:"z"}),b="",N=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++F,k=Le(m[0],!1),xe=parseInt(k["number-columns-repeated"]||"1",10),y={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(y.f=ey(nt(k.formula))),(k.||k["value-type"])=="string"&&(y.t="s",y.v=nt(k["string-value"]||""),r.dense?(g[_]||(g[_]=[]),g[_][F]=y):g[Oe({r:_,c:F})]=y),F+=xe-1;else if(m[1]!=="/"){++F,b="",w=0,N=[],xe=1;var ie=ue?_+ue-1:_;if(F>T.e.c&&(T.e.c=F),F<T.s.c&&(T.s.c=F),_<T.s.r&&(T.s.r=_),ie>T.e.r&&(T.e.r=ie),k=Le(m[0],!1),Ae=[],j={},y={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=nt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(R=parseInt(k["number-matrix-rows-spanned"],10)||0,D=parseInt(k["number-matrix-columns-spanned"],10)||0,A={s:{r:_,c:F},e:{r:_+R-1,c:F+D-1}},y.F=Ue(A),Se.push([A,y.F])),k.formula)y.f=ey(k.formula);else for(he=0;he<Se.length;++he)_>=Se[he][0].s.r&&_<=Se[he][0].e.r&&F>=Se[he][0].s.c&&F<=Se[he][0].e.c&&(y.F=Se[he][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(R=parseInt(k["number-rows-spanned"],10)||0,D=parseInt(k["number-columns-spanned"],10)||0,A={s:{r:_,c:F},e:{r:_+R-1,c:F+D-1}},I.push(A)),k["number-columns-repeated"]&&(xe=parseInt(k["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Et(k["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(k.value);break;case"percentage":y.t="n",y.v=parseFloat(k.value);break;case"currency":y.t="n",y.v=parseFloat(k.value);break;case"date":y.t="d",y.v=Ct(k["date-value"]),r.cellDates||(y.t="n",y.v=or(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=dN(k["time-value"])/86400,r.cellDates&&(y.t="d",y.v=ld(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(k.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",k["string-value"]!=null&&(b=nt(k["string-value"]),N=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(H=!1,y.t==="s"&&(y.v=b||"",N.length&&(y.R=N),H=w==0),te.Target&&(y.l=te),Ae.length>0&&(y.c=Ae,Ae=[]),b&&r.cellText!==!1&&(y.w=b),H&&(y.t="z",delete y.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var me=0;me<ue;++me){if(xe=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(g[_+me]||(g[_+me]=[]),g[_+me][F]=me==0?y:gt(y);--xe>0;)g[_+me][F+xe]=gt(y);else for(g[Oe({r:_+me,c:F})]=y;--xe>0;)g[Oe({r:_+me,c:F+xe})]=gt(y);T.e.c<=F&&(T.e.c=F)}xe=parseInt(k["number-columns-repeated"]||"1",10),F+=xe-1,xe=0,y={},b="",N=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;j.t=b,N.length&&(j.R=N),j.a=G,Ae.push(j)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);G="",W=0,b="",w=0,N=[];break;case"creator":m[1]==="/"?G=n.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);b="",w=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(x[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Le(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Le(m[0],!1),l+=sy[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Le(m[0],!1),l+=sy[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=Le(m[0],!1),fe=bp(i["cell-range-address"]);var pe={Name:i.name,Ref:fe[0]+"!"+fe[1]};ee&&(pe.Sheet=p.length),q.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!k||!k["string-value"])){var je=LM(n.slice(w,m.index));b=(b.length>0?b+`
`:"")+je[0]}else Le(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{fe=bp(Le(m[0])["target-range-address"]),d[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(te=Le(m[0],!1),!te.href)break;te.Target=nt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(fe=bp(te.Target.slice(1)),te.Target="#"+fe[0]+"!"+fe[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var V={Sheets:d,SheetNames:p,Workbook:q};return r.bookSheets&&delete V.Sheets,V}function FM(e,t){t=t||{},An(e,"META-INF/manifest.xml")&&dI(Xt(e,"META-INF/manifest.xml"),t);var r=dn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=vE(pt(r),t);return An(e,"meta.xml")&&(n.Props=nT(Xt(e,"meta.xml"))),n}function MM(e,t){return vE(e,t)}var UM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+zc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Gt+t}}(),iy=function(){var e=function(s){return ft(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+ft(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=Kr(s["!ref"]||"A1"),d=s["!merges"]||[],p=0,g=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",y=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)l.push(t);for(;f<=h.e.c;++f){var k=!1,b={},w="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>f)&&!(d[p].s.r>c)&&!(d[p].e.c<f)&&!(d[p].e.r<c)){(d[p].s.c!=f||d[p].s.r!=c)&&(k=!0),b["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,b["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(k){l.push(r);continue}var N=Oe({r:c,c:f}),_=g?(s[c]||[])[f]:s[N];if(_&&_.f&&(b["table:formula"]=ft(oP(_.f)),_.F&&_.F.slice(0,N.length)==N)){var F=Kr(_.F);b["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,b["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!_){l.push(t);continue}switch(_.t){case"b":w=_.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=_.v?"true":"false";break;case"n":w=_.w||String(_.v||0),b["office:value-type"]="float",b["office:value"]=_.v||0;break;case"s":case"str":w=_.v==null?"":_.v,b["office:value-type"]="string";break;case"d":w=_.w||Ct(_.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Ct(_.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(t);continue}var T=e(w);if(_.l&&_.l.Target){var S=_.l.Target;S=S.charAt(0)=="#"?"#"+lP(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),T=ge("text:a",T,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+ge("table:table-cell",ge("text:p",T,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;zs(h),h.ods=o;var d=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var h=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(s,i){var o=[Gt],l=zc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=zc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});i.bookType=="fods"?(o.push("<office:document"+l+c+`>
`),o.push(rT().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+l+`>
`),a(o,s),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)o.push(n(s.Sheets[s.SheetNames[f]],s,f));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),i.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function bE(e,t){if(t.bookType=="fods")return iy(e,t);var r=Im(),n="",a=[],s=[];return n="mimetype",Be(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Be(r,n,iy(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Be(r,n,UM(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Be(r,n,Gt+rT()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Be(r,n,gI(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Be(r,n,pI(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ni(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Y1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):pt(qs(e))}function jM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):hn(fa(e))}function zM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Bs(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function oy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function VM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function BM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Kc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ct(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Vt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function at(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Kc(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Kc(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function vr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ct(n*8+a.type)),a.type==2&&t.push(ct(a.data.length)),t.push(a.data))})}),Bs(t)}function lg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function _n(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Kc(e,n),s=at(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Vt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=at(o.data),c=Vt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Vt(s[3][0].data)>>>0>0),r.push(i)}return r}function Yi(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ct(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ct(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:ct(i.data.length)}],n[2].push({data:vr(i.meta),type:2})});var s=vr(n);t.push(ct(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),Bs(t)}function WM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Kc(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Bs(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=Bs(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Cn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(WM(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Bs(t)}function Qi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=ct(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Bs(t)}function HM(e,t,r,n){var a=Ni(e),s=a.getUint32(4,!0),i=(n>1?12:8)+oy(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=oy(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function $M(e,t,r){var n=Ni(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);a&1&&(l=VM(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return h}function wp(e,t){var r=new Uint8Array(32),n=Ni(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,BM(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function kp(e,t){var r=new Uint8Array(32),n=Ni(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function GM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return HM(e,t,r,e[0]);case 5:return $M(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Dr(e){var t=at(e);return Kc(t[1][0].data)}function ly(e,t){var r=at(t.data),n=Vt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=at(i.data),l=Vt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Y1(o[3][0].data);break;case 8:{var c=e[Dr(o[9][0].data)][0],f=at(c.data),h=e[Dr(f[1][0].data)][0],d=Vt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=at(h.data);s[l]=p[3].map(function(g){return Y1(g.data)}).join("")}break}}),s}function qM(e,t){var r,n,a,s,i,o,l,c,f,h,d,p,g,m,y=at(e),k=Vt(y[1][0].data)>>>0,b=Vt(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Vt(y[8][0].data)>0||!1,N,_;if((s=(a=y[7])==null?void 0:a[0])!=null&&s.data&&t!=0)N=(o=(i=y[7])==null?void 0:i[0])==null?void 0:o.data,_=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=y[4])==null?void 0:f[0])!=null&&h.data&&t!=1)N=(p=(d=y[4])==null?void 0:d[0])==null?void 0:p.data,_=(m=(g=y[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=w?4:1,T=Ni(N),S=[],x=0;x<N.length/2;++x){var I=T.getUint16(x*2,!0);I<65535&&S.push([x,I])}if(S.length!=b)throw"Expected ".concat(b," cells, found ").concat(S.length);var A=[];for(x=0;x<S.length-1;++x)A[S[x][0]]=_.subarray(S[x][1]*F,S[x+1][1]*F);return S.length>=1&&(A[S[S.length-1][0]]=_.subarray(S[S.length-1][1]*F)),{R:k,cells:A}}function KM(e,t){var r,n=at(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Vt(n[7][0].data)>>>0>0?1:0:-1,s=lg(n[5],function(i){return qM(i,a)});return{nrows:Vt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function XM(e,t,r){var n,a=at(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Vt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Vt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ue(s);var i=at(a[4][0].data),o=ly(e,e[Dr(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?ly(e,e[Dr(i[17][0].data)][0]):[],c=at(i[3][0].data),f=0;c[1].forEach(function(h){var d=at(h.data),p=e[Dr(d[2][0].data)][0],g=Vt(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=KM(e,p);m.data.forEach(function(y,k){y.forEach(function(b,w){var N=Oe({r:f+k,c:w}),_=GM(b,o,l);_&&(r[N]=_)})}),f+=m.nrows})}function YM(e,t){var r=at(t.data),n={"!ref":"A1"},a=e[Dr(r[2][0].data)],s=Vt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return XM(e,a[0],n),n}function QM(e,t){var r,n=at(t.data),a={name:(r=n[1])!=null&&r[0]?Y1(n[1][0].data):"",sheets:[]},s=lg(n[2],Dr);return s.forEach(function(i){e[i].forEach(function(o){var l=Vt(o.meta[1][0].data);l==6e3&&a.sheets.push(YM(e,o))})}),a}function JM(e,t){var r=mg(),n=at(t.data),a=lg(n[1],Dr);if(a.forEach(function(s){e[s].forEach(function(i){var o=Vt(i.meta[1][0].data);if(o==2){var l=QM(e,i);l.sheets.forEach(function(c,f){gg(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Tp(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Cn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=_n(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Vt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=Vt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return JM(s,o)}function ZM(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Vt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Ni(e[7][0].data),f=0,h=[],d=Ni(e[4][0].data),p=0,g=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,f,!0),d.setUint16(m*2,p,!0);var y,k;switch(typeof t[m]){case"string":y=wp({t:"s",v:t[m]},r),k=kp({t:"s",v:t[m]},r);break;case"number":y=wp({t:"n",v:t[m]},r),k=kp({t:"n",v:t[m]},r);break;case"boolean":y=wp({t:"b",v:t[m]},r),k=kp({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(y),f+=y.length,g.push(k),p+=k.length,++l}for(e[2][0].data=ct(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return e[6][0].data=Bs(h),e[3][0].data=Bs(g),l}function eU(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Kr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ue(n)));var s=_h(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(W){typeof W=="string"&&i.push(W)})});var o={},l=[],c=Ie.read(t.numbers,{type:"base64"});c.FileIndex.map(function(G,W){return[G,c.FullPaths[W]]}).forEach(function(G){var W=G[0],H=G[1];if(W.type==2&&W.name.match(/\.iwa/)){var ee=W.content,he=Cn(ee),ie=_n(he);ie.forEach(function(me){l.push(me.id),o[me.id]={deps:[],location:H,type:Vt(me.messages[0].meta[1][0].data)}})}}),l.sort(function(G,W){return G-W});var f=l.filter(function(G){return G>1}).map(function(G){return[G,ct(G)]});c.FileIndex.map(function(G,W){return[G,c.FullPaths[W]]}).forEach(function(G){var W=G[0];if(G[1],!!W.name.match(/\.iwa/)){var H=_n(Cn(W.content));H.forEach(function(ee){ee.messages.forEach(function(he){f.forEach(function(ie){ee.messages.some(function(me){return Vt(me.meta[1][0].data)!=11006&&zM(me.data,ie[1])})&&o[ie[0]].deps.push(ee.id)})})})}});for(var h=Ie.find(c,o[1].location),d=_n(Cn(h.content)),p,g=0;g<d.length;++g){var m=d[g];m.id==1&&(p=m)}var y=Dr(at(p.messages[0].data)[1][0].data);for(h=Ie.find(c,o[y].location),d=_n(Cn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==y&&(p=m);for(y=Dr(at(p.messages[0].data)[2][0].data),h=Ie.find(c,o[y].location),d=_n(Cn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==y&&(p=m);for(y=Dr(at(p.messages[0].data)[2][0].data),h=Ie.find(c,o[y].location),d=_n(Cn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==y&&(p=m);var k=at(p.messages[0].data);{k[6][0].data=ct(n.e.r+1),k[7][0].data=ct(n.e.c+1);var b=Dr(k[46][0].data),w=Ie.find(c,o[b].location),N=_n(Cn(w.content));{for(var _=0;_<N.length&&N[_].id!=b;++_);if(N[_].id!=b)throw"Bad ColumnRowUIDMapArchive";var F=at(N[_].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var T=0;T<=n.e.c;++T){var S=[];S[1]=S[2]=[{type:0,data:ct(T+420690)}],F[1].push({type:2,data:vr(S)}),F[2].push({type:0,data:ct(T)}),F[3].push({type:0,data:ct(T)})}F[4]=[],F[5]=[],F[6]=[];for(var x=0;x<=n.e.r;++x)S=[],S[1]=S[2]=[{type:0,data:ct(x+726270)}],F[4].push({type:2,data:vr(S)}),F[5].push({type:0,data:ct(x)}),F[6].push({type:0,data:ct(x)});N[_].messages[0].data=vr(F)}w.content=Qi(Yi(N)),w.size=w.content.length,delete k[46];var I=at(k[4][0].data);{I[7][0].data=ct(n.e.r+1);var A=at(I[1][0].data),R=Dr(A[2][0].data);w=Ie.find(c,o[R].location),N=_n(Cn(w.content));{if(N[0].id!=R)throw"Bad HeaderStorageBucket";var D=at(N[0].messages[0].data);for(x=0;x<s.length;++x){var de=at(D[2][0].data);de[1][0].data=ct(x),de[4][0].data=ct(s[x].length),D[2][x]={type:D[2][0].type,data:vr(de)}}N[0].messages[0].data=vr(D)}w.content=Qi(Yi(N)),w.size=w.content.length;var ue=Dr(I[2][0].data);w=Ie.find(c,o[ue].location),N=_n(Cn(w.content));{if(N[0].id!=ue)throw"Bad HeaderStorageBucket";for(D=at(N[0].messages[0].data),T=0;T<=n.e.c;++T)de=at(D[2][0].data),de[1][0].data=ct(T),de[4][0].data=ct(n.e.r+1),D[2][T]={type:D[2][0].type,data:vr(de)};N[0].messages[0].data=vr(D)}w.content=Qi(Yi(N)),w.size=w.content.length;var xe=Dr(I[4][0].data);(function(){for(var G=Ie.find(c,o[xe].location),W=_n(Cn(G.content)),H,ee=0;ee<W.length;++ee){var he=W[ee];he.id==xe&&(H=he)}var ie=at(H.messages[0].data);{ie[3]=[];var me=[];i.forEach(function(V,it){me[1]=[{type:0,data:ct(it)}],me[2]=[{type:0,data:ct(1)}],me[3]=[{type:2,data:jM(V)}],ie[3].push({type:2,data:vr(me)})})}H.messages[0].data=vr(ie);var pe=Yi(W),je=Qi(pe);G.content=je,G.size=G.content.length})();var Se=at(I[3][0].data);{var q=Se[1][0];delete Se[2];var te=at(q.data);{var fe=Dr(te[2][0].data);(function(){for(var G=Ie.find(c,o[fe].location),W=_n(Cn(G.content)),H,ee=0;ee<W.length;++ee){var he=W[ee];he.id==fe&&(H=he)}var ie=at(H.messages[0].data);{delete ie[6],delete Se[7];var me=new Uint8Array(ie[5][0].data);ie[5]=[];for(var pe=0,je=0;je<=n.e.r;++je){var V=at(me);pe+=ZM(V,s[je],i),V[1][0].data=ct(je),ie[5].push({data:vr(V),type:2})}ie[1]=[{type:0,data:ct(n.e.c+1)}],ie[2]=[{type:0,data:ct(n.e.r+1)}],ie[3]=[{type:0,data:ct(pe)}],ie[4]=[{type:0,data:ct(n.e.r+1)}]}H.messages[0].data=vr(ie);var it=Yi(W),Je=Qi(it);G.content=Je,G.size=G.content.length})()}q.data=vr(te)}I[3][0].data=vr(Se)}k[4][0].data=vr(I)}p.messages[0].data=vr(k);var Ae=Yi(d),j=Qi(Ae);return h.content=j,h.size=h.content.length,c}function yE(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function cg(e){yE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ug(e){yE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function tU(e){return Ge.WS.indexOf(e)>-1?"sheet":e==Ge.CS?"chart":e==Ge.DS?"dialog":e==Ge.MS?"macro":e&&e.length?e:"sheet"}function rU(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,tU(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function nU(e,t,r,n,a,s,i,o,l,c,f,h){try{s[n]=nc(dn(e,r,!0),t);var d=Xt(e,t),p;switch(o){case"sheet":p=CF(d,t,a,l,s[n],c,f,h);break;case"chart":if(p=AF(d,t,a,l,s[n],c,f,h),!p||!p["!drawel"])break;var g=jl(p["!drawel"].Target,t),m=Bc(g),y=mD(dn(e,g,!0),nc(dn(e,m,!0),g)),k=jl(y,g),b=Bc(k);p=rF(dn(e,k,!0),k,l,nc(dn(e,b,!0),k),c,p);break;case"macro":p=NF(d,t,a,l,s[n],c,f,h);break;case"dialog":p=IF(d,t,a,l,s[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var w=[];s&&s[n]&&Bt(s[n]).forEach(function(N){var _="";if(s[n][N].Type==Ge.CMNT){_=jl(s[n][N].Target,t);var F=PF(Xt(e,_,!0),_,l);if(!F||!F.length)return;Xb(p,F,!1)}s[n][N].Type==Ge.TCMNT&&(_=jl(s[n][N].Target,t),w=w.concat(vD(Xt(e,_,!0),l)))}),w&&w.length&&Xb(p,w,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Sn(e){return e.charAt(0)=="/"?e.slice(1):e}function wE(e,t){if(nl(),t=t||{},cg(t),An(e,"META-INF/manifest.xml")||An(e,"objectdata.xml"))return FM(e,t);if(An(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Tp<"u"){if(e.FileIndex)return Tp(e);var r=Ie.utils.cfb_new();return gb(e).forEach(function(de){Be(r,de,bN(e,de))}),Tp(r)}throw new Error("Unsupported NUMBERS file")}if(!An(e,"[Content_Types].xml"))throw An(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):An(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=gb(e),a=fI(dn(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Xt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Xt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(ac=[],a.sst)try{ac=OF(Xt(e,Sn(a.sst)),a.sst,t)}catch(de){if(t.WTF)throw de}t.cellStyles&&a.themes.length&&(l=DF(dn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=RF(Xt(e,Sn(a.style)),a.style,l,t))}a.links.map(function(de){try{var ue=nc(dn(e,Bc(Sn(de))),de);return FF(Xt(e,Sn(de)),ue,de,t)}catch{}});var f=_F(Xt(e,Sn(a.workbooks[0])),a.workbooks[0],t),h={},d="";a.coreprops.length&&(d=Xt(e,Sn(a.coreprops[0]),!0),d&&(h=nT(d)),a.extprops.length!==0&&(d=Xt(e,Sn(a.extprops[0]),!0),d&&bI(d,h,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=dn(e,Sn(a.custprops[0]),!0),d&&(p=wI(d,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(de){return de.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(g.Props=h,g.Custprops=p),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var m={};t.bookDeps&&a.calcchain&&(m=LF(Xt(e,Sn(a.calcchain)),a.calcchain));var y=0,k={},b,w;{var N=f.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var _=0;_!=N.length;++_)h.SheetNames[_]=N[_].name}var F=s?"bin":"xml",T=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,T+1)+"_rels/"+a.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");An(e,S)||(S="xl/_rels/workbook."+F+".rels");var x=nc(dn(e,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=MF(Xt(e,Sn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=yD(Xt(e,Sn(a.people[0])),t)),x&&(x=rU(x,f.Sheets));var I=Xt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var A="sheet";if(x&&x[y]?(b="xl/"+x[y][1].replace(/[\/]?xl\//,""),An(e,b)||(b=x[y][1]),An(e,b)||(b=S.replace(/_rels\/.*$/,"")+x[y][1]),A=x[y][2]):(b="xl/worksheets/sheet"+(y+1-I)+"."+F,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,D=0;D!=t.sheets.length;++D)typeof t.sheets[D]=="number"&&t.sheets[D]==y&&(R=1),typeof t.sheets[D]=="string"&&t.sheets[D].toLowerCase()==h.SheetNames[y].toLowerCase()&&(R=1);if(!R)continue e}}nU(e,b,w,h.SheetNames[y],y,k,i,A,t,f,l,c)}return g={Directory:a,Workbook:f,Props:h,Custprops:p,Deps:m,Sheets:i,SheetNames:h.SheetNames,Strings:ac,Styles:c,Themes:l,SSF:gt(Re)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(de,ue){de=de.replace(/^Root Entry[\/]/,""),g.keys.push(de),g.files[de]=e.FileIndex[ue]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=Xt(e,Sn(a.vba[0]),!0):a.defaults&&a.defaults.bin===CD&&(g.vbaraw=Xt(e,"xl/vbaProject.bin",!0))),g}function aU(e,t){var r=t||{},n="Workbook",a=Ie.find(e,n);try{if(n="/!DataSpaces/Version",a=Ie.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(UR(a.content),n="/!DataSpaces/DataSpaceMap",a=Ie.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=zR(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ie.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=VR(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ie.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);WR(a.content)}catch{}if(n="/EncryptionInfo",a=Ie.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=HR(a.content);if(n="/EncryptedPackage",a=Ie.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function sU(e,t){return t.bookType=="ods"?bE(e,t):t.bookType=="numbers"?eU(e,t):t.bookType=="xlsb"?iU(e,t):kE(e,t)}function iU(e,t){vo=1024,e&&!e.SSF&&(e.SSF=gt(Re)),e&&e.SSF&&(nl(),lu(e.SSF),t.revssf=od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=BT.indexOf(t.bookType)>-1,a=Km();ug(t=t||{});var s=Im(),i="",o=0;if(t.cellXfs=[],Xs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Be(s,i,aT(e.Props,t)),a.coreprops.push(i),ut(t.rels,2,i,Ge.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Be(s,i,oT(e.Props)),a.extprops.push(i),ut(t.rels,3,i,Ge.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Be(s,i,lT(e.Custprops)),a.custprops.push(i),ut(t.rels,4,i,Ge.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Be(s,i,jF(o-1,i,t,e,f)),a.sheets.push(i),ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(h){var p=h["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Be(s,m,BF(p,m)),a.comments.push(m),ut(f,-1,"../comments"+o+"."+r,Ge.CMNT),g=!0),h["!legacy"]&&g&&Be(s,"xl/drawings/vmlDrawing"+o+".vml",zT(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Be(s,Bc(i),No(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Be(s,i,VF(t.Strings,i,t)),a.strs.push(i),ut(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),i="xl/workbook."+r,Be(s,i,UF(e,i)),a.workbooks.push(i),ut(t.rels,1,i,Ge.WB),i="xl/theme/theme1.xml",Be(s,i,eg(e.Themes,t)),a.themes.push(i),ut(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),i="xl/styles."+r,Be(s,i,zF(e,i,t)),a.styles.push(i),ut(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Be(s,i,e.vbaraw),a.vba.push(i),ut(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),i="xl/metadata."+r,Be(s,i,WF(i)),a.metadata.push(i),ut(t.wbrels,-1,"metadata."+r,Ge.XLMETA),Be(s,"[Content_Types].xml",tT(a,t)),Be(s,"_rels/.rels",No(t.rels)),Be(s,"xl/_rels/workbook."+r+".rels",No(t.wbrels)),delete t.revssf,delete t.ssf,s}function kE(e,t){vo=1024,e&&!e.SSF&&(e.SSF=gt(Re)),e&&e.SSF&&(nl(),lu(e.SSF),t.revssf=od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=BT.indexOf(t.bookType)>-1,a=Km();ug(t=t||{});var s=Im(),i="",o=0;if(t.cellXfs=[],Xs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Be(s,i,aT(e.Props,t)),a.coreprops.push(i),ut(t.rels,2,i,Ge.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Be(s,i,oT(e.Props)),a.extprops.push(i),ut(t.rels,3,i,Ge.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Be(s,i,lT(e.Custprops)),a.custprops.push(i),ut(t.rels,4,i,Ge.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Be(s,i,ZT(o-1,t,e,h)),a.sheets.push(i),ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(d){var g=d["!comments"],m=!1,y="";if(g&&g.length>0){var k=!1;g.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(k=!0)})}),k&&(y="xl/threadedComments/threadedComment"+o+"."+r,Be(s,y,bD(g,f,t)),a.threadedcomments.push(y),ut(h,-1,"../threadedComments/threadedComment"+o+"."+r,Ge.TCMNT)),y="xl/comments"+o+"."+r,Be(s,y,VT(g)),a.comments.push(y),ut(h,-1,"../comments"+o+"."+r,Ge.CMNT),m=!0}d["!legacy"]&&m&&Be(s,"xl/drawings/vmlDrawing"+o+".vml",zT(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Be(s,Bc(i),No(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Be(s,i,AT(t.Strings,t)),a.strs.push(i),ut(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),i="xl/workbook."+r,Be(s,i,sE(e)),a.workbooks.push(i),ut(t.rels,1,i,Ge.WB),i="xl/theme/theme1.xml",Be(s,i,eg(e.Themes,t)),a.themes.push(i),ut(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),i="xl/styles."+r,Be(s,i,FT(e,t)),a.styles.push(i),ut(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Be(s,i,e.vbaraw),a.vba.push(i),ut(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),i="xl/metadata."+r,Be(s,i,jT()),a.metadata.push(i),ut(t.wbrels,-1,"metadata."+r,Ge.XLMETA),f.length>1&&(i="xl/persons/person.xml",Be(s,i,wD(f)),a.people.push(i),ut(t.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),Be(s,"[Content_Types].xml",tT(a,t)),Be(s,"_rels/.rels",No(t.rels)),Be(s,"xl/_rels/workbook."+r+".rels",No(t.wbrels)),delete t.revssf,delete t.ssf,s}function fg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=bn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function oU(e,t){return Ie.find(e,"EncryptedPackage")?aU(e,t):og(e,t)}function lU(e,t){var r,n=e,a=t||{};return a.type||(a.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r=P3(n,a),wE(r,a)}function TE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return K1(e.slice(r),t);default:break e}return Go.to_workbook(e,t)}function cU(e,t){var r="",n=fg(e,t);switch(t.type){case"base64":r=bn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=xi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pt(r)),t.type="binary",TE(r,t)}function uU(e,t){var r=e;return t.type=="base64"&&(r=bn(r)),r=tt.utils.decode(1200,r.slice(2),"str"),t.type="binary",TE(r,t)}function fU(e){return e.match(/[^\x00-\x7F]/)?fa(e):e}function Ep(e,t,r,n){return n?(r.type="string",Go.to_workbook(e,r)):Go.to_workbook(t,r)}function Xc(e,t){sd();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Xc(new Uint8Array(e),(r=gt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ro={},r.dateNF&&(Ro.dateNF=r.dateNF),r.type||(r.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$e?"buffer":"binary",n=uN(e),typeof Uint8Array<"u"&&!$e&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=fU(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=gt(r),r.type="array",Xc(_m(n),r)}switch((a=fg(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return oU(Ie.read(n,r),r);break;case 9:if(a[1]<=8)return og(n,r);break;case 60:return K1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return kR(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _T.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?lU(n,r):Ep(e,n,r,s);case 239:return a[3]===60?K1(n,r):Ep(e,n,r,s);case 255:if(a[1]===254)return uU(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return qo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return qo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return q1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return OT.to_workbook(n,r);break;case 10:case 13:case 32:return cU(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return wR.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?q1.to_workbook(n,r):Ep(e,n,r,s)}function cy(e,t){var r=t||{};return r.type="file",Xc(e,r)}function EE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return cu(t.file,Ie.write(e,{type:$e?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ie.write(e,t)}function hU(e,t){var r=gt(t||{}),n=sU(e,r);return SE(n,r)}function dU(e,t){var r=gt(t||{}),n=kE(e,r);return SE(n,r)}function SE(e,t){var r={},n=$e?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ie.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(ou(a))}return t.password&&typeof encrypt_agile<"u"?EE(encrypt_agile(a,t.password),t):t.type==="file"?cu(t.file,a):t.type=="string"?pt(a):a}function pU(e,t){var r=t||{},n=mM(e,r);return EE(n,r)}function oa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Mc(fa(n));case"binary":return fa(n);case"string":return e;case"file":return cu(t.file,n,"utf8");case"buffer":return $e?$a(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):oa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function mU(e,t){switch(t.type){case"base64":return Mc(e);case"binary":return e;case"string":return e;case"file":return cu(t.file,e,"binary");case"buffer":return $e?$a(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function cf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Mc(r):t.type=="string"?pt(r):r;case"file":return cu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function hg(e,t){sd(),aE(e);var r=gt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=hg(e,r);return r.type="array",ou(n)}return dU(e,r)}function pd(e,t){sd(),aE(e);var r=gt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pd(e,r);return r.type="array",ou(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return oa(lM(e,r),r);case"slk":case"sylk":return oa(xT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return oa(pE(e.Sheets[e.SheetNames[a]],r),r);case"txt":return mU(CE(e.Sheets[e.SheetNames[a]],r),r);case"csv":return oa(pg(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return oa(_T.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return cf(q1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return oa(Go.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return oa(OT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return oa(CT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return oa(bE(e,r),r);case"wk1":return cf(qo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return cf(qo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),cf(cE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),pU(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hU(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dg(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function uy(e,t,r){var n=r||{};return n.type="file",n.file=t,dg(n),pd(e,n)}function gU(e,t,r){var n=r||{};return n.type="file",n.file=t,dg(n),hg(e,n)}function vU(e,t,r,n){var a=r||{};a.type="file",a.file=e,dg(a),a.type="buffer";var s=n;return s instanceof Function||(s=r),vs.writeFile(e,pd(t,a),s)}function xE(e,t,r,n,a,s,i,o){var l=zt(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=i?e[r][p]:e[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[p]!=null){if(m==null)if(g.t=="e"&&m===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(f&&m===null)d[s[p]]=null;else continue;else d[s[p]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:ka(g,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function _h(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Qe(f);break;case"number":l=Qe(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var h=zt(l.s.r),d=[],p=[],g=0,m=0,y=Array.isArray(e),k=l.s.r,b=0,w={};y&&!e[k]&&(e[k]=[]);var N=c.skipHidden&&e["!cols"]||[],_=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(N[b]||{}).hidden)switch(d[b]=_t(b),r=y?e[k][b]:e[d[b]+h],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ka(r,null,c),m=w[i]||0,!m)w[i]=1;else{do o=i+"_"+m++;while(w[o]);w[i]=m,w[o]=1}s[b]=o}for(k=l.s.r+a;k<=l.e.r;++k)if(!(_[k]||{}).hidden){var F=xE(e,l,k,d,n,s,y,c);(F.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=F.row)}return p.length=g,p}var fy=/"/g;function _E(e,t,r,n,a,s,i,o){for(var l=!0,c=[],f="",h=zt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var p=o.dense?(e[r]||[])[d]:e[n[d]+h];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:ka(p,null,o));for(var g=0,m=0;g!==f.length;++g)if((m=f.charCodeAt(g))===a||m===s||m===34||o.forceQuotes){f='"'+f.replace(fy,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(fy,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function pg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(d[g]||{}).hidden||(h[g]=_t(g));for(var m=0,y=a.s.r;y<=a.e.r;++y)(p[y]||{}).hidden||(f=_E(e,a,y,h,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function CE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=pg(e,t);if(typeof tt>"u"||t.type=="string")return r;var n=tt.utils.encode(1200,r,"str");return""+n}function bU(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Qe(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=_t(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=zt(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function AE(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Rt(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var h=Qe(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(i=h.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var d=n.header||[],p=0;t.forEach(function(m,y){Bt(m).forEach(function(k){(p=d.indexOf(k))==-1&&(d[p=d.length]=k);var b=m[k],w="z",N="",_=Oe({c:o+p,r:i+y+a});c=Yc(s,_),b&&typeof b=="object"&&!(b instanceof Date)?s[_]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=or(b)),N=n.dateNF||Re[14]):b===null&&n.nullError&&(w="e",b=0),c?(c.t=w,c.v=b,delete c.w,delete c.R,N&&(c.z=N)):s[_]=c={t:w,v:b},N&&(c.z=N))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var g=zt(i);if(a)for(p=0;p<d.length;++p)s[_t(p+o)+g]={t:"s",v:d[p]};return s["!ref"]=Ue(f),s}function yU(e,t){return AE(null,e,t)}function Yc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Rt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Yc(e,Oe(t)):Yc(e,Oe({r:t,c:r||0}))}function wU(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function mg(){return{SheetNames:[],Sheets:{}}}function gg(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(nE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function kU(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wU(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function TU(e,t){return e.z=t,e}function NE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function EU(e,t,r){return NE(e,"#"+t,r)}function SU(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function xU(e,t,r,n){for(var a=typeof t!="string"?t:Qe(t),s=typeof t=="string"?t:Ue(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Yc(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var IE={encode_col:_t,encode_row:zt,encode_cell:Oe,encode_range:Ue,decode_col:Bm,decode_row:Vm,split_cell:BN,decode_cell:Rt,decode_range:Kr,format_cell:ka,sheet_add_aoa:K3,sheet_add_json:AE,sheet_add_dom:mE,aoa_to_sheet:sl,json_to_sheet:yU,table_to_sheet:gE,table_to_book:OM,sheet_to_csv:pg,sheet_to_txt:CE,sheet_to_json:_h,sheet_to_html:pE,sheet_to_formulae:bU,sheet_to_row_object_array:_h,sheet_get_cell:Yc,book_new:mg,book_append_sheet:gg,book_set_sheet_visibility:kU,cell_set_number_format:TU,cell_set_hyperlink:NE,cell_set_internal_link:EU,cell_add_comment:SU,sheet_set_array_formula:xU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},md;function _U(e){md=e}function CU(e,t){var r=md(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(d[g]||{}).hidden||(h[g]=_t(g));var m=a.s.r,y=!1,k=0;return r._read=function(){if(!y)return y=!0,r.push("\uFEFF");for(;m<=a.e.r;)if(++m,!(p[m-1]||{}).hidden&&(f=_E(e,a,m-1,h,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),f||n.blankrows!==!1)))return r.push((k++?o:"")+f);return r.push(null)},r}function AU(e,t){var r=md(),n=t||{},a=n.header!=null?n.header:fE,s=n.footer!=null?n.footer:hE;r.push(a);var i=Kr(e["!ref"]);n.dense=Array.isArray(e),r.push(dE(e,i,n));var o=i.s.r,l=!1;return r._read=function(){if(o>i.e.r)return l||(l=!0,r.push("</table>"+s)),r.push(null);for(;o<=i.e.r;){r.push(uE(e,i,o,n)),++o;break}},r}function NU(e,t){var r=md({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)&&(a=3),typeof h){case"string":c=Qe(h);break;case"number":c=Qe(e["!ref"]),c.s.r=h;break;default:c=h}a>0&&(s=0);var d=zt(c.s.r),p=[],g=0,m=Array.isArray(e),y=c.s.r,k=0,b={};m&&!e[y]&&(e[y]=[]);var w=f.skipHidden&&e["!cols"]||[],N=f.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(w[k]||{}).hidden)switch(p[k]=_t(k),n=m?e[y][k]:e[p[k]+d],a){case 1:i[k]=k-c.s.c;break;case 2:i[k]=p[k];break;case 3:i[k]=f.header[k-c.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=o=ka(n,null,f),g=b[o]||0,!g)b[o]=1;else{do l=o+"_"+g++;while(b[l]);b[o]=g,b[l]=1}i[k]=l}return y=c.s.r+s,r._read=function(){for(;y<=c.e.r;)if(!(N[y-1]||{}).hidden){var _=xE(e,c,y,p,a,i,m,f);if(++y,_.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows)){r.push(_.row);return}}return r.push(null)},r}var IU={to_json:NU,to_html:AU,to_csv:CU,set_readable:_U};const RU=Fc.version,DU=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ie,SSF:A3,parse_xlscfb:og,parse_zip:wE,read:Xc,readFile:cy,readFileSync:cy,set_cptable:O8,set_fs:lN,stream:IU,utils:IE,version:RU,write:pd,writeFile:uy,writeFileAsync:vU,writeFileSync:uy,writeFileXLSX:gU,writeXLSX:hg},Symbol.toStringTag,{value:"Module"}));function OU(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const s=new Uint8Array(a.target.result),i=Xc(s,{type:"array"}),o=i.Sheets[i.SheetNames[0]],l=IE.sheet_to_json(o,{header:1}),c=PU(l);t(c)}catch(s){r(s)}},n.onerror=r,n.readAsArrayBuffer(e)})}function PU(e){const t=[];for(let r=1;r<e.length;r++){const n=e[r];if(!n||n.length<3)continue;let a="";if(n[1]!==void 0&&n[1]!==null){const l=String(n[1]).trim(),c=l.match(/\d+/);c&&["1","2","4","5","6"].includes(c[0])?a=parseInt(c[0]):a=l}let s="";n[2]!==void 0&&n[2]!==null&&(s=String(n[2]).trim());let i="";n[3]!==void 0&&n[3]!==null&&(i=String(n[3]).trim());let o="";n[4]!==void 0&&n[4]!==null&&(o=String(n[4]).trim()),s&&a&&t.push({name:s,grade:a,baptismName:i,department:o,talent:0})}return t}function LU(){const{students:e,attendanceData:t,isAdminMode:r,setStudents:n,setAttendanceData:a,addStudent:s,adminPassword:i}=Gs();if(!r)return null;const o=e.length,l=t.length,c=new Set(t.map(b=>b.date)).size,f=t.filter(b=>b.status==="present").length,h=t.filter(b=>b.status==="absent").length,d=S8(e),p=()=>{const b={students:e,attendanceData:t,exportedAt:new Date().toISOString()},w=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),N=URL.createObjectURL(w),_=document.createElement("a");_.href=N,_.download=`attendance-data-${new Date().toISOString().split("T")[0]}.json`,_.click(),URL.revokeObjectURL(N)},g=b=>{const w=b.target.files[0];if(!w)return;const N=new FileReader;N.onload=_=>{try{const F=JSON.parse(_.target.result);F.students&&F.attendanceData?confirm("   ?")&&(n(F.students),a(F.attendanceData),alert("  .")):alert("  JSON  .")}catch(F){alert("JSON     ."),console.error(F)}},N.readAsText(w),b.target.value=""},m=()=>{N8(()=>Promise.resolve().then(()=>DU)).then(b=>{const w=b.utils.json_to_sheet(t),N=b.utils.book_new();b.utils.book_append_sheet(N,w,""),b.writeFile(N,`attendance-${new Date().toISOString().split("T")[0]}.xlsx`)})},y=async b=>{const w=b.target.files[0];if(w)try{const N=await OU(w);let _=0,F=0;N.forEach(T=>{e.some(S=>S.name===T.name&&String(S.grade)===String(T.grade))?F++:(s(T.name,T.grade,T.baptismName,T.department||""),_++)}),alert(`${_}  .${F>0?` (${F} )`:""}`),b.target.value=""}catch(N){alert("Excel     ."),console.error(N)}},k=()=>{if(!confirm("  ?     ."))return;const b=prompt("     :");if(!b){alert("  .  .");return}if(b!==i){alert("  .  .");return}confirm("   ?     .")&&(localStorage.clear(),window.location.reload())};return B.jsxs("section",{className:"section admin-dashboard",children:[B.jsx("h2",{children:" "}),B.jsxs("div",{className:"stats-grid",children:[B.jsxs("div",{className:"stat-card",children:[B.jsx("div",{className:"stat-title",children:" "}),B.jsxs("div",{className:"stat-value",children:[o,""]})]}),B.jsxs("div",{className:"stat-card",children:[B.jsx("div",{className:"stat-title",children:" "}),B.jsxs("div",{className:"stat-value",children:[l,""]})]}),B.jsxs("div",{className:"stat-card",children:[B.jsx("div",{className:"stat-title",children:" "}),B.jsxs("div",{className:"stat-value",children:[c,""]})]}),B.jsxs("div",{className:"stat-card",children:[B.jsx("div",{className:"stat-title",children:""}),B.jsxs("div",{className:"stat-value",children:[f,""]})]}),B.jsxs("div",{className:"stat-card",children:[B.jsx("div",{className:"stat-title",children:""}),B.jsxs("div",{className:"stat-value",children:[h,""]})]}),B.jsxs("div",{className:"stat-card highlight",children:[B.jsx("div",{className:"stat-title",children:"  "}),B.jsxs("div",{className:"stat-value",children:[d,""]})]})]}),B.jsxs("div",{className:"admin-actions",children:[B.jsx("h3",{children:" "}),B.jsxs("div",{className:"action-buttons",children:[B.jsx("button",{onClick:p,className:"btn-secondary",children:"JSON "}),B.jsxs("label",{className:"btn-secondary",children:["JSON ",B.jsx("input",{type:"file",accept:".json",onChange:g,style:{display:"none"}})]}),B.jsx("button",{onClick:m,className:"btn-secondary",children:"Excel "}),B.jsxs("label",{className:"btn-secondary",children:["Excel  ",B.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:y,style:{display:"none"}})]}),B.jsx("small",{style:{display:"block",marginTop:"10px",color:"#666"},children:"Excel : A(), B(), C(), D(), E()"}),B.jsx("button",{onClick:k,className:"btn-danger",children:"  "})]})]})]})}function FU(){const{isAdminMode:e}=Gs();return B.jsxs("div",{className:"app",children:[B.jsx(E8,{}),B.jsxs("main",{className:"main-content",children:[B.jsx(C8,{}),e&&B.jsxs(B.Fragment,{children:[B.jsx(x8,{}),B.jsx(_8,{}),B.jsx(LU,{}),B.jsx(A8,{})]})]})]})}function MU(){return B.jsx(k8,{children:B.jsx(FU,{})})}Sp.createRoot(document.getElementById("root")).render(B.jsx(Ty.StrictMode,{children:B.jsx(MU,{})}));
